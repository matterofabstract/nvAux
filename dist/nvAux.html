<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="description" content="the note-taking app for creative professionals" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="theme-color" content="#000000" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />

    <link
      rel="icon"
      type="image/svg+xml"
      href="data:image/svg+xml,%3Csvg width='332px' height='332px' viewBox='0 0 332 332' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Cdefs%3E%3CradialGradient cx='50%25' cy='0%25' fx='50%25' fy='0%25' r='100%25' id='radialGradient-1'%3E%3Cstop stop-color='%234B6D8D' offset='0%25'%3E%3C/stop%3E%3Cstop stop-color='%23310550' offset='100%25'%3E%3C/stop%3E%3C/radialGradient%3E%3C/defs%3E%3Cg stroke='none' stroke-width='1' fill='none' fill-rule='evenodd'%3E%3Cg%3E%3Cpath d='M80.7623838,-6.89023353e-15 L251.237616,3.26289697e-15 C279.320457,-1.8958371e-15 289.503973,2.92400675 299.77064,8.41468017 C310.037306,13.9053536 318.094646,21.9626937 323.58532,32.2293603 C329.075993,42.496027 332,52.6795435 332,80.7623838 L332,251.237616 C332,279.320457 329.075993,289.503973 323.58532,299.77064 C318.094646,310.037306 310.037306,318.094646 299.77064,323.58532 C289.503973,329.075993 279.320457,332 251.237616,332 L80.7623838,332 C52.6795435,332 42.496027,329.075993 32.2293603,323.58532 C21.9626937,318.094646 13.9053536,310.037306 8.41468017,299.77064 C2.92400675,289.503973 3.3714784e-15,279.320457 -5.8026012e-15,251.237616 L2.17526465e-15,80.7623838 C-1.2638914e-15,52.6795435 2.92400675,42.496027 8.41468017,32.2293603 C13.9053536,21.9626937 21.9626937,13.9053536 32.2293603,8.41468017 C42.496027,2.92400675 52.6795435,4.0034241e-15 80.7623838,-6.89023353e-15 Z' id='Rectangle' fill='url(%23radialGradient-1)'%3E%3C/path%3E%3Cpath d='M36.052459,205 L36.052459,151.157895 C36.052459,147.578947 36.6295082,144.842105 37.7836066,142.947368 C38.9377049,141.052632 41.0360656,140.105263 44.0786885,140.105263 C46.5967213,140.105263 48.5377049,140.947368 49.9016393,142.631579 C51.2655738,144.315789 51.947541,146.631579 51.947541,149.578947 L51.947541,149.578947 L51.947541,205 L68,205 L68,143.578947 C68,140 67.5278689,136.973684 66.5836066,134.5 C65.6393443,132.026316 64.3803279,130 62.8065574,128.421053 C61.2327869,126.842105 59.4491803,125.710526 57.4557377,125.026316 C55.4622951,124.342105 53.4688525,124 51.4754098,124 C47.8032787,124 44.7868852,124.815789 42.4262295,126.447368 C40.0655738,128.078947 38.0459016,130.157895 36.3672131,132.684211 L36.3672131,132.684211 L36.052459,132.684211 L36.052459,124.947368 L20,124.947368 L20,205 L36.052459,205 Z M110.118644,205 L131,125 L113.915254,125 L103.158192,176.12426 L102.841808,176.12426 L92.0847458,125 L75,125 L95.8813559,205 L110.118644,205 Z M147.198511,205 L151.962779,180.717697 L174.037221,180.717697 L178.801489,205 L195,205 L169.74938,92 L156.25062,92 L131,205 L147.198511,205 Z M171,165 L155,165 L162.843137,124 L163.156863,124 L171,165 Z M218.52459,206 C222.196721,206 225.213115,205.184211 227.57377,203.552632 C229.934426,201.921053 231.954098,199.842105 233.632787,197.315789 L233.632787,197.315789 L233.947541,197.315789 L233.947541,205.052632 L250,205.052632 L250,125 L233.947541,125 L233.947541,178.842105 C233.947541,182.421053 233.370492,185.157895 232.216393,187.052632 C231.062295,188.947368 228.963934,189.894737 225.921311,189.894737 C223.403279,189.894737 221.462295,189.052632 220.098361,187.368421 C218.734426,185.684211 218.052459,183.368421 218.052459,180.421053 L218.052459,180.421053 L218.052459,125 L202,125 L202,186.421053 C202,190 202.472131,193.026316 203.416393,195.5 C204.360656,197.973684 205.619672,200 207.193443,201.578947 C208.767213,203.157895 210.55082,204.289474 212.544262,204.973684 C214.537705,205.657895 216.531148,206 218.52459,206 Z M272.084746,205 L283,180.542406 L293.915254,205 L311,205 L290.909605,164.13215 L310.050847,125 L292.966102,125 L283,147.721893 L273.033898,125 L255.949153,125 L274.774011,164.13215 L255,205 L272.084746,205 Z' id='nvAux' fill='%23FFFFFF' fill-rule='nonzero'%3E%3C/path%3E%3C/g%3E%3C/g%3E%3C/svg%3E%0A"
    />

    <title>nvAux</title>
    <script type="module" crossorigin>
var _h=Object.defineProperty;var wh=(e,t,r)=>t in e?_h(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var ge=(e,t,r)=>(wh(e,typeof t!="symbol"?t+"":t,r),r);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=r(i);fetch(i.href,o)}})();function fe(){}function kh(e){return!!e&&(typeof e=="object"||typeof e=="function")&&typeof e.then=="function"}function Dc(e){return e()}function Qs(){return Object.create(null)}function dt(e){e.forEach(Dc)}function Va(e){return typeof e=="function"}function Zt(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}function xh(e){return Object.keys(e).length===0}function Eh(e,...t){if(e==null){for(const n of t)n(void 0);return fe}const r=e.subscribe(...t);return r.unsubscribe?()=>r.unsubscribe():r}function Kt(e,t,r){e.$$.on_destroy.push(Eh(t,r))}function Wo(e,t,r){return e.set(r),t}function pe(e,t){e.appendChild(t)}function qe(e,t,r){e.insertBefore(t,r||null)}function Le(e){e.parentNode&&e.parentNode.removeChild(e)}function Sh(e,t){for(let r=0;r<e.length;r+=1)e[r]&&e[r].d(t)}function Ie(e){return document.createElement(e)}function Nt(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function Tr(e){return document.createTextNode(e)}function ft(){return Tr(" ")}function Oh(){return Tr("")}function Ee(e,t,r,n){return e.addEventListener(t,r,n),()=>e.removeEventListener(t,r,n)}function V(e,t,r){r==null?e.removeAttribute(t):e.getAttribute(t)!==r&&e.setAttribute(t,r)}function Ch(e){return Array.from(e.childNodes)}function lo(e,t){t=""+t,e.data!==t&&(e.data=t)}function Pi(e,t){e.value=t??""}function be(e,t,r,n){r==null?e.style.removeProperty(t):e.style.setProperty(t,r,n?"important":"")}let On;function kt(e){On=e}function Ac(){if(!On)throw new Error("Function called outside component initialization");return On}function Ya(e){Ac().$$.on_mount.push(e)}const Cr=[],Ho=[];let Mr=[];const Vs=[],Dh=Promise.resolve();let Go=!1;function Ah(){Go||(Go=!0,Dh.then(Za))}function Ii(e){Mr.push(e)}const fo=new Set;let kr=0;function Za(){if(kr!==0)return;const e=On;do{try{for(;kr<Cr.length;){const t=Cr[kr];kr++,kt(t),Ph(t.$$)}}catch(t){throw Cr.length=0,kr=0,t}for(kt(null),Cr.length=0,kr=0;Ho.length;)Ho.pop()();for(let t=0;t<Mr.length;t+=1){const r=Mr[t];fo.has(r)||(fo.add(r),r())}Mr.length=0}while(Cr.length);for(;Vs.length;)Vs.pop()();Go=!1,fo.clear(),kt(e)}function Ph(e){if(e.fragment!==null){e.update(),dt(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(Ii)}}function Ih(e){const t=[],r=[];Mr.forEach(n=>e.indexOf(n)===-1?t.push(n):r.push(n)),r.forEach(n=>n()),Mr=t}const hi=new Set;let tr;function Pc(){tr={r:0,c:[],p:tr}}function Ic(){tr.r||dt(tr.c),tr=tr.p}function rt(e,t){e&&e.i&&(hi.delete(e),e.i(t))}function xt(e,t,r,n){if(e&&e.o){if(hi.has(e))return;hi.add(e),tr.c.push(()=>{hi.delete(e),n&&(r&&e.d(1),n())}),e.o(t)}else n&&n()}function Ys(e,t){const r=t.token={};function n(i,o,a,s){if(t.token!==r)return;t.resolved=s;let u=t.ctx;a!==void 0&&(u=u.slice(),u[a]=s);const c=i&&(t.current=i)(u);let l=!1;t.block&&(t.blocks?t.blocks.forEach((f,h)=>{h!==o&&f&&(Pc(),xt(f,1,1,()=>{t.blocks[h]===f&&(t.blocks[h]=null)}),Ic())}):t.block.d(1),c.c(),rt(c,1),c.m(t.mount(),t.anchor),l=!0),t.block=c,t.blocks&&(t.blocks[o]=c),l&&Za()}if(kh(e)){const i=Ac();if(e.then(o=>{kt(i),n(t.then,1,t.value,o),kt(null)},o=>{if(kt(i),n(t.catch,2,t.error,o),kt(null),!t.hasCatch)throw o}),t.current!==t.pending)return n(t.pending,0),!0}else{if(t.current!==t.then)return n(t.then,1,t.value,e),!0;t.resolved=e}}function Rh(e,t,r){const n=t.slice(),{resolved:i}=e;e.current===e.then&&(n[e.value]=i),e.current===e.catch&&(n[e.error]=i),e.block.p(n,r)}function Zs(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}function Pr(e){e&&e.c()}function rr(e,t,r){const{fragment:n,after_update:i}=e.$$;n&&n.m(t,r),Ii(()=>{const o=e.$$.on_mount.map(Dc).filter(Va);e.$$.on_destroy?e.$$.on_destroy.push(...o):dt(o),e.$$.on_mount=[]}),i.forEach(Ii)}function nr(e,t){const r=e.$$;r.fragment!==null&&(Ih(r.after_update),dt(r.on_destroy),r.fragment&&r.fragment.d(t),r.on_destroy=r.fragment=null,r.ctx=[])}function Th(e,t){e.$$.dirty[0]===-1&&(Cr.push(e),Ah(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function gr(e,t,r,n,i,o,a,s=[-1]){const u=On;kt(e);const c=e.$$={fragment:null,ctx:[],props:o,update:fe,not_equal:i,bound:Qs(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(u?u.$$.context:[])),callbacks:Qs(),dirty:s,skip_bound:!1,root:t.target||u.$$.root};a&&a(c.root);let l=!1;if(c.ctx=r?r(e,t.props||{},(f,h,...d)=>{const y=d.length?d[0]:h;return c.ctx&&i(c.ctx[f],c.ctx[f]=y)&&(!c.skip_bound&&c.bound[f]&&c.bound[f](y),l&&Th(e,f)),h}):[],c.update(),l=!0,dt(c.before_update),c.fragment=n?n(c.ctx):!1,t.target){if(t.hydrate){const f=Ch(t.target);c.fragment&&c.fragment.l(f),f.forEach(Le)}else c.fragment&&c.fragment.c();t.intro&&rt(e.$$.fragment),rr(e,t.target,t.anchor),Za()}kt(u)}class br{constructor(){ge(this,"$$");ge(this,"$$set")}$destroy(){nr(this,1),this.$destroy=fe}$on(t,r){if(!Va(r))return fe;const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(r),()=>{const i=n.indexOf(r);i!==-1&&n.splice(i,1)}}$set(t){this.$$set&&!xh(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const Mh="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Mh);let ti;const Bh=new Uint8Array(16);function $h(){if(!ti&&(ti=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!ti))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return ti(Bh)}const Te=[];for(let e=0;e<256;++e)Te.push((e+256).toString(16).slice(1));function Nh(e,t=0){return(Te[e[t+0]]+Te[e[t+1]]+Te[e[t+2]]+Te[e[t+3]]+"-"+Te[e[t+4]]+Te[e[t+5]]+"-"+Te[e[t+6]]+Te[e[t+7]]+"-"+Te[e[t+8]]+Te[e[t+9]]+"-"+Te[e[t+10]]+Te[e[t+11]]+Te[e[t+12]]+Te[e[t+13]]+Te[e[t+14]]+Te[e[t+15]]).toLowerCase()}const Fh=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Xs={randomUUID:Fh};function jh(e,t,r){if(Xs.randomUUID&&!t&&!e)return Xs.randomUUID();e=e||{};const n=e.random||(e.rng||$h)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,t){r=r||0;for(let i=0;i<16;++i)t[r+i]=n[i];return t}return Nh(n)}var bt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Lh(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function ri(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var zh={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(e,t){(function(r){e.exports=r()})(function(){return function r(n,i,o){function a(c,l){if(!i[c]){if(!n[c]){var f=typeof ri=="function"&&ri;if(!l&&f)return f(c,!0);if(s)return s(c,!0);var h=new Error("Cannot find module '"+c+"'");throw h.code="MODULE_NOT_FOUND",h}var d=i[c]={exports:{}};n[c][0].call(d.exports,function(y){var p=n[c][1][y];return a(p||y)},d,d.exports,r,n,i,o)}return i[c].exports}for(var s=typeof ri=="function"&&ri,u=0;u<o.length;u++)a(o[u]);return a}({1:[function(r,n,i){var o=r("./utils"),a=r("./support"),s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";i.encode=function(u){for(var c,l,f,h,d,y,p,b=[],m=0,g=u.length,w=g,S=o.getTypeOf(u)!=="string";m<u.length;)w=g-m,f=S?(c=u[m++],l=m<g?u[m++]:0,m<g?u[m++]:0):(c=u.charCodeAt(m++),l=m<g?u.charCodeAt(m++):0,m<g?u.charCodeAt(m++):0),h=c>>2,d=(3&c)<<4|l>>4,y=1<w?(15&l)<<2|f>>6:64,p=2<w?63&f:64,b.push(s.charAt(h)+s.charAt(d)+s.charAt(y)+s.charAt(p));return b.join("")},i.decode=function(u){var c,l,f,h,d,y,p=0,b=0,m="data:";if(u.substr(0,m.length)===m)throw new Error("Invalid base64 input, it looks like a data url.");var g,w=3*(u=u.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(u.charAt(u.length-1)===s.charAt(64)&&w--,u.charAt(u.length-2)===s.charAt(64)&&w--,w%1!=0)throw new Error("Invalid base64 input, bad content length.");for(g=a.uint8array?new Uint8Array(0|w):new Array(0|w);p<u.length;)c=s.indexOf(u.charAt(p++))<<2|(h=s.indexOf(u.charAt(p++)))>>4,l=(15&h)<<4|(d=s.indexOf(u.charAt(p++)))>>2,f=(3&d)<<6|(y=s.indexOf(u.charAt(p++))),g[b++]=c,d!==64&&(g[b++]=l),y!==64&&(g[b++]=f);return g}},{"./support":30,"./utils":32}],2:[function(r,n,i){var o=r("./external"),a=r("./stream/DataWorker"),s=r("./stream/Crc32Probe"),u=r("./stream/DataLengthProbe");function c(l,f,h,d,y){this.compressedSize=l,this.uncompressedSize=f,this.crc32=h,this.compression=d,this.compressedContent=y}c.prototype={getContentWorker:function(){var l=new a(o.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new u("data_length")),f=this;return l.on("end",function(){if(this.streamInfo.data_length!==f.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),l},getCompressedWorker:function(){return new a(o.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},c.createWorkerFrom=function(l,f,h){return l.pipe(new s).pipe(new u("uncompressedSize")).pipe(f.compressWorker(h)).pipe(new u("compressedSize")).withStreamInfo("compression",f)},n.exports=c},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(r,n,i){var o=r("./stream/GenericWorker");i.STORE={magic:"\0\0",compressWorker:function(){return new o("STORE compression")},uncompressWorker:function(){return new o("STORE decompression")}},i.DEFLATE=r("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(r,n,i){var o=r("./utils"),a=function(){for(var s,u=[],c=0;c<256;c++){s=c;for(var l=0;l<8;l++)s=1&s?3988292384^s>>>1:s>>>1;u[c]=s}return u}();n.exports=function(s,u){return s!==void 0&&s.length?o.getTypeOf(s)!=="string"?function(c,l,f,h){var d=a,y=h+f;c^=-1;for(var p=h;p<y;p++)c=c>>>8^d[255&(c^l[p])];return-1^c}(0|u,s,s.length,0):function(c,l,f,h){var d=a,y=h+f;c^=-1;for(var p=h;p<y;p++)c=c>>>8^d[255&(c^l.charCodeAt(p))];return-1^c}(0|u,s,s.length,0):0}},{"./utils":32}],5:[function(r,n,i){i.base64=!1,i.binary=!1,i.dir=!1,i.createFolders=!0,i.date=null,i.compression=null,i.compressionOptions=null,i.comment=null,i.unixPermissions=null,i.dosPermissions=null},{}],6:[function(r,n,i){var o=null;o=typeof Promise<"u"?Promise:r("lie"),n.exports={Promise:o}},{lie:37}],7:[function(r,n,i){var o=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",a=r("pako"),s=r("./utils"),u=r("./stream/GenericWorker"),c=o?"uint8array":"array";function l(f,h){u.call(this,"FlateWorker/"+f),this._pako=null,this._pakoAction=f,this._pakoOptions=h,this.meta={}}i.magic="\b\0",s.inherits(l,u),l.prototype.processChunk=function(f){this.meta=f.meta,this._pako===null&&this._createPako(),this._pako.push(s.transformTo(c,f.data),!1)},l.prototype.flush=function(){u.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},l.prototype.cleanUp=function(){u.prototype.cleanUp.call(this),this._pako=null},l.prototype._createPako=function(){this._pako=new a[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var f=this;this._pako.onData=function(h){f.push({data:h,meta:f.meta})}},i.compressWorker=function(f){return new l("Deflate",f)},i.uncompressWorker=function(){return new l("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(r,n,i){function o(d,y){var p,b="";for(p=0;p<y;p++)b+=String.fromCharCode(255&d),d>>>=8;return b}function a(d,y,p,b,m,g){var w,S,k=d.file,D=d.compression,E=g!==c.utf8encode,I=s.transformTo("string",g(k.name)),A=s.transformTo("string",c.utf8encode(k.name)),N=k.comment,G=s.transformTo("string",g(N)),C=s.transformTo("string",c.utf8encode(N)),M=A.length!==k.name.length,_=C.length!==N.length,F="",ee="",j="",te=k.dir,L=k.date,J={crc32:0,compressedSize:0,uncompressedSize:0};y&&!p||(J.crc32=d.crc32,J.compressedSize=d.compressedSize,J.uncompressedSize=d.uncompressedSize);var B=0;y&&(B|=8),E||!M&&!_||(B|=2048);var T=0,ie=0;te&&(T|=16),m==="UNIX"?(ie=798,T|=function(Q,we){var $e=Q;return Q||($e=we?16893:33204),(65535&$e)<<16}(k.unixPermissions,te)):(ie=20,T|=function(Q){return 63&(Q||0)}(k.dosPermissions)),w=L.getUTCHours(),w<<=6,w|=L.getUTCMinutes(),w<<=5,w|=L.getUTCSeconds()/2,S=L.getUTCFullYear()-1980,S<<=4,S|=L.getUTCMonth()+1,S<<=5,S|=L.getUTCDate(),M&&(ee=o(1,1)+o(l(I),4)+A,F+="up"+o(ee.length,2)+ee),_&&(j=o(1,1)+o(l(G),4)+C,F+="uc"+o(j.length,2)+j);var Y="";return Y+=`
\0`,Y+=o(B,2),Y+=D.magic,Y+=o(w,2),Y+=o(S,2),Y+=o(J.crc32,4),Y+=o(J.compressedSize,4),Y+=o(J.uncompressedSize,4),Y+=o(I.length,2),Y+=o(F.length,2),{fileRecord:f.LOCAL_FILE_HEADER+Y+I+F,dirRecord:f.CENTRAL_FILE_HEADER+o(ie,2)+Y+o(G.length,2)+"\0\0\0\0"+o(T,4)+o(b,4)+I+F+G}}var s=r("../utils"),u=r("../stream/GenericWorker"),c=r("../utf8"),l=r("../crc32"),f=r("../signature");function h(d,y,p,b){u.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=y,this.zipPlatform=p,this.encodeFileName=b,this.streamFiles=d,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}s.inherits(h,u),h.prototype.push=function(d){var y=d.meta.percent||0,p=this.entriesCount,b=this._sources.length;this.accumulate?this.contentBuffer.push(d):(this.bytesWritten+=d.data.length,u.prototype.push.call(this,{data:d.data,meta:{currentFile:this.currentFile,percent:p?(y+100*(p-b-1))/p:100}}))},h.prototype.openedSource=function(d){this.currentSourceOffset=this.bytesWritten,this.currentFile=d.file.name;var y=this.streamFiles&&!d.file.dir;if(y){var p=a(d,y,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:p.fileRecord,meta:{percent:0}})}else this.accumulate=!0},h.prototype.closedSource=function(d){this.accumulate=!1;var y=this.streamFiles&&!d.file.dir,p=a(d,y,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(p.dirRecord),y)this.push({data:function(b){return f.DATA_DESCRIPTOR+o(b.crc32,4)+o(b.compressedSize,4)+o(b.uncompressedSize,4)}(d),meta:{percent:100}});else for(this.push({data:p.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},h.prototype.flush=function(){for(var d=this.bytesWritten,y=0;y<this.dirRecords.length;y++)this.push({data:this.dirRecords[y],meta:{percent:100}});var p=this.bytesWritten-d,b=function(m,g,w,S,k){var D=s.transformTo("string",k(S));return f.CENTRAL_DIRECTORY_END+"\0\0\0\0"+o(m,2)+o(m,2)+o(g,4)+o(w,4)+o(D.length,2)+D}(this.dirRecords.length,p,d,this.zipComment,this.encodeFileName);this.push({data:b,meta:{percent:100}})},h.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},h.prototype.registerPrevious=function(d){this._sources.push(d);var y=this;return d.on("data",function(p){y.processChunk(p)}),d.on("end",function(){y.closedSource(y.previous.streamInfo),y._sources.length?y.prepareNextSource():y.end()}),d.on("error",function(p){y.error(p)}),this},h.prototype.resume=function(){return!!u.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},h.prototype.error=function(d){var y=this._sources;if(!u.prototype.error.call(this,d))return!1;for(var p=0;p<y.length;p++)try{y[p].error(d)}catch{}return!0},h.prototype.lock=function(){u.prototype.lock.call(this);for(var d=this._sources,y=0;y<d.length;y++)d[y].lock()},n.exports=h},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(r,n,i){var o=r("../compressions"),a=r("./ZipFileWorker");i.generateWorker=function(s,u,c){var l=new a(u.streamFiles,c,u.platform,u.encodeFileName),f=0;try{s.forEach(function(h,d){f++;var y=function(g,w){var S=g||w,k=o[S];if(!k)throw new Error(S+" is not a valid compression method !");return k}(d.options.compression,u.compression),p=d.options.compressionOptions||u.compressionOptions||{},b=d.dir,m=d.date;d._compressWorker(y,p).withStreamInfo("file",{name:h,dir:b,date:m,comment:d.comment||"",unixPermissions:d.unixPermissions,dosPermissions:d.dosPermissions}).pipe(l)}),l.entriesCount=f}catch(h){l.error(h)}return l}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(r,n,i){function o(){if(!(this instanceof o))return new o;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var a=new o;for(var s in this)typeof this[s]!="function"&&(a[s]=this[s]);return a}}(o.prototype=r("./object")).loadAsync=r("./load"),o.support=r("./support"),o.defaults=r("./defaults"),o.version="3.10.1",o.loadAsync=function(a,s){return new o().loadAsync(a,s)},o.external=r("./external"),n.exports=o},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(r,n,i){var o=r("./utils"),a=r("./external"),s=r("./utf8"),u=r("./zipEntries"),c=r("./stream/Crc32Probe"),l=r("./nodejsUtils");function f(h){return new a.Promise(function(d,y){var p=h.decompressed.getContentWorker().pipe(new c);p.on("error",function(b){y(b)}).on("end",function(){p.streamInfo.crc32!==h.decompressed.crc32?y(new Error("Corrupted zip : CRC32 mismatch")):d()}).resume()})}n.exports=function(h,d){var y=this;return d=o.extend(d||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:s.utf8decode}),l.isNode&&l.isStream(h)?a.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):o.prepareContent("the loaded zip file",h,!0,d.optimizedBinaryString,d.base64).then(function(p){var b=new u(d);return b.load(p),b}).then(function(p){var b=[a.Promise.resolve(p)],m=p.files;if(d.checkCRC32)for(var g=0;g<m.length;g++)b.push(f(m[g]));return a.Promise.all(b)}).then(function(p){for(var b=p.shift(),m=b.files,g=0;g<m.length;g++){var w=m[g],S=w.fileNameStr,k=o.resolve(w.fileNameStr);y.file(k,w.decompressed,{binary:!0,optimizedBinaryString:!0,date:w.date,dir:w.dir,comment:w.fileCommentStr.length?w.fileCommentStr:null,unixPermissions:w.unixPermissions,dosPermissions:w.dosPermissions,createFolders:d.createFolders}),w.dir||(y.file(k).unsafeOriginalName=S)}return b.zipComment.length&&(y.comment=b.zipComment),y})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(r,n,i){var o=r("../utils"),a=r("../stream/GenericWorker");function s(u,c){a.call(this,"Nodejs stream input adapter for "+u),this._upstreamEnded=!1,this._bindStream(c)}o.inherits(s,a),s.prototype._bindStream=function(u){var c=this;(this._stream=u).pause(),u.on("data",function(l){c.push({data:l,meta:{percent:0}})}).on("error",function(l){c.isPaused?this.generatedError=l:c.error(l)}).on("end",function(){c.isPaused?c._upstreamEnded=!0:c.end()})},s.prototype.pause=function(){return!!a.prototype.pause.call(this)&&(this._stream.pause(),!0)},s.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},n.exports=s},{"../stream/GenericWorker":28,"../utils":32}],13:[function(r,n,i){var o=r("readable-stream").Readable;function a(s,u,c){o.call(this,u),this._helper=s;var l=this;s.on("data",function(f,h){l.push(f)||l._helper.pause(),c&&c(h)}).on("error",function(f){l.emit("error",f)}).on("end",function(){l.push(null)})}r("../utils").inherits(a,o),a.prototype._read=function(){this._helper.resume()},n.exports=a},{"../utils":32,"readable-stream":16}],14:[function(r,n,i){n.exports={isNode:typeof Buffer<"u",newBufferFrom:function(o,a){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(o,a);if(typeof o=="number")throw new Error('The "data" argument must not be a number');return new Buffer(o,a)},allocBuffer:function(o){if(Buffer.alloc)return Buffer.alloc(o);var a=new Buffer(o);return a.fill(0),a},isBuffer:function(o){return Buffer.isBuffer(o)},isStream:function(o){return o&&typeof o.on=="function"&&typeof o.pause=="function"&&typeof o.resume=="function"}}},{}],15:[function(r,n,i){function o(k,D,E){var I,A=s.getTypeOf(D),N=s.extend(E||{},l);N.date=N.date||new Date,N.compression!==null&&(N.compression=N.compression.toUpperCase()),typeof N.unixPermissions=="string"&&(N.unixPermissions=parseInt(N.unixPermissions,8)),N.unixPermissions&&16384&N.unixPermissions&&(N.dir=!0),N.dosPermissions&&16&N.dosPermissions&&(N.dir=!0),N.dir&&(k=m(k)),N.createFolders&&(I=b(k))&&g.call(this,I,!0);var G=A==="string"&&N.binary===!1&&N.base64===!1;E&&E.binary!==void 0||(N.binary=!G),(D instanceof f&&D.uncompressedSize===0||N.dir||!D||D.length===0)&&(N.base64=!1,N.binary=!0,D="",N.compression="STORE",A="string");var C=null;C=D instanceof f||D instanceof u?D:y.isNode&&y.isStream(D)?new p(k,D):s.prepareContent(k,D,N.binary,N.optimizedBinaryString,N.base64);var M=new h(k,C,N);this.files[k]=M}var a=r("./utf8"),s=r("./utils"),u=r("./stream/GenericWorker"),c=r("./stream/StreamHelper"),l=r("./defaults"),f=r("./compressedObject"),h=r("./zipObject"),d=r("./generate"),y=r("./nodejsUtils"),p=r("./nodejs/NodejsStreamInputAdapter"),b=function(k){k.slice(-1)==="/"&&(k=k.substring(0,k.length-1));var D=k.lastIndexOf("/");return 0<D?k.substring(0,D):""},m=function(k){return k.slice(-1)!=="/"&&(k+="/"),k},g=function(k,D){return D=D!==void 0?D:l.createFolders,k=m(k),this.files[k]||o.call(this,k,null,{dir:!0,createFolders:D}),this.files[k]};function w(k){return Object.prototype.toString.call(k)==="[object RegExp]"}var S={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(k){var D,E,I;for(D in this.files)I=this.files[D],(E=D.slice(this.root.length,D.length))&&D.slice(0,this.root.length)===this.root&&k(E,I)},filter:function(k){var D=[];return this.forEach(function(E,I){k(E,I)&&D.push(I)}),D},file:function(k,D,E){if(arguments.length!==1)return k=this.root+k,o.call(this,k,D,E),this;if(w(k)){var I=k;return this.filter(function(N,G){return!G.dir&&I.test(N)})}var A=this.files[this.root+k];return A&&!A.dir?A:null},folder:function(k){if(!k)return this;if(w(k))return this.filter(function(A,N){return N.dir&&k.test(A)});var D=this.root+k,E=g.call(this,D),I=this.clone();return I.root=E.name,I},remove:function(k){k=this.root+k;var D=this.files[k];if(D||(k.slice(-1)!=="/"&&(k+="/"),D=this.files[k]),D&&!D.dir)delete this.files[k];else for(var E=this.filter(function(A,N){return N.name.slice(0,k.length)===k}),I=0;I<E.length;I++)delete this.files[E[I].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(k){var D,E={};try{if((E=s.extend(k||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:a.utf8encode})).type=E.type.toLowerCase(),E.compression=E.compression.toUpperCase(),E.type==="binarystring"&&(E.type="string"),!E.type)throw new Error("No output type specified.");s.checkSupport(E.type),E.platform!=="darwin"&&E.platform!=="freebsd"&&E.platform!=="linux"&&E.platform!=="sunos"||(E.platform="UNIX"),E.platform==="win32"&&(E.platform="DOS");var I=E.comment||this.comment||"";D=d.generateWorker(this,E,I)}catch(A){(D=new u("error")).error(A)}return new c(D,E.type||"string",E.mimeType)},generateAsync:function(k,D){return this.generateInternalStream(k).accumulate(D)},generateNodeStream:function(k,D){return(k=k||{}).type||(k.type="nodebuffer"),this.generateInternalStream(k).toNodejsStream(D)}};n.exports=S},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(r,n,i){n.exports=r("stream")},{stream:void 0}],17:[function(r,n,i){var o=r("./DataReader");function a(s){o.call(this,s);for(var u=0;u<this.data.length;u++)s[u]=255&s[u]}r("../utils").inherits(a,o),a.prototype.byteAt=function(s){return this.data[this.zero+s]},a.prototype.lastIndexOfSignature=function(s){for(var u=s.charCodeAt(0),c=s.charCodeAt(1),l=s.charCodeAt(2),f=s.charCodeAt(3),h=this.length-4;0<=h;--h)if(this.data[h]===u&&this.data[h+1]===c&&this.data[h+2]===l&&this.data[h+3]===f)return h-this.zero;return-1},a.prototype.readAndCheckSignature=function(s){var u=s.charCodeAt(0),c=s.charCodeAt(1),l=s.charCodeAt(2),f=s.charCodeAt(3),h=this.readData(4);return u===h[0]&&c===h[1]&&l===h[2]&&f===h[3]},a.prototype.readData=function(s){if(this.checkOffset(s),s===0)return[];var u=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,u},n.exports=a},{"../utils":32,"./DataReader":18}],18:[function(r,n,i){var o=r("../utils");function a(s){this.data=s,this.length=s.length,this.index=0,this.zero=0}a.prototype={checkOffset:function(s){this.checkIndex(this.index+s)},checkIndex:function(s){if(this.length<this.zero+s||s<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+s+"). Corrupted zip ?")},setIndex:function(s){this.checkIndex(s),this.index=s},skip:function(s){this.setIndex(this.index+s)},byteAt:function(){},readInt:function(s){var u,c=0;for(this.checkOffset(s),u=this.index+s-1;u>=this.index;u--)c=(c<<8)+this.byteAt(u);return this.index+=s,c},readString:function(s){return o.transformTo("string",this.readData(s))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var s=this.readInt(4);return new Date(Date.UTC(1980+(s>>25&127),(s>>21&15)-1,s>>16&31,s>>11&31,s>>5&63,(31&s)<<1))}},n.exports=a},{"../utils":32}],19:[function(r,n,i){var o=r("./Uint8ArrayReader");function a(s){o.call(this,s)}r("../utils").inherits(a,o),a.prototype.readData=function(s){this.checkOffset(s);var u=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,u},n.exports=a},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(r,n,i){var o=r("./DataReader");function a(s){o.call(this,s)}r("../utils").inherits(a,o),a.prototype.byteAt=function(s){return this.data.charCodeAt(this.zero+s)},a.prototype.lastIndexOfSignature=function(s){return this.data.lastIndexOf(s)-this.zero},a.prototype.readAndCheckSignature=function(s){return s===this.readData(4)},a.prototype.readData=function(s){this.checkOffset(s);var u=this.data.slice(this.zero+this.index,this.zero+this.index+s);return this.index+=s,u},n.exports=a},{"../utils":32,"./DataReader":18}],21:[function(r,n,i){var o=r("./ArrayReader");function a(s){o.call(this,s)}r("../utils").inherits(a,o),a.prototype.readData=function(s){if(this.checkOffset(s),s===0)return new Uint8Array(0);var u=this.data.subarray(this.zero+this.index,this.zero+this.index+s);return this.index+=s,u},n.exports=a},{"../utils":32,"./ArrayReader":17}],22:[function(r,n,i){var o=r("../utils"),a=r("../support"),s=r("./ArrayReader"),u=r("./StringReader"),c=r("./NodeBufferReader"),l=r("./Uint8ArrayReader");n.exports=function(f){var h=o.getTypeOf(f);return o.checkSupport(h),h!=="string"||a.uint8array?h==="nodebuffer"?new c(f):a.uint8array?new l(o.transformTo("uint8array",f)):new s(o.transformTo("array",f)):new u(f)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(r,n,i){i.LOCAL_FILE_HEADER="PK",i.CENTRAL_FILE_HEADER="PK",i.CENTRAL_DIRECTORY_END="PK",i.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",i.ZIP64_CENTRAL_DIRECTORY_END="PK",i.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(r,n,i){var o=r("./GenericWorker"),a=r("../utils");function s(u){o.call(this,"ConvertWorker to "+u),this.destType=u}a.inherits(s,o),s.prototype.processChunk=function(u){this.push({data:a.transformTo(this.destType,u.data),meta:u.meta})},n.exports=s},{"../utils":32,"./GenericWorker":28}],25:[function(r,n,i){var o=r("./GenericWorker"),a=r("../crc32");function s(){o.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}r("../utils").inherits(s,o),s.prototype.processChunk=function(u){this.streamInfo.crc32=a(u.data,this.streamInfo.crc32||0),this.push(u)},n.exports=s},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(r,n,i){var o=r("../utils"),a=r("./GenericWorker");function s(u){a.call(this,"DataLengthProbe for "+u),this.propName=u,this.withStreamInfo(u,0)}o.inherits(s,a),s.prototype.processChunk=function(u){if(u){var c=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=c+u.data.length}a.prototype.processChunk.call(this,u)},n.exports=s},{"../utils":32,"./GenericWorker":28}],27:[function(r,n,i){var o=r("../utils"),a=r("./GenericWorker");function s(u){a.call(this,"DataWorker");var c=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,u.then(function(l){c.dataIsReady=!0,c.data=l,c.max=l&&l.length||0,c.type=o.getTypeOf(l),c.isPaused||c._tickAndRepeat()},function(l){c.error(l)})}o.inherits(s,a),s.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this.data=null},s.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,o.delay(this._tickAndRepeat,[],this)),!0)},s.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(o.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},s.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var u=null,c=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":u=this.data.substring(this.index,c);break;case"uint8array":u=this.data.subarray(this.index,c);break;case"array":case"nodebuffer":u=this.data.slice(this.index,c)}return this.index=c,this.push({data:u,meta:{percent:this.max?this.index/this.max*100:0}})},n.exports=s},{"../utils":32,"./GenericWorker":28}],28:[function(r,n,i){function o(a){this.name=a||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}o.prototype={push:function(a){this.emit("data",a)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(a){this.emit("error",a)}return!0},error:function(a){return!this.isFinished&&(this.isPaused?this.generatedError=a:(this.isFinished=!0,this.emit("error",a),this.previous&&this.previous.error(a),this.cleanUp()),!0)},on:function(a,s){return this._listeners[a].push(s),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(a,s){if(this._listeners[a])for(var u=0;u<this._listeners[a].length;u++)this._listeners[a][u].call(this,s)},pipe:function(a){return a.registerPrevious(this)},registerPrevious:function(a){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=a.streamInfo,this.mergeStreamInfo(),this.previous=a;var s=this;return a.on("data",function(u){s.processChunk(u)}),a.on("end",function(){s.end()}),a.on("error",function(u){s.error(u)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var a=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),a=!0),this.previous&&this.previous.resume(),!a},flush:function(){},processChunk:function(a){this.push(a)},withStreamInfo:function(a,s){return this.extraStreamInfo[a]=s,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var a in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,a)&&(this.streamInfo[a]=this.extraStreamInfo[a])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var a="Worker "+this.name;return this.previous?this.previous+" -> "+a:a}},n.exports=o},{}],29:[function(r,n,i){var o=r("../utils"),a=r("./ConvertWorker"),s=r("./GenericWorker"),u=r("../base64"),c=r("../support"),l=r("../external"),f=null;if(c.nodestream)try{f=r("../nodejs/NodejsStreamOutputAdapter")}catch{}function h(y,p){return new l.Promise(function(b,m){var g=[],w=y._internalType,S=y._outputType,k=y._mimeType;y.on("data",function(D,E){g.push(D),p&&p(E)}).on("error",function(D){g=[],m(D)}).on("end",function(){try{var D=function(E,I,A){switch(E){case"blob":return o.newBlob(o.transformTo("arraybuffer",I),A);case"base64":return u.encode(I);default:return o.transformTo(E,I)}}(S,function(E,I){var A,N=0,G=null,C=0;for(A=0;A<I.length;A++)C+=I[A].length;switch(E){case"string":return I.join("");case"array":return Array.prototype.concat.apply([],I);case"uint8array":for(G=new Uint8Array(C),A=0;A<I.length;A++)G.set(I[A],N),N+=I[A].length;return G;case"nodebuffer":return Buffer.concat(I);default:throw new Error("concat : unsupported type '"+E+"'")}}(w,g),k);b(D)}catch(E){m(E)}g=[]}).resume()})}function d(y,p,b){var m=p;switch(p){case"blob":case"arraybuffer":m="uint8array";break;case"base64":m="string"}try{this._internalType=m,this._outputType=p,this._mimeType=b,o.checkSupport(m),this._worker=y.pipe(new a(m)),y.lock()}catch(g){this._worker=new s("error"),this._worker.error(g)}}d.prototype={accumulate:function(y){return h(this,y)},on:function(y,p){var b=this;return y==="data"?this._worker.on(y,function(m){p.call(b,m.data,m.meta)}):this._worker.on(y,function(){o.delay(p,arguments,b)}),this},resume:function(){return o.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(y){if(o.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new f(this,{objectMode:this._outputType!=="nodebuffer"},y)}},n.exports=d},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(r,n,i){if(i.base64=!0,i.array=!0,i.string=!0,i.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",i.nodebuffer=typeof Buffer<"u",i.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")i.blob=!1;else{var o=new ArrayBuffer(0);try{i.blob=new Blob([o],{type:"application/zip"}).size===0}catch{try{var a=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);a.append(o),i.blob=a.getBlob("application/zip").size===0}catch{i.blob=!1}}}try{i.nodestream=!!r("readable-stream").Readable}catch{i.nodestream=!1}},{"readable-stream":16}],31:[function(r,n,i){for(var o=r("./utils"),a=r("./support"),s=r("./nodejsUtils"),u=r("./stream/GenericWorker"),c=new Array(256),l=0;l<256;l++)c[l]=252<=l?6:248<=l?5:240<=l?4:224<=l?3:192<=l?2:1;c[254]=c[254]=1;function f(){u.call(this,"utf-8 decode"),this.leftOver=null}function h(){u.call(this,"utf-8 encode")}i.utf8encode=function(d){return a.nodebuffer?s.newBufferFrom(d,"utf-8"):function(y){var p,b,m,g,w,S=y.length,k=0;for(g=0;g<S;g++)(64512&(b=y.charCodeAt(g)))==55296&&g+1<S&&(64512&(m=y.charCodeAt(g+1)))==56320&&(b=65536+(b-55296<<10)+(m-56320),g++),k+=b<128?1:b<2048?2:b<65536?3:4;for(p=a.uint8array?new Uint8Array(k):new Array(k),g=w=0;w<k;g++)(64512&(b=y.charCodeAt(g)))==55296&&g+1<S&&(64512&(m=y.charCodeAt(g+1)))==56320&&(b=65536+(b-55296<<10)+(m-56320),g++),b<128?p[w++]=b:(b<2048?p[w++]=192|b>>>6:(b<65536?p[w++]=224|b>>>12:(p[w++]=240|b>>>18,p[w++]=128|b>>>12&63),p[w++]=128|b>>>6&63),p[w++]=128|63&b);return p}(d)},i.utf8decode=function(d){return a.nodebuffer?o.transformTo("nodebuffer",d).toString("utf-8"):function(y){var p,b,m,g,w=y.length,S=new Array(2*w);for(p=b=0;p<w;)if((m=y[p++])<128)S[b++]=m;else if(4<(g=c[m]))S[b++]=65533,p+=g-1;else{for(m&=g===2?31:g===3?15:7;1<g&&p<w;)m=m<<6|63&y[p++],g--;1<g?S[b++]=65533:m<65536?S[b++]=m:(m-=65536,S[b++]=55296|m>>10&1023,S[b++]=56320|1023&m)}return S.length!==b&&(S.subarray?S=S.subarray(0,b):S.length=b),o.applyFromCharCode(S)}(d=o.transformTo(a.uint8array?"uint8array":"array",d))},o.inherits(f,u),f.prototype.processChunk=function(d){var y=o.transformTo(a.uint8array?"uint8array":"array",d.data);if(this.leftOver&&this.leftOver.length){if(a.uint8array){var p=y;(y=new Uint8Array(p.length+this.leftOver.length)).set(this.leftOver,0),y.set(p,this.leftOver.length)}else y=this.leftOver.concat(y);this.leftOver=null}var b=function(g,w){var S;for((w=w||g.length)>g.length&&(w=g.length),S=w-1;0<=S&&(192&g[S])==128;)S--;return S<0||S===0?w:S+c[g[S]]>w?S:w}(y),m=y;b!==y.length&&(a.uint8array?(m=y.subarray(0,b),this.leftOver=y.subarray(b,y.length)):(m=y.slice(0,b),this.leftOver=y.slice(b,y.length))),this.push({data:i.utf8decode(m),meta:d.meta})},f.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:i.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},i.Utf8DecodeWorker=f,o.inherits(h,u),h.prototype.processChunk=function(d){this.push({data:i.utf8encode(d.data),meta:d.meta})},i.Utf8EncodeWorker=h},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(r,n,i){var o=r("./support"),a=r("./base64"),s=r("./nodejsUtils"),u=r("./external");function c(p){return p}function l(p,b){for(var m=0;m<p.length;++m)b[m]=255&p.charCodeAt(m);return b}r("setimmediate"),i.newBlob=function(p,b){i.checkSupport("blob");try{return new Blob([p],{type:b})}catch{try{var m=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return m.append(p),m.getBlob(b)}catch{throw new Error("Bug : can't construct the Blob.")}}};var f={stringifyByChunk:function(p,b,m){var g=[],w=0,S=p.length;if(S<=m)return String.fromCharCode.apply(null,p);for(;w<S;)b==="array"||b==="nodebuffer"?g.push(String.fromCharCode.apply(null,p.slice(w,Math.min(w+m,S)))):g.push(String.fromCharCode.apply(null,p.subarray(w,Math.min(w+m,S)))),w+=m;return g.join("")},stringifyByChar:function(p){for(var b="",m=0;m<p.length;m++)b+=String.fromCharCode(p[m]);return b},applyCanBeUsed:{uint8array:function(){try{return o.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return o.nodebuffer&&String.fromCharCode.apply(null,s.allocBuffer(1)).length===1}catch{return!1}}()}};function h(p){var b=65536,m=i.getTypeOf(p),g=!0;if(m==="uint8array"?g=f.applyCanBeUsed.uint8array:m==="nodebuffer"&&(g=f.applyCanBeUsed.nodebuffer),g)for(;1<b;)try{return f.stringifyByChunk(p,m,b)}catch{b=Math.floor(b/2)}return f.stringifyByChar(p)}function d(p,b){for(var m=0;m<p.length;m++)b[m]=p[m];return b}i.applyFromCharCode=h;var y={};y.string={string:c,array:function(p){return l(p,new Array(p.length))},arraybuffer:function(p){return y.string.uint8array(p).buffer},uint8array:function(p){return l(p,new Uint8Array(p.length))},nodebuffer:function(p){return l(p,s.allocBuffer(p.length))}},y.array={string:h,array:c,arraybuffer:function(p){return new Uint8Array(p).buffer},uint8array:function(p){return new Uint8Array(p)},nodebuffer:function(p){return s.newBufferFrom(p)}},y.arraybuffer={string:function(p){return h(new Uint8Array(p))},array:function(p){return d(new Uint8Array(p),new Array(p.byteLength))},arraybuffer:c,uint8array:function(p){return new Uint8Array(p)},nodebuffer:function(p){return s.newBufferFrom(new Uint8Array(p))}},y.uint8array={string:h,array:function(p){return d(p,new Array(p.length))},arraybuffer:function(p){return p.buffer},uint8array:c,nodebuffer:function(p){return s.newBufferFrom(p)}},y.nodebuffer={string:h,array:function(p){return d(p,new Array(p.length))},arraybuffer:function(p){return y.nodebuffer.uint8array(p).buffer},uint8array:function(p){return d(p,new Uint8Array(p.length))},nodebuffer:c},i.transformTo=function(p,b){if(b=b||"",!p)return b;i.checkSupport(p);var m=i.getTypeOf(b);return y[m][p](b)},i.resolve=function(p){for(var b=p.split("/"),m=[],g=0;g<b.length;g++){var w=b[g];w==="."||w===""&&g!==0&&g!==b.length-1||(w===".."?m.pop():m.push(w))}return m.join("/")},i.getTypeOf=function(p){return typeof p=="string"?"string":Object.prototype.toString.call(p)==="[object Array]"?"array":o.nodebuffer&&s.isBuffer(p)?"nodebuffer":o.uint8array&&p instanceof Uint8Array?"uint8array":o.arraybuffer&&p instanceof ArrayBuffer?"arraybuffer":void 0},i.checkSupport=function(p){if(!o[p.toLowerCase()])throw new Error(p+" is not supported by this platform")},i.MAX_VALUE_16BITS=65535,i.MAX_VALUE_32BITS=-1,i.pretty=function(p){var b,m,g="";for(m=0;m<(p||"").length;m++)g+="\\x"+((b=p.charCodeAt(m))<16?"0":"")+b.toString(16).toUpperCase();return g},i.delay=function(p,b,m){setImmediate(function(){p.apply(m||null,b||[])})},i.inherits=function(p,b){function m(){}m.prototype=b.prototype,p.prototype=new m},i.extend=function(){var p,b,m={};for(p=0;p<arguments.length;p++)for(b in arguments[p])Object.prototype.hasOwnProperty.call(arguments[p],b)&&m[b]===void 0&&(m[b]=arguments[p][b]);return m},i.prepareContent=function(p,b,m,g,w){return u.Promise.resolve(b).then(function(S){return o.blob&&(S instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(S))!==-1)&&typeof FileReader<"u"?new u.Promise(function(k,D){var E=new FileReader;E.onload=function(I){k(I.target.result)},E.onerror=function(I){D(I.target.error)},E.readAsArrayBuffer(S)}):S}).then(function(S){var k=i.getTypeOf(S);return k?(k==="arraybuffer"?S=i.transformTo("uint8array",S):k==="string"&&(w?S=a.decode(S):m&&g!==!0&&(S=function(D){return l(D,o.uint8array?new Uint8Array(D.length):new Array(D.length))}(S))),S):u.Promise.reject(new Error("Can't read the data of '"+p+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(r,n,i){var o=r("./reader/readerFor"),a=r("./utils"),s=r("./signature"),u=r("./zipEntry"),c=r("./support");function l(f){this.files=[],this.loadOptions=f}l.prototype={checkSignature:function(f){if(!this.reader.readAndCheckSignature(f)){this.reader.index-=4;var h=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+a.pretty(h)+", expected "+a.pretty(f)+")")}},isSignature:function(f,h){var d=this.reader.index;this.reader.setIndex(f);var y=this.reader.readString(4)===h;return this.reader.setIndex(d),y},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var f=this.reader.readData(this.zipCommentLength),h=c.uint8array?"uint8array":"array",d=a.transformTo(h,f);this.zipComment=this.loadOptions.decodeFileName(d)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var f,h,d,y=this.zip64EndOfCentralSize-44;0<y;)f=this.reader.readInt(2),h=this.reader.readInt(4),d=this.reader.readData(h),this.zip64ExtensibleData[f]={id:f,length:h,value:d}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var f,h;for(f=0;f<this.files.length;f++)h=this.files[f],this.reader.setIndex(h.localHeaderOffset),this.checkSignature(s.LOCAL_FILE_HEADER),h.readLocalPart(this.reader),h.handleUTF8(),h.processAttributes()},readCentralDir:function(){var f;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(s.CENTRAL_FILE_HEADER);)(f=new u({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(f);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var f=this.reader.lastIndexOfSignature(s.CENTRAL_DIRECTORY_END);if(f<0)throw this.isSignature(0,s.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(f);var h=f;if(this.checkSignature(s.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===a.MAX_VALUE_16BITS||this.diskWithCentralDirStart===a.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===a.MAX_VALUE_16BITS||this.centralDirRecords===a.MAX_VALUE_16BITS||this.centralDirSize===a.MAX_VALUE_32BITS||this.centralDirOffset===a.MAX_VALUE_32BITS){if(this.zip64=!0,(f=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(f),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,s.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var d=this.centralDirOffset+this.centralDirSize;this.zip64&&(d+=20,d+=12+this.zip64EndOfCentralSize);var y=h-d;if(0<y)this.isSignature(h,s.CENTRAL_FILE_HEADER)||(this.reader.zero=y);else if(y<0)throw new Error("Corrupted zip: missing "+Math.abs(y)+" bytes.")},prepareReader:function(f){this.reader=o(f)},load:function(f){this.prepareReader(f),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},n.exports=l},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(r,n,i){var o=r("./reader/readerFor"),a=r("./utils"),s=r("./compressedObject"),u=r("./crc32"),c=r("./utf8"),l=r("./compressions"),f=r("./support");function h(d,y){this.options=d,this.loadOptions=y}h.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(d){var y,p;if(d.skip(22),this.fileNameLength=d.readInt(2),p=d.readInt(2),this.fileName=d.readData(this.fileNameLength),d.skip(p),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((y=function(b){for(var m in l)if(Object.prototype.hasOwnProperty.call(l,m)&&l[m].magic===b)return l[m];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+a.pretty(this.compressionMethod)+" unknown (inner file : "+a.transformTo("string",this.fileName)+")");this.decompressed=new s(this.compressedSize,this.uncompressedSize,this.crc32,y,d.readData(this.compressedSize))},readCentralPart:function(d){this.versionMadeBy=d.readInt(2),d.skip(2),this.bitFlag=d.readInt(2),this.compressionMethod=d.readString(2),this.date=d.readDate(),this.crc32=d.readInt(4),this.compressedSize=d.readInt(4),this.uncompressedSize=d.readInt(4);var y=d.readInt(2);if(this.extraFieldsLength=d.readInt(2),this.fileCommentLength=d.readInt(2),this.diskNumberStart=d.readInt(2),this.internalFileAttributes=d.readInt(2),this.externalFileAttributes=d.readInt(4),this.localHeaderOffset=d.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");d.skip(y),this.readExtraFields(d),this.parseZIP64ExtraField(d),this.fileComment=d.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var d=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),d==0&&(this.dosPermissions=63&this.externalFileAttributes),d==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var d=o(this.extraFields[1].value);this.uncompressedSize===a.MAX_VALUE_32BITS&&(this.uncompressedSize=d.readInt(8)),this.compressedSize===a.MAX_VALUE_32BITS&&(this.compressedSize=d.readInt(8)),this.localHeaderOffset===a.MAX_VALUE_32BITS&&(this.localHeaderOffset=d.readInt(8)),this.diskNumberStart===a.MAX_VALUE_32BITS&&(this.diskNumberStart=d.readInt(4))}},readExtraFields:function(d){var y,p,b,m=d.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});d.index+4<m;)y=d.readInt(2),p=d.readInt(2),b=d.readData(p),this.extraFields[y]={id:y,length:p,value:b};d.setIndex(m)},handleUTF8:function(){var d=f.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=c.utf8decode(this.fileName),this.fileCommentStr=c.utf8decode(this.fileComment);else{var y=this.findExtraFieldUnicodePath();if(y!==null)this.fileNameStr=y;else{var p=a.transformTo(d,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(p)}var b=this.findExtraFieldUnicodeComment();if(b!==null)this.fileCommentStr=b;else{var m=a.transformTo(d,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(m)}}},findExtraFieldUnicodePath:function(){var d=this.extraFields[28789];if(d){var y=o(d.value);return y.readInt(1)!==1||u(this.fileName)!==y.readInt(4)?null:c.utf8decode(y.readData(d.length-5))}return null},findExtraFieldUnicodeComment:function(){var d=this.extraFields[25461];if(d){var y=o(d.value);return y.readInt(1)!==1||u(this.fileComment)!==y.readInt(4)?null:c.utf8decode(y.readData(d.length-5))}return null}},n.exports=h},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(r,n,i){function o(y,p,b){this.name=y,this.dir=b.dir,this.date=b.date,this.comment=b.comment,this.unixPermissions=b.unixPermissions,this.dosPermissions=b.dosPermissions,this._data=p,this._dataBinary=b.binary,this.options={compression:b.compression,compressionOptions:b.compressionOptions}}var a=r("./stream/StreamHelper"),s=r("./stream/DataWorker"),u=r("./utf8"),c=r("./compressedObject"),l=r("./stream/GenericWorker");o.prototype={internalStream:function(y){var p=null,b="string";try{if(!y)throw new Error("No output type specified.");var m=(b=y.toLowerCase())==="string"||b==="text";b!=="binarystring"&&b!=="text"||(b="string"),p=this._decompressWorker();var g=!this._dataBinary;g&&!m&&(p=p.pipe(new u.Utf8EncodeWorker)),!g&&m&&(p=p.pipe(new u.Utf8DecodeWorker))}catch(w){(p=new l("error")).error(w)}return new a(p,b,"")},async:function(y,p){return this.internalStream(y).accumulate(p)},nodeStream:function(y,p){return this.internalStream(y||"nodebuffer").toNodejsStream(p)},_compressWorker:function(y,p){if(this._data instanceof c&&this._data.compression.magic===y.magic)return this._data.getCompressedWorker();var b=this._decompressWorker();return this._dataBinary||(b=b.pipe(new u.Utf8EncodeWorker)),c.createWorkerFrom(b,y,p)},_decompressWorker:function(){return this._data instanceof c?this._data.getContentWorker():this._data instanceof l?this._data:new s(this._data)}};for(var f=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],h=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},d=0;d<f.length;d++)o.prototype[f[d]]=h;n.exports=o},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(r,n,i){(function(o){var a,s,u=o.MutationObserver||o.WebKitMutationObserver;if(u){var c=0,l=new u(y),f=o.document.createTextNode("");l.observe(f,{characterData:!0}),a=function(){f.data=c=++c%2}}else if(o.setImmediate||o.MessageChannel===void 0)a="document"in o&&"onreadystatechange"in o.document.createElement("script")?function(){var p=o.document.createElement("script");p.onreadystatechange=function(){y(),p.onreadystatechange=null,p.parentNode.removeChild(p),p=null},o.document.documentElement.appendChild(p)}:function(){setTimeout(y,0)};else{var h=new o.MessageChannel;h.port1.onmessage=y,a=function(){h.port2.postMessage(0)}}var d=[];function y(){var p,b;s=!0;for(var m=d.length;m;){for(b=d,d=[],p=-1;++p<m;)b[p]();m=d.length}s=!1}n.exports=function(p){d.push(p)!==1||s||a()}}).call(this,typeof bt<"u"?bt:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(r,n,i){var o=r("immediate");function a(){}var s={},u=["REJECTED"],c=["FULFILLED"],l=["PENDING"];function f(m){if(typeof m!="function")throw new TypeError("resolver must be a function");this.state=l,this.queue=[],this.outcome=void 0,m!==a&&p(this,m)}function h(m,g,w){this.promise=m,typeof g=="function"&&(this.onFulfilled=g,this.callFulfilled=this.otherCallFulfilled),typeof w=="function"&&(this.onRejected=w,this.callRejected=this.otherCallRejected)}function d(m,g,w){o(function(){var S;try{S=g(w)}catch(k){return s.reject(m,k)}S===m?s.reject(m,new TypeError("Cannot resolve promise with itself")):s.resolve(m,S)})}function y(m){var g=m&&m.then;if(m&&(typeof m=="object"||typeof m=="function")&&typeof g=="function")return function(){g.apply(m,arguments)}}function p(m,g){var w=!1;function S(E){w||(w=!0,s.reject(m,E))}function k(E){w||(w=!0,s.resolve(m,E))}var D=b(function(){g(k,S)});D.status==="error"&&S(D.value)}function b(m,g){var w={};try{w.value=m(g),w.status="success"}catch(S){w.status="error",w.value=S}return w}(n.exports=f).prototype.finally=function(m){if(typeof m!="function")return this;var g=this.constructor;return this.then(function(w){return g.resolve(m()).then(function(){return w})},function(w){return g.resolve(m()).then(function(){throw w})})},f.prototype.catch=function(m){return this.then(null,m)},f.prototype.then=function(m,g){if(typeof m!="function"&&this.state===c||typeof g!="function"&&this.state===u)return this;var w=new this.constructor(a);return this.state!==l?d(w,this.state===c?m:g,this.outcome):this.queue.push(new h(w,m,g)),w},h.prototype.callFulfilled=function(m){s.resolve(this.promise,m)},h.prototype.otherCallFulfilled=function(m){d(this.promise,this.onFulfilled,m)},h.prototype.callRejected=function(m){s.reject(this.promise,m)},h.prototype.otherCallRejected=function(m){d(this.promise,this.onRejected,m)},s.resolve=function(m,g){var w=b(y,g);if(w.status==="error")return s.reject(m,w.value);var S=w.value;if(S)p(m,S);else{m.state=c,m.outcome=g;for(var k=-1,D=m.queue.length;++k<D;)m.queue[k].callFulfilled(g)}return m},s.reject=function(m,g){m.state=u,m.outcome=g;for(var w=-1,S=m.queue.length;++w<S;)m.queue[w].callRejected(g);return m},f.resolve=function(m){return m instanceof this?m:s.resolve(new this(a),m)},f.reject=function(m){var g=new this(a);return s.reject(g,m)},f.all=function(m){var g=this;if(Object.prototype.toString.call(m)!=="[object Array]")return this.reject(new TypeError("must be an array"));var w=m.length,S=!1;if(!w)return this.resolve([]);for(var k=new Array(w),D=0,E=-1,I=new this(a);++E<w;)A(m[E],E);return I;function A(N,G){g.resolve(N).then(function(C){k[G]=C,++D!==w||S||(S=!0,s.resolve(I,k))},function(C){S||(S=!0,s.reject(I,C))})}},f.race=function(m){var g=this;if(Object.prototype.toString.call(m)!=="[object Array]")return this.reject(new TypeError("must be an array"));var w=m.length,S=!1;if(!w)return this.resolve([]);for(var k=-1,D=new this(a);++k<w;)E=m[k],g.resolve(E).then(function(I){S||(S=!0,s.resolve(D,I))},function(I){S||(S=!0,s.reject(D,I))});var E;return D}},{immediate:36}],38:[function(r,n,i){var o={};(0,r("./lib/utils/common").assign)(o,r("./lib/deflate"),r("./lib/inflate"),r("./lib/zlib/constants")),n.exports=o},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(r,n,i){var o=r("./zlib/deflate"),a=r("./utils/common"),s=r("./utils/strings"),u=r("./zlib/messages"),c=r("./zlib/zstream"),l=Object.prototype.toString,f=0,h=-1,d=0,y=8;function p(m){if(!(this instanceof p))return new p(m);this.options=a.assign({level:h,method:y,chunkSize:16384,windowBits:15,memLevel:8,strategy:d,to:""},m||{});var g=this.options;g.raw&&0<g.windowBits?g.windowBits=-g.windowBits:g.gzip&&0<g.windowBits&&g.windowBits<16&&(g.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var w=o.deflateInit2(this.strm,g.level,g.method,g.windowBits,g.memLevel,g.strategy);if(w!==f)throw new Error(u[w]);if(g.header&&o.deflateSetHeader(this.strm,g.header),g.dictionary){var S;if(S=typeof g.dictionary=="string"?s.string2buf(g.dictionary):l.call(g.dictionary)==="[object ArrayBuffer]"?new Uint8Array(g.dictionary):g.dictionary,(w=o.deflateSetDictionary(this.strm,S))!==f)throw new Error(u[w]);this._dict_set=!0}}function b(m,g){var w=new p(g);if(w.push(m,!0),w.err)throw w.msg||u[w.err];return w.result}p.prototype.push=function(m,g){var w,S,k=this.strm,D=this.options.chunkSize;if(this.ended)return!1;S=g===~~g?g:g===!0?4:0,typeof m=="string"?k.input=s.string2buf(m):l.call(m)==="[object ArrayBuffer]"?k.input=new Uint8Array(m):k.input=m,k.next_in=0,k.avail_in=k.input.length;do{if(k.avail_out===0&&(k.output=new a.Buf8(D),k.next_out=0,k.avail_out=D),(w=o.deflate(k,S))!==1&&w!==f)return this.onEnd(w),!(this.ended=!0);k.avail_out!==0&&(k.avail_in!==0||S!==4&&S!==2)||(this.options.to==="string"?this.onData(s.buf2binstring(a.shrinkBuf(k.output,k.next_out))):this.onData(a.shrinkBuf(k.output,k.next_out)))}while((0<k.avail_in||k.avail_out===0)&&w!==1);return S===4?(w=o.deflateEnd(this.strm),this.onEnd(w),this.ended=!0,w===f):S!==2||(this.onEnd(f),!(k.avail_out=0))},p.prototype.onData=function(m){this.chunks.push(m)},p.prototype.onEnd=function(m){m===f&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=m,this.msg=this.strm.msg},i.Deflate=p,i.deflate=b,i.deflateRaw=function(m,g){return(g=g||{}).raw=!0,b(m,g)},i.gzip=function(m,g){return(g=g||{}).gzip=!0,b(m,g)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(r,n,i){var o=r("./zlib/inflate"),a=r("./utils/common"),s=r("./utils/strings"),u=r("./zlib/constants"),c=r("./zlib/messages"),l=r("./zlib/zstream"),f=r("./zlib/gzheader"),h=Object.prototype.toString;function d(p){if(!(this instanceof d))return new d(p);this.options=a.assign({chunkSize:16384,windowBits:0,to:""},p||{});var b=this.options;b.raw&&0<=b.windowBits&&b.windowBits<16&&(b.windowBits=-b.windowBits,b.windowBits===0&&(b.windowBits=-15)),!(0<=b.windowBits&&b.windowBits<16)||p&&p.windowBits||(b.windowBits+=32),15<b.windowBits&&b.windowBits<48&&!(15&b.windowBits)&&(b.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var m=o.inflateInit2(this.strm,b.windowBits);if(m!==u.Z_OK)throw new Error(c[m]);this.header=new f,o.inflateGetHeader(this.strm,this.header)}function y(p,b){var m=new d(b);if(m.push(p,!0),m.err)throw m.msg||c[m.err];return m.result}d.prototype.push=function(p,b){var m,g,w,S,k,D,E=this.strm,I=this.options.chunkSize,A=this.options.dictionary,N=!1;if(this.ended)return!1;g=b===~~b?b:b===!0?u.Z_FINISH:u.Z_NO_FLUSH,typeof p=="string"?E.input=s.binstring2buf(p):h.call(p)==="[object ArrayBuffer]"?E.input=new Uint8Array(p):E.input=p,E.next_in=0,E.avail_in=E.input.length;do{if(E.avail_out===0&&(E.output=new a.Buf8(I),E.next_out=0,E.avail_out=I),(m=o.inflate(E,u.Z_NO_FLUSH))===u.Z_NEED_DICT&&A&&(D=typeof A=="string"?s.string2buf(A):h.call(A)==="[object ArrayBuffer]"?new Uint8Array(A):A,m=o.inflateSetDictionary(this.strm,D)),m===u.Z_BUF_ERROR&&N===!0&&(m=u.Z_OK,N=!1),m!==u.Z_STREAM_END&&m!==u.Z_OK)return this.onEnd(m),!(this.ended=!0);E.next_out&&(E.avail_out!==0&&m!==u.Z_STREAM_END&&(E.avail_in!==0||g!==u.Z_FINISH&&g!==u.Z_SYNC_FLUSH)||(this.options.to==="string"?(w=s.utf8border(E.output,E.next_out),S=E.next_out-w,k=s.buf2string(E.output,w),E.next_out=S,E.avail_out=I-S,S&&a.arraySet(E.output,E.output,w,S,0),this.onData(k)):this.onData(a.shrinkBuf(E.output,E.next_out)))),E.avail_in===0&&E.avail_out===0&&(N=!0)}while((0<E.avail_in||E.avail_out===0)&&m!==u.Z_STREAM_END);return m===u.Z_STREAM_END&&(g=u.Z_FINISH),g===u.Z_FINISH?(m=o.inflateEnd(this.strm),this.onEnd(m),this.ended=!0,m===u.Z_OK):g!==u.Z_SYNC_FLUSH||(this.onEnd(u.Z_OK),!(E.avail_out=0))},d.prototype.onData=function(p){this.chunks.push(p)},d.prototype.onEnd=function(p){p===u.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=p,this.msg=this.strm.msg},i.Inflate=d,i.inflate=y,i.inflateRaw=function(p,b){return(b=b||{}).raw=!0,y(p,b)},i.ungzip=y},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(r,n,i){var o=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";i.assign=function(u){for(var c=Array.prototype.slice.call(arguments,1);c.length;){var l=c.shift();if(l){if(typeof l!="object")throw new TypeError(l+"must be non-object");for(var f in l)l.hasOwnProperty(f)&&(u[f]=l[f])}}return u},i.shrinkBuf=function(u,c){return u.length===c?u:u.subarray?u.subarray(0,c):(u.length=c,u)};var a={arraySet:function(u,c,l,f,h){if(c.subarray&&u.subarray)u.set(c.subarray(l,l+f),h);else for(var d=0;d<f;d++)u[h+d]=c[l+d]},flattenChunks:function(u){var c,l,f,h,d,y;for(c=f=0,l=u.length;c<l;c++)f+=u[c].length;for(y=new Uint8Array(f),c=h=0,l=u.length;c<l;c++)d=u[c],y.set(d,h),h+=d.length;return y}},s={arraySet:function(u,c,l,f,h){for(var d=0;d<f;d++)u[h+d]=c[l+d]},flattenChunks:function(u){return[].concat.apply([],u)}};i.setTyped=function(u){u?(i.Buf8=Uint8Array,i.Buf16=Uint16Array,i.Buf32=Int32Array,i.assign(i,a)):(i.Buf8=Array,i.Buf16=Array,i.Buf32=Array,i.assign(i,s))},i.setTyped(o)},{}],42:[function(r,n,i){var o=r("./common"),a=!0,s=!0;try{String.fromCharCode.apply(null,[0])}catch{a=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{s=!1}for(var u=new o.Buf8(256),c=0;c<256;c++)u[c]=252<=c?6:248<=c?5:240<=c?4:224<=c?3:192<=c?2:1;function l(f,h){if(h<65537&&(f.subarray&&s||!f.subarray&&a))return String.fromCharCode.apply(null,o.shrinkBuf(f,h));for(var d="",y=0;y<h;y++)d+=String.fromCharCode(f[y]);return d}u[254]=u[254]=1,i.string2buf=function(f){var h,d,y,p,b,m=f.length,g=0;for(p=0;p<m;p++)(64512&(d=f.charCodeAt(p)))==55296&&p+1<m&&(64512&(y=f.charCodeAt(p+1)))==56320&&(d=65536+(d-55296<<10)+(y-56320),p++),g+=d<128?1:d<2048?2:d<65536?3:4;for(h=new o.Buf8(g),p=b=0;b<g;p++)(64512&(d=f.charCodeAt(p)))==55296&&p+1<m&&(64512&(y=f.charCodeAt(p+1)))==56320&&(d=65536+(d-55296<<10)+(y-56320),p++),d<128?h[b++]=d:(d<2048?h[b++]=192|d>>>6:(d<65536?h[b++]=224|d>>>12:(h[b++]=240|d>>>18,h[b++]=128|d>>>12&63),h[b++]=128|d>>>6&63),h[b++]=128|63&d);return h},i.buf2binstring=function(f){return l(f,f.length)},i.binstring2buf=function(f){for(var h=new o.Buf8(f.length),d=0,y=h.length;d<y;d++)h[d]=f.charCodeAt(d);return h},i.buf2string=function(f,h){var d,y,p,b,m=h||f.length,g=new Array(2*m);for(d=y=0;d<m;)if((p=f[d++])<128)g[y++]=p;else if(4<(b=u[p]))g[y++]=65533,d+=b-1;else{for(p&=b===2?31:b===3?15:7;1<b&&d<m;)p=p<<6|63&f[d++],b--;1<b?g[y++]=65533:p<65536?g[y++]=p:(p-=65536,g[y++]=55296|p>>10&1023,g[y++]=56320|1023&p)}return l(g,y)},i.utf8border=function(f,h){var d;for((h=h||f.length)>f.length&&(h=f.length),d=h-1;0<=d&&(192&f[d])==128;)d--;return d<0||d===0?h:d+u[f[d]]>h?d:h}},{"./common":41}],43:[function(r,n,i){n.exports=function(o,a,s,u){for(var c=65535&o|0,l=o>>>16&65535|0,f=0;s!==0;){for(s-=f=2e3<s?2e3:s;l=l+(c=c+a[u++]|0)|0,--f;);c%=65521,l%=65521}return c|l<<16|0}},{}],44:[function(r,n,i){n.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(r,n,i){var o=function(){for(var a,s=[],u=0;u<256;u++){a=u;for(var c=0;c<8;c++)a=1&a?3988292384^a>>>1:a>>>1;s[u]=a}return s}();n.exports=function(a,s,u,c){var l=o,f=c+u;a^=-1;for(var h=c;h<f;h++)a=a>>>8^l[255&(a^s[h])];return-1^a}},{}],46:[function(r,n,i){var o,a=r("../utils/common"),s=r("./trees"),u=r("./adler32"),c=r("./crc32"),l=r("./messages"),f=0,h=4,d=0,y=-2,p=-1,b=4,m=2,g=8,w=9,S=286,k=30,D=19,E=2*S+1,I=15,A=3,N=258,G=N+A+1,C=42,M=113,_=1,F=2,ee=3,j=4;function te(v,z){return v.msg=l[z],z}function L(v){return(v<<1)-(4<v?9:0)}function J(v){for(var z=v.length;0<=--z;)v[z]=0}function B(v){var z=v.state,$=z.pending;$>v.avail_out&&($=v.avail_out),$!==0&&(a.arraySet(v.output,z.pending_buf,z.pending_out,$,v.next_out),v.next_out+=$,z.pending_out+=$,v.total_out+=$,v.avail_out-=$,z.pending-=$,z.pending===0&&(z.pending_out=0))}function T(v,z){s._tr_flush_block(v,0<=v.block_start?v.block_start:-1,v.strstart-v.block_start,z),v.block_start=v.strstart,B(v.strm)}function ie(v,z){v.pending_buf[v.pending++]=z}function Y(v,z){v.pending_buf[v.pending++]=z>>>8&255,v.pending_buf[v.pending++]=255&z}function Q(v,z){var $,O,x=v.max_chain_length,P=v.strstart,U=v.prev_length,K=v.nice_match,R=v.strstart>v.w_size-G?v.strstart-(v.w_size-G):0,W=v.window,Z=v.w_mask,H=v.prev,ne=v.strstart+N,de=W[P+U-1],ce=W[P+U];v.prev_length>=v.good_match&&(x>>=2),K>v.lookahead&&(K=v.lookahead);do if(W[($=z)+U]===ce&&W[$+U-1]===de&&W[$]===W[P]&&W[++$]===W[P+1]){P+=2,$++;do;while(W[++P]===W[++$]&&W[++P]===W[++$]&&W[++P]===W[++$]&&W[++P]===W[++$]&&W[++P]===W[++$]&&W[++P]===W[++$]&&W[++P]===W[++$]&&W[++P]===W[++$]&&P<ne);if(O=N-(ne-P),P=ne-N,U<O){if(v.match_start=z,K<=(U=O))break;de=W[P+U-1],ce=W[P+U]}}while((z=H[z&Z])>R&&--x!=0);return U<=v.lookahead?U:v.lookahead}function we(v){var z,$,O,x,P,U,K,R,W,Z,H=v.w_size;do{if(x=v.window_size-v.lookahead-v.strstart,v.strstart>=H+(H-G)){for(a.arraySet(v.window,v.window,H,H,0),v.match_start-=H,v.strstart-=H,v.block_start-=H,z=$=v.hash_size;O=v.head[--z],v.head[z]=H<=O?O-H:0,--$;);for(z=$=H;O=v.prev[--z],v.prev[z]=H<=O?O-H:0,--$;);x+=H}if(v.strm.avail_in===0)break;if(U=v.strm,K=v.window,R=v.strstart+v.lookahead,W=x,Z=void 0,Z=U.avail_in,W<Z&&(Z=W),$=Z===0?0:(U.avail_in-=Z,a.arraySet(K,U.input,U.next_in,Z,R),U.state.wrap===1?U.adler=u(U.adler,K,Z,R):U.state.wrap===2&&(U.adler=c(U.adler,K,Z,R)),U.next_in+=Z,U.total_in+=Z,Z),v.lookahead+=$,v.lookahead+v.insert>=A)for(P=v.strstart-v.insert,v.ins_h=v.window[P],v.ins_h=(v.ins_h<<v.hash_shift^v.window[P+1])&v.hash_mask;v.insert&&(v.ins_h=(v.ins_h<<v.hash_shift^v.window[P+A-1])&v.hash_mask,v.prev[P&v.w_mask]=v.head[v.ins_h],v.head[v.ins_h]=P,P++,v.insert--,!(v.lookahead+v.insert<A)););}while(v.lookahead<G&&v.strm.avail_in!==0)}function $e(v,z){for(var $,O;;){if(v.lookahead<G){if(we(v),v.lookahead<G&&z===f)return _;if(v.lookahead===0)break}if($=0,v.lookahead>=A&&(v.ins_h=(v.ins_h<<v.hash_shift^v.window[v.strstart+A-1])&v.hash_mask,$=v.prev[v.strstart&v.w_mask]=v.head[v.ins_h],v.head[v.ins_h]=v.strstart),$!==0&&v.strstart-$<=v.w_size-G&&(v.match_length=Q(v,$)),v.match_length>=A)if(O=s._tr_tally(v,v.strstart-v.match_start,v.match_length-A),v.lookahead-=v.match_length,v.match_length<=v.max_lazy_match&&v.lookahead>=A){for(v.match_length--;v.strstart++,v.ins_h=(v.ins_h<<v.hash_shift^v.window[v.strstart+A-1])&v.hash_mask,$=v.prev[v.strstart&v.w_mask]=v.head[v.ins_h],v.head[v.ins_h]=v.strstart,--v.match_length!=0;);v.strstart++}else v.strstart+=v.match_length,v.match_length=0,v.ins_h=v.window[v.strstart],v.ins_h=(v.ins_h<<v.hash_shift^v.window[v.strstart+1])&v.hash_mask;else O=s._tr_tally(v,0,v.window[v.strstart]),v.lookahead--,v.strstart++;if(O&&(T(v,!1),v.strm.avail_out===0))return _}return v.insert=v.strstart<A-1?v.strstart:A-1,z===h?(T(v,!0),v.strm.avail_out===0?ee:j):v.last_lit&&(T(v,!1),v.strm.avail_out===0)?_:F}function ue(v,z){for(var $,O,x;;){if(v.lookahead<G){if(we(v),v.lookahead<G&&z===f)return _;if(v.lookahead===0)break}if($=0,v.lookahead>=A&&(v.ins_h=(v.ins_h<<v.hash_shift^v.window[v.strstart+A-1])&v.hash_mask,$=v.prev[v.strstart&v.w_mask]=v.head[v.ins_h],v.head[v.ins_h]=v.strstart),v.prev_length=v.match_length,v.prev_match=v.match_start,v.match_length=A-1,$!==0&&v.prev_length<v.max_lazy_match&&v.strstart-$<=v.w_size-G&&(v.match_length=Q(v,$),v.match_length<=5&&(v.strategy===1||v.match_length===A&&4096<v.strstart-v.match_start)&&(v.match_length=A-1)),v.prev_length>=A&&v.match_length<=v.prev_length){for(x=v.strstart+v.lookahead-A,O=s._tr_tally(v,v.strstart-1-v.prev_match,v.prev_length-A),v.lookahead-=v.prev_length-1,v.prev_length-=2;++v.strstart<=x&&(v.ins_h=(v.ins_h<<v.hash_shift^v.window[v.strstart+A-1])&v.hash_mask,$=v.prev[v.strstart&v.w_mask]=v.head[v.ins_h],v.head[v.ins_h]=v.strstart),--v.prev_length!=0;);if(v.match_available=0,v.match_length=A-1,v.strstart++,O&&(T(v,!1),v.strm.avail_out===0))return _}else if(v.match_available){if((O=s._tr_tally(v,0,v.window[v.strstart-1]))&&T(v,!1),v.strstart++,v.lookahead--,v.strm.avail_out===0)return _}else v.match_available=1,v.strstart++,v.lookahead--}return v.match_available&&(O=s._tr_tally(v,0,v.window[v.strstart-1]),v.match_available=0),v.insert=v.strstart<A-1?v.strstart:A-1,z===h?(T(v,!0),v.strm.avail_out===0?ee:j):v.last_lit&&(T(v,!1),v.strm.avail_out===0)?_:F}function le(v,z,$,O,x){this.good_length=v,this.max_lazy=z,this.nice_length=$,this.max_chain=O,this.func=x}function Ae(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=g,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new a.Buf16(2*E),this.dyn_dtree=new a.Buf16(2*(2*k+1)),this.bl_tree=new a.Buf16(2*(2*D+1)),J(this.dyn_ltree),J(this.dyn_dtree),J(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new a.Buf16(I+1),this.heap=new a.Buf16(2*S+1),J(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new a.Buf16(2*S+1),J(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function ke(v){var z;return v&&v.state?(v.total_in=v.total_out=0,v.data_type=m,(z=v.state).pending=0,z.pending_out=0,z.wrap<0&&(z.wrap=-z.wrap),z.status=z.wrap?C:M,v.adler=z.wrap===2?0:1,z.last_flush=f,s._tr_init(z),d):te(v,y)}function st(v){var z=ke(v);return z===d&&function($){$.window_size=2*$.w_size,J($.head),$.max_lazy_match=o[$.level].max_lazy,$.good_match=o[$.level].good_length,$.nice_match=o[$.level].nice_length,$.max_chain_length=o[$.level].max_chain,$.strstart=0,$.block_start=0,$.lookahead=0,$.insert=0,$.match_length=$.prev_length=A-1,$.match_available=0,$.ins_h=0}(v.state),z}function et(v,z,$,O,x,P){if(!v)return y;var U=1;if(z===p&&(z=6),O<0?(U=0,O=-O):15<O&&(U=2,O-=16),x<1||w<x||$!==g||O<8||15<O||z<0||9<z||P<0||b<P)return te(v,y);O===8&&(O=9);var K=new Ae;return(v.state=K).strm=v,K.wrap=U,K.gzhead=null,K.w_bits=O,K.w_size=1<<K.w_bits,K.w_mask=K.w_size-1,K.hash_bits=x+7,K.hash_size=1<<K.hash_bits,K.hash_mask=K.hash_size-1,K.hash_shift=~~((K.hash_bits+A-1)/A),K.window=new a.Buf8(2*K.w_size),K.head=new a.Buf16(K.hash_size),K.prev=new a.Buf16(K.w_size),K.lit_bufsize=1<<x+6,K.pending_buf_size=4*K.lit_bufsize,K.pending_buf=new a.Buf8(K.pending_buf_size),K.d_buf=1*K.lit_bufsize,K.l_buf=3*K.lit_bufsize,K.level=z,K.strategy=P,K.method=$,st(v)}o=[new le(0,0,0,0,function(v,z){var $=65535;for($>v.pending_buf_size-5&&($=v.pending_buf_size-5);;){if(v.lookahead<=1){if(we(v),v.lookahead===0&&z===f)return _;if(v.lookahead===0)break}v.strstart+=v.lookahead,v.lookahead=0;var O=v.block_start+$;if((v.strstart===0||v.strstart>=O)&&(v.lookahead=v.strstart-O,v.strstart=O,T(v,!1),v.strm.avail_out===0)||v.strstart-v.block_start>=v.w_size-G&&(T(v,!1),v.strm.avail_out===0))return _}return v.insert=0,z===h?(T(v,!0),v.strm.avail_out===0?ee:j):(v.strstart>v.block_start&&(T(v,!1),v.strm.avail_out),_)}),new le(4,4,8,4,$e),new le(4,5,16,8,$e),new le(4,6,32,32,$e),new le(4,4,16,16,ue),new le(8,16,32,32,ue),new le(8,16,128,128,ue),new le(8,32,128,256,ue),new le(32,128,258,1024,ue),new le(32,258,258,4096,ue)],i.deflateInit=function(v,z){return et(v,z,g,15,8,0)},i.deflateInit2=et,i.deflateReset=st,i.deflateResetKeep=ke,i.deflateSetHeader=function(v,z){return v&&v.state?v.state.wrap!==2?y:(v.state.gzhead=z,d):y},i.deflate=function(v,z){var $,O,x,P;if(!v||!v.state||5<z||z<0)return v?te(v,y):y;if(O=v.state,!v.output||!v.input&&v.avail_in!==0||O.status===666&&z!==h)return te(v,v.avail_out===0?-5:y);if(O.strm=v,$=O.last_flush,O.last_flush=z,O.status===C)if(O.wrap===2)v.adler=0,ie(O,31),ie(O,139),ie(O,8),O.gzhead?(ie(O,(O.gzhead.text?1:0)+(O.gzhead.hcrc?2:0)+(O.gzhead.extra?4:0)+(O.gzhead.name?8:0)+(O.gzhead.comment?16:0)),ie(O,255&O.gzhead.time),ie(O,O.gzhead.time>>8&255),ie(O,O.gzhead.time>>16&255),ie(O,O.gzhead.time>>24&255),ie(O,O.level===9?2:2<=O.strategy||O.level<2?4:0),ie(O,255&O.gzhead.os),O.gzhead.extra&&O.gzhead.extra.length&&(ie(O,255&O.gzhead.extra.length),ie(O,O.gzhead.extra.length>>8&255)),O.gzhead.hcrc&&(v.adler=c(v.adler,O.pending_buf,O.pending,0)),O.gzindex=0,O.status=69):(ie(O,0),ie(O,0),ie(O,0),ie(O,0),ie(O,0),ie(O,O.level===9?2:2<=O.strategy||O.level<2?4:0),ie(O,3),O.status=M);else{var U=g+(O.w_bits-8<<4)<<8;U|=(2<=O.strategy||O.level<2?0:O.level<6?1:O.level===6?2:3)<<6,O.strstart!==0&&(U|=32),U+=31-U%31,O.status=M,Y(O,U),O.strstart!==0&&(Y(O,v.adler>>>16),Y(O,65535&v.adler)),v.adler=1}if(O.status===69)if(O.gzhead.extra){for(x=O.pending;O.gzindex<(65535&O.gzhead.extra.length)&&(O.pending!==O.pending_buf_size||(O.gzhead.hcrc&&O.pending>x&&(v.adler=c(v.adler,O.pending_buf,O.pending-x,x)),B(v),x=O.pending,O.pending!==O.pending_buf_size));)ie(O,255&O.gzhead.extra[O.gzindex]),O.gzindex++;O.gzhead.hcrc&&O.pending>x&&(v.adler=c(v.adler,O.pending_buf,O.pending-x,x)),O.gzindex===O.gzhead.extra.length&&(O.gzindex=0,O.status=73)}else O.status=73;if(O.status===73)if(O.gzhead.name){x=O.pending;do{if(O.pending===O.pending_buf_size&&(O.gzhead.hcrc&&O.pending>x&&(v.adler=c(v.adler,O.pending_buf,O.pending-x,x)),B(v),x=O.pending,O.pending===O.pending_buf_size)){P=1;break}P=O.gzindex<O.gzhead.name.length?255&O.gzhead.name.charCodeAt(O.gzindex++):0,ie(O,P)}while(P!==0);O.gzhead.hcrc&&O.pending>x&&(v.adler=c(v.adler,O.pending_buf,O.pending-x,x)),P===0&&(O.gzindex=0,O.status=91)}else O.status=91;if(O.status===91)if(O.gzhead.comment){x=O.pending;do{if(O.pending===O.pending_buf_size&&(O.gzhead.hcrc&&O.pending>x&&(v.adler=c(v.adler,O.pending_buf,O.pending-x,x)),B(v),x=O.pending,O.pending===O.pending_buf_size)){P=1;break}P=O.gzindex<O.gzhead.comment.length?255&O.gzhead.comment.charCodeAt(O.gzindex++):0,ie(O,P)}while(P!==0);O.gzhead.hcrc&&O.pending>x&&(v.adler=c(v.adler,O.pending_buf,O.pending-x,x)),P===0&&(O.status=103)}else O.status=103;if(O.status===103&&(O.gzhead.hcrc?(O.pending+2>O.pending_buf_size&&B(v),O.pending+2<=O.pending_buf_size&&(ie(O,255&v.adler),ie(O,v.adler>>8&255),v.adler=0,O.status=M)):O.status=M),O.pending!==0){if(B(v),v.avail_out===0)return O.last_flush=-1,d}else if(v.avail_in===0&&L(z)<=L($)&&z!==h)return te(v,-5);if(O.status===666&&v.avail_in!==0)return te(v,-5);if(v.avail_in!==0||O.lookahead!==0||z!==f&&O.status!==666){var K=O.strategy===2?function(R,W){for(var Z;;){if(R.lookahead===0&&(we(R),R.lookahead===0)){if(W===f)return _;break}if(R.match_length=0,Z=s._tr_tally(R,0,R.window[R.strstart]),R.lookahead--,R.strstart++,Z&&(T(R,!1),R.strm.avail_out===0))return _}return R.insert=0,W===h?(T(R,!0),R.strm.avail_out===0?ee:j):R.last_lit&&(T(R,!1),R.strm.avail_out===0)?_:F}(O,z):O.strategy===3?function(R,W){for(var Z,H,ne,de,ce=R.window;;){if(R.lookahead<=N){if(we(R),R.lookahead<=N&&W===f)return _;if(R.lookahead===0)break}if(R.match_length=0,R.lookahead>=A&&0<R.strstart&&(H=ce[ne=R.strstart-1])===ce[++ne]&&H===ce[++ne]&&H===ce[++ne]){de=R.strstart+N;do;while(H===ce[++ne]&&H===ce[++ne]&&H===ce[++ne]&&H===ce[++ne]&&H===ce[++ne]&&H===ce[++ne]&&H===ce[++ne]&&H===ce[++ne]&&ne<de);R.match_length=N-(de-ne),R.match_length>R.lookahead&&(R.match_length=R.lookahead)}if(R.match_length>=A?(Z=s._tr_tally(R,1,R.match_length-A),R.lookahead-=R.match_length,R.strstart+=R.match_length,R.match_length=0):(Z=s._tr_tally(R,0,R.window[R.strstart]),R.lookahead--,R.strstart++),Z&&(T(R,!1),R.strm.avail_out===0))return _}return R.insert=0,W===h?(T(R,!0),R.strm.avail_out===0?ee:j):R.last_lit&&(T(R,!1),R.strm.avail_out===0)?_:F}(O,z):o[O.level].func(O,z);if(K!==ee&&K!==j||(O.status=666),K===_||K===ee)return v.avail_out===0&&(O.last_flush=-1),d;if(K===F&&(z===1?s._tr_align(O):z!==5&&(s._tr_stored_block(O,0,0,!1),z===3&&(J(O.head),O.lookahead===0&&(O.strstart=0,O.block_start=0,O.insert=0))),B(v),v.avail_out===0))return O.last_flush=-1,d}return z!==h?d:O.wrap<=0?1:(O.wrap===2?(ie(O,255&v.adler),ie(O,v.adler>>8&255),ie(O,v.adler>>16&255),ie(O,v.adler>>24&255),ie(O,255&v.total_in),ie(O,v.total_in>>8&255),ie(O,v.total_in>>16&255),ie(O,v.total_in>>24&255)):(Y(O,v.adler>>>16),Y(O,65535&v.adler)),B(v),0<O.wrap&&(O.wrap=-O.wrap),O.pending!==0?d:1)},i.deflateEnd=function(v){var z;return v&&v.state?(z=v.state.status)!==C&&z!==69&&z!==73&&z!==91&&z!==103&&z!==M&&z!==666?te(v,y):(v.state=null,z===M?te(v,-3):d):y},i.deflateSetDictionary=function(v,z){var $,O,x,P,U,K,R,W,Z=z.length;if(!v||!v.state||(P=($=v.state).wrap)===2||P===1&&$.status!==C||$.lookahead)return y;for(P===1&&(v.adler=u(v.adler,z,Z,0)),$.wrap=0,Z>=$.w_size&&(P===0&&(J($.head),$.strstart=0,$.block_start=0,$.insert=0),W=new a.Buf8($.w_size),a.arraySet(W,z,Z-$.w_size,$.w_size,0),z=W,Z=$.w_size),U=v.avail_in,K=v.next_in,R=v.input,v.avail_in=Z,v.next_in=0,v.input=z,we($);$.lookahead>=A;){for(O=$.strstart,x=$.lookahead-(A-1);$.ins_h=($.ins_h<<$.hash_shift^$.window[O+A-1])&$.hash_mask,$.prev[O&$.w_mask]=$.head[$.ins_h],$.head[$.ins_h]=O,O++,--x;);$.strstart=O,$.lookahead=A-1,we($)}return $.strstart+=$.lookahead,$.block_start=$.strstart,$.insert=$.lookahead,$.lookahead=0,$.match_length=$.prev_length=A-1,$.match_available=0,v.next_in=K,v.input=R,v.avail_in=U,$.wrap=P,d},i.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(r,n,i){n.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(r,n,i){n.exports=function(o,a){var s,u,c,l,f,h,d,y,p,b,m,g,w,S,k,D,E,I,A,N,G,C,M,_,F;s=o.state,u=o.next_in,_=o.input,c=u+(o.avail_in-5),l=o.next_out,F=o.output,f=l-(a-o.avail_out),h=l+(o.avail_out-257),d=s.dmax,y=s.wsize,p=s.whave,b=s.wnext,m=s.window,g=s.hold,w=s.bits,S=s.lencode,k=s.distcode,D=(1<<s.lenbits)-1,E=(1<<s.distbits)-1;e:do{w<15&&(g+=_[u++]<<w,w+=8,g+=_[u++]<<w,w+=8),I=S[g&D];t:for(;;){if(g>>>=A=I>>>24,w-=A,(A=I>>>16&255)===0)F[l++]=65535&I;else{if(!(16&A)){if(!(64&A)){I=S[(65535&I)+(g&(1<<A)-1)];continue t}if(32&A){s.mode=12;break e}o.msg="invalid literal/length code",s.mode=30;break e}N=65535&I,(A&=15)&&(w<A&&(g+=_[u++]<<w,w+=8),N+=g&(1<<A)-1,g>>>=A,w-=A),w<15&&(g+=_[u++]<<w,w+=8,g+=_[u++]<<w,w+=8),I=k[g&E];r:for(;;){if(g>>>=A=I>>>24,w-=A,!(16&(A=I>>>16&255))){if(!(64&A)){I=k[(65535&I)+(g&(1<<A)-1)];continue r}o.msg="invalid distance code",s.mode=30;break e}if(G=65535&I,w<(A&=15)&&(g+=_[u++]<<w,(w+=8)<A&&(g+=_[u++]<<w,w+=8)),d<(G+=g&(1<<A)-1)){o.msg="invalid distance too far back",s.mode=30;break e}if(g>>>=A,w-=A,(A=l-f)<G){if(p<(A=G-A)&&s.sane){o.msg="invalid distance too far back",s.mode=30;break e}if(M=m,(C=0)===b){if(C+=y-A,A<N){for(N-=A;F[l++]=m[C++],--A;);C=l-G,M=F}}else if(b<A){if(C+=y+b-A,(A-=b)<N){for(N-=A;F[l++]=m[C++],--A;);if(C=0,b<N){for(N-=A=b;F[l++]=m[C++],--A;);C=l-G,M=F}}}else if(C+=b-A,A<N){for(N-=A;F[l++]=m[C++],--A;);C=l-G,M=F}for(;2<N;)F[l++]=M[C++],F[l++]=M[C++],F[l++]=M[C++],N-=3;N&&(F[l++]=M[C++],1<N&&(F[l++]=M[C++]))}else{for(C=l-G;F[l++]=F[C++],F[l++]=F[C++],F[l++]=F[C++],2<(N-=3););N&&(F[l++]=F[C++],1<N&&(F[l++]=F[C++]))}break}}break}}while(u<c&&l<h);u-=N=w>>3,g&=(1<<(w-=N<<3))-1,o.next_in=u,o.next_out=l,o.avail_in=u<c?c-u+5:5-(u-c),o.avail_out=l<h?h-l+257:257-(l-h),s.hold=g,s.bits=w}},{}],49:[function(r,n,i){var o=r("../utils/common"),a=r("./adler32"),s=r("./crc32"),u=r("./inffast"),c=r("./inftrees"),l=1,f=2,h=0,d=-2,y=1,p=852,b=592;function m(C){return(C>>>24&255)+(C>>>8&65280)+((65280&C)<<8)+((255&C)<<24)}function g(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new o.Buf16(320),this.work=new o.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function w(C){var M;return C&&C.state?(M=C.state,C.total_in=C.total_out=M.total=0,C.msg="",M.wrap&&(C.adler=1&M.wrap),M.mode=y,M.last=0,M.havedict=0,M.dmax=32768,M.head=null,M.hold=0,M.bits=0,M.lencode=M.lendyn=new o.Buf32(p),M.distcode=M.distdyn=new o.Buf32(b),M.sane=1,M.back=-1,h):d}function S(C){var M;return C&&C.state?((M=C.state).wsize=0,M.whave=0,M.wnext=0,w(C)):d}function k(C,M){var _,F;return C&&C.state?(F=C.state,M<0?(_=0,M=-M):(_=1+(M>>4),M<48&&(M&=15)),M&&(M<8||15<M)?d:(F.window!==null&&F.wbits!==M&&(F.window=null),F.wrap=_,F.wbits=M,S(C))):d}function D(C,M){var _,F;return C?(F=new g,(C.state=F).window=null,(_=k(C,M))!==h&&(C.state=null),_):d}var E,I,A=!0;function N(C){if(A){var M;for(E=new o.Buf32(512),I=new o.Buf32(32),M=0;M<144;)C.lens[M++]=8;for(;M<256;)C.lens[M++]=9;for(;M<280;)C.lens[M++]=7;for(;M<288;)C.lens[M++]=8;for(c(l,C.lens,0,288,E,0,C.work,{bits:9}),M=0;M<32;)C.lens[M++]=5;c(f,C.lens,0,32,I,0,C.work,{bits:5}),A=!1}C.lencode=E,C.lenbits=9,C.distcode=I,C.distbits=5}function G(C,M,_,F){var ee,j=C.state;return j.window===null&&(j.wsize=1<<j.wbits,j.wnext=0,j.whave=0,j.window=new o.Buf8(j.wsize)),F>=j.wsize?(o.arraySet(j.window,M,_-j.wsize,j.wsize,0),j.wnext=0,j.whave=j.wsize):(F<(ee=j.wsize-j.wnext)&&(ee=F),o.arraySet(j.window,M,_-F,ee,j.wnext),(F-=ee)?(o.arraySet(j.window,M,_-F,F,0),j.wnext=F,j.whave=j.wsize):(j.wnext+=ee,j.wnext===j.wsize&&(j.wnext=0),j.whave<j.wsize&&(j.whave+=ee))),0}i.inflateReset=S,i.inflateReset2=k,i.inflateResetKeep=w,i.inflateInit=function(C){return D(C,15)},i.inflateInit2=D,i.inflate=function(C,M){var _,F,ee,j,te,L,J,B,T,ie,Y,Q,we,$e,ue,le,Ae,ke,st,et,v,z,$,O,x=0,P=new o.Buf8(4),U=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!C||!C.state||!C.output||!C.input&&C.avail_in!==0)return d;(_=C.state).mode===12&&(_.mode=13),te=C.next_out,ee=C.output,J=C.avail_out,j=C.next_in,F=C.input,L=C.avail_in,B=_.hold,T=_.bits,ie=L,Y=J,z=h;e:for(;;)switch(_.mode){case y:if(_.wrap===0){_.mode=13;break}for(;T<16;){if(L===0)break e;L--,B+=F[j++]<<T,T+=8}if(2&_.wrap&&B===35615){P[_.check=0]=255&B,P[1]=B>>>8&255,_.check=s(_.check,P,2,0),T=B=0,_.mode=2;break}if(_.flags=0,_.head&&(_.head.done=!1),!(1&_.wrap)||(((255&B)<<8)+(B>>8))%31){C.msg="incorrect header check",_.mode=30;break}if((15&B)!=8){C.msg="unknown compression method",_.mode=30;break}if(T-=4,v=8+(15&(B>>>=4)),_.wbits===0)_.wbits=v;else if(v>_.wbits){C.msg="invalid window size",_.mode=30;break}_.dmax=1<<v,C.adler=_.check=1,_.mode=512&B?10:12,T=B=0;break;case 2:for(;T<16;){if(L===0)break e;L--,B+=F[j++]<<T,T+=8}if(_.flags=B,(255&_.flags)!=8){C.msg="unknown compression method",_.mode=30;break}if(57344&_.flags){C.msg="unknown header flags set",_.mode=30;break}_.head&&(_.head.text=B>>8&1),512&_.flags&&(P[0]=255&B,P[1]=B>>>8&255,_.check=s(_.check,P,2,0)),T=B=0,_.mode=3;case 3:for(;T<32;){if(L===0)break e;L--,B+=F[j++]<<T,T+=8}_.head&&(_.head.time=B),512&_.flags&&(P[0]=255&B,P[1]=B>>>8&255,P[2]=B>>>16&255,P[3]=B>>>24&255,_.check=s(_.check,P,4,0)),T=B=0,_.mode=4;case 4:for(;T<16;){if(L===0)break e;L--,B+=F[j++]<<T,T+=8}_.head&&(_.head.xflags=255&B,_.head.os=B>>8),512&_.flags&&(P[0]=255&B,P[1]=B>>>8&255,_.check=s(_.check,P,2,0)),T=B=0,_.mode=5;case 5:if(1024&_.flags){for(;T<16;){if(L===0)break e;L--,B+=F[j++]<<T,T+=8}_.length=B,_.head&&(_.head.extra_len=B),512&_.flags&&(P[0]=255&B,P[1]=B>>>8&255,_.check=s(_.check,P,2,0)),T=B=0}else _.head&&(_.head.extra=null);_.mode=6;case 6:if(1024&_.flags&&(L<(Q=_.length)&&(Q=L),Q&&(_.head&&(v=_.head.extra_len-_.length,_.head.extra||(_.head.extra=new Array(_.head.extra_len)),o.arraySet(_.head.extra,F,j,Q,v)),512&_.flags&&(_.check=s(_.check,F,Q,j)),L-=Q,j+=Q,_.length-=Q),_.length))break e;_.length=0,_.mode=7;case 7:if(2048&_.flags){if(L===0)break e;for(Q=0;v=F[j+Q++],_.head&&v&&_.length<65536&&(_.head.name+=String.fromCharCode(v)),v&&Q<L;);if(512&_.flags&&(_.check=s(_.check,F,Q,j)),L-=Q,j+=Q,v)break e}else _.head&&(_.head.name=null);_.length=0,_.mode=8;case 8:if(4096&_.flags){if(L===0)break e;for(Q=0;v=F[j+Q++],_.head&&v&&_.length<65536&&(_.head.comment+=String.fromCharCode(v)),v&&Q<L;);if(512&_.flags&&(_.check=s(_.check,F,Q,j)),L-=Q,j+=Q,v)break e}else _.head&&(_.head.comment=null);_.mode=9;case 9:if(512&_.flags){for(;T<16;){if(L===0)break e;L--,B+=F[j++]<<T,T+=8}if(B!==(65535&_.check)){C.msg="header crc mismatch",_.mode=30;break}T=B=0}_.head&&(_.head.hcrc=_.flags>>9&1,_.head.done=!0),C.adler=_.check=0,_.mode=12;break;case 10:for(;T<32;){if(L===0)break e;L--,B+=F[j++]<<T,T+=8}C.adler=_.check=m(B),T=B=0,_.mode=11;case 11:if(_.havedict===0)return C.next_out=te,C.avail_out=J,C.next_in=j,C.avail_in=L,_.hold=B,_.bits=T,2;C.adler=_.check=1,_.mode=12;case 12:if(M===5||M===6)break e;case 13:if(_.last){B>>>=7&T,T-=7&T,_.mode=27;break}for(;T<3;){if(L===0)break e;L--,B+=F[j++]<<T,T+=8}switch(_.last=1&B,T-=1,3&(B>>>=1)){case 0:_.mode=14;break;case 1:if(N(_),_.mode=20,M!==6)break;B>>>=2,T-=2;break e;case 2:_.mode=17;break;case 3:C.msg="invalid block type",_.mode=30}B>>>=2,T-=2;break;case 14:for(B>>>=7&T,T-=7&T;T<32;){if(L===0)break e;L--,B+=F[j++]<<T,T+=8}if((65535&B)!=(B>>>16^65535)){C.msg="invalid stored block lengths",_.mode=30;break}if(_.length=65535&B,T=B=0,_.mode=15,M===6)break e;case 15:_.mode=16;case 16:if(Q=_.length){if(L<Q&&(Q=L),J<Q&&(Q=J),Q===0)break e;o.arraySet(ee,F,j,Q,te),L-=Q,j+=Q,J-=Q,te+=Q,_.length-=Q;break}_.mode=12;break;case 17:for(;T<14;){if(L===0)break e;L--,B+=F[j++]<<T,T+=8}if(_.nlen=257+(31&B),B>>>=5,T-=5,_.ndist=1+(31&B),B>>>=5,T-=5,_.ncode=4+(15&B),B>>>=4,T-=4,286<_.nlen||30<_.ndist){C.msg="too many length or distance symbols",_.mode=30;break}_.have=0,_.mode=18;case 18:for(;_.have<_.ncode;){for(;T<3;){if(L===0)break e;L--,B+=F[j++]<<T,T+=8}_.lens[U[_.have++]]=7&B,B>>>=3,T-=3}for(;_.have<19;)_.lens[U[_.have++]]=0;if(_.lencode=_.lendyn,_.lenbits=7,$={bits:_.lenbits},z=c(0,_.lens,0,19,_.lencode,0,_.work,$),_.lenbits=$.bits,z){C.msg="invalid code lengths set",_.mode=30;break}_.have=0,_.mode=19;case 19:for(;_.have<_.nlen+_.ndist;){for(;le=(x=_.lencode[B&(1<<_.lenbits)-1])>>>16&255,Ae=65535&x,!((ue=x>>>24)<=T);){if(L===0)break e;L--,B+=F[j++]<<T,T+=8}if(Ae<16)B>>>=ue,T-=ue,_.lens[_.have++]=Ae;else{if(Ae===16){for(O=ue+2;T<O;){if(L===0)break e;L--,B+=F[j++]<<T,T+=8}if(B>>>=ue,T-=ue,_.have===0){C.msg="invalid bit length repeat",_.mode=30;break}v=_.lens[_.have-1],Q=3+(3&B),B>>>=2,T-=2}else if(Ae===17){for(O=ue+3;T<O;){if(L===0)break e;L--,B+=F[j++]<<T,T+=8}T-=ue,v=0,Q=3+(7&(B>>>=ue)),B>>>=3,T-=3}else{for(O=ue+7;T<O;){if(L===0)break e;L--,B+=F[j++]<<T,T+=8}T-=ue,v=0,Q=11+(127&(B>>>=ue)),B>>>=7,T-=7}if(_.have+Q>_.nlen+_.ndist){C.msg="invalid bit length repeat",_.mode=30;break}for(;Q--;)_.lens[_.have++]=v}}if(_.mode===30)break;if(_.lens[256]===0){C.msg="invalid code -- missing end-of-block",_.mode=30;break}if(_.lenbits=9,$={bits:_.lenbits},z=c(l,_.lens,0,_.nlen,_.lencode,0,_.work,$),_.lenbits=$.bits,z){C.msg="invalid literal/lengths set",_.mode=30;break}if(_.distbits=6,_.distcode=_.distdyn,$={bits:_.distbits},z=c(f,_.lens,_.nlen,_.ndist,_.distcode,0,_.work,$),_.distbits=$.bits,z){C.msg="invalid distances set",_.mode=30;break}if(_.mode=20,M===6)break e;case 20:_.mode=21;case 21:if(6<=L&&258<=J){C.next_out=te,C.avail_out=J,C.next_in=j,C.avail_in=L,_.hold=B,_.bits=T,u(C,Y),te=C.next_out,ee=C.output,J=C.avail_out,j=C.next_in,F=C.input,L=C.avail_in,B=_.hold,T=_.bits,_.mode===12&&(_.back=-1);break}for(_.back=0;le=(x=_.lencode[B&(1<<_.lenbits)-1])>>>16&255,Ae=65535&x,!((ue=x>>>24)<=T);){if(L===0)break e;L--,B+=F[j++]<<T,T+=8}if(le&&!(240&le)){for(ke=ue,st=le,et=Ae;le=(x=_.lencode[et+((B&(1<<ke+st)-1)>>ke)])>>>16&255,Ae=65535&x,!(ke+(ue=x>>>24)<=T);){if(L===0)break e;L--,B+=F[j++]<<T,T+=8}B>>>=ke,T-=ke,_.back+=ke}if(B>>>=ue,T-=ue,_.back+=ue,_.length=Ae,le===0){_.mode=26;break}if(32&le){_.back=-1,_.mode=12;break}if(64&le){C.msg="invalid literal/length code",_.mode=30;break}_.extra=15&le,_.mode=22;case 22:if(_.extra){for(O=_.extra;T<O;){if(L===0)break e;L--,B+=F[j++]<<T,T+=8}_.length+=B&(1<<_.extra)-1,B>>>=_.extra,T-=_.extra,_.back+=_.extra}_.was=_.length,_.mode=23;case 23:for(;le=(x=_.distcode[B&(1<<_.distbits)-1])>>>16&255,Ae=65535&x,!((ue=x>>>24)<=T);){if(L===0)break e;L--,B+=F[j++]<<T,T+=8}if(!(240&le)){for(ke=ue,st=le,et=Ae;le=(x=_.distcode[et+((B&(1<<ke+st)-1)>>ke)])>>>16&255,Ae=65535&x,!(ke+(ue=x>>>24)<=T);){if(L===0)break e;L--,B+=F[j++]<<T,T+=8}B>>>=ke,T-=ke,_.back+=ke}if(B>>>=ue,T-=ue,_.back+=ue,64&le){C.msg="invalid distance code",_.mode=30;break}_.offset=Ae,_.extra=15&le,_.mode=24;case 24:if(_.extra){for(O=_.extra;T<O;){if(L===0)break e;L--,B+=F[j++]<<T,T+=8}_.offset+=B&(1<<_.extra)-1,B>>>=_.extra,T-=_.extra,_.back+=_.extra}if(_.offset>_.dmax){C.msg="invalid distance too far back",_.mode=30;break}_.mode=25;case 25:if(J===0)break e;if(Q=Y-J,_.offset>Q){if((Q=_.offset-Q)>_.whave&&_.sane){C.msg="invalid distance too far back",_.mode=30;break}we=Q>_.wnext?(Q-=_.wnext,_.wsize-Q):_.wnext-Q,Q>_.length&&(Q=_.length),$e=_.window}else $e=ee,we=te-_.offset,Q=_.length;for(J<Q&&(Q=J),J-=Q,_.length-=Q;ee[te++]=$e[we++],--Q;);_.length===0&&(_.mode=21);break;case 26:if(J===0)break e;ee[te++]=_.length,J--,_.mode=21;break;case 27:if(_.wrap){for(;T<32;){if(L===0)break e;L--,B|=F[j++]<<T,T+=8}if(Y-=J,C.total_out+=Y,_.total+=Y,Y&&(C.adler=_.check=_.flags?s(_.check,ee,Y,te-Y):a(_.check,ee,Y,te-Y)),Y=J,(_.flags?B:m(B))!==_.check){C.msg="incorrect data check",_.mode=30;break}T=B=0}_.mode=28;case 28:if(_.wrap&&_.flags){for(;T<32;){if(L===0)break e;L--,B+=F[j++]<<T,T+=8}if(B!==(4294967295&_.total)){C.msg="incorrect length check",_.mode=30;break}T=B=0}_.mode=29;case 29:z=1;break e;case 30:z=-3;break e;case 31:return-4;case 32:default:return d}return C.next_out=te,C.avail_out=J,C.next_in=j,C.avail_in=L,_.hold=B,_.bits=T,(_.wsize||Y!==C.avail_out&&_.mode<30&&(_.mode<27||M!==4))&&G(C,C.output,C.next_out,Y-C.avail_out)?(_.mode=31,-4):(ie-=C.avail_in,Y-=C.avail_out,C.total_in+=ie,C.total_out+=Y,_.total+=Y,_.wrap&&Y&&(C.adler=_.check=_.flags?s(_.check,ee,Y,C.next_out-Y):a(_.check,ee,Y,C.next_out-Y)),C.data_type=_.bits+(_.last?64:0)+(_.mode===12?128:0)+(_.mode===20||_.mode===15?256:0),(ie==0&&Y===0||M===4)&&z===h&&(z=-5),z)},i.inflateEnd=function(C){if(!C||!C.state)return d;var M=C.state;return M.window&&(M.window=null),C.state=null,h},i.inflateGetHeader=function(C,M){var _;return C&&C.state&&2&(_=C.state).wrap?((_.head=M).done=!1,h):d},i.inflateSetDictionary=function(C,M){var _,F=M.length;return C&&C.state?(_=C.state).wrap!==0&&_.mode!==11?d:_.mode===11&&a(1,M,F,0)!==_.check?-3:G(C,M,F,F)?(_.mode=31,-4):(_.havedict=1,h):d},i.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(r,n,i){var o=r("../utils/common"),a=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],s=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],u=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],c=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];n.exports=function(l,f,h,d,y,p,b,m){var g,w,S,k,D,E,I,A,N,G=m.bits,C=0,M=0,_=0,F=0,ee=0,j=0,te=0,L=0,J=0,B=0,T=null,ie=0,Y=new o.Buf16(16),Q=new o.Buf16(16),we=null,$e=0;for(C=0;C<=15;C++)Y[C]=0;for(M=0;M<d;M++)Y[f[h+M]]++;for(ee=G,F=15;1<=F&&Y[F]===0;F--);if(F<ee&&(ee=F),F===0)return y[p++]=20971520,y[p++]=20971520,m.bits=1,0;for(_=1;_<F&&Y[_]===0;_++);for(ee<_&&(ee=_),C=L=1;C<=15;C++)if(L<<=1,(L-=Y[C])<0)return-1;if(0<L&&(l===0||F!==1))return-1;for(Q[1]=0,C=1;C<15;C++)Q[C+1]=Q[C]+Y[C];for(M=0;M<d;M++)f[h+M]!==0&&(b[Q[f[h+M]]++]=M);if(E=l===0?(T=we=b,19):l===1?(T=a,ie-=257,we=s,$e-=257,256):(T=u,we=c,-1),C=_,D=p,te=M=B=0,S=-1,k=(J=1<<(j=ee))-1,l===1&&852<J||l===2&&592<J)return 1;for(;;){for(I=C-te,N=b[M]<E?(A=0,b[M]):b[M]>E?(A=we[$e+b[M]],T[ie+b[M]]):(A=96,0),g=1<<C-te,_=w=1<<j;y[D+(B>>te)+(w-=g)]=I<<24|A<<16|N|0,w!==0;);for(g=1<<C-1;B&g;)g>>=1;if(g!==0?(B&=g-1,B+=g):B=0,M++,--Y[C]==0){if(C===F)break;C=f[h+b[M]]}if(ee<C&&(B&k)!==S){for(te===0&&(te=ee),D+=_,L=1<<(j=C-te);j+te<F&&!((L-=Y[j+te])<=0);)j++,L<<=1;if(J+=1<<j,l===1&&852<J||l===2&&592<J)return 1;y[S=B&k]=ee<<24|j<<16|D-p|0}}return B!==0&&(y[D+B]=C-te<<24|64<<16|0),m.bits=ee,0}},{"../utils/common":41}],51:[function(r,n,i){n.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(r,n,i){var o=r("../utils/common"),a=0,s=1;function u(x){for(var P=x.length;0<=--P;)x[P]=0}var c=0,l=29,f=256,h=f+1+l,d=30,y=19,p=2*h+1,b=15,m=16,g=7,w=256,S=16,k=17,D=18,E=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],I=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],A=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],N=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],G=new Array(2*(h+2));u(G);var C=new Array(2*d);u(C);var M=new Array(512);u(M);var _=new Array(256);u(_);var F=new Array(l);u(F);var ee,j,te,L=new Array(d);function J(x,P,U,K,R){this.static_tree=x,this.extra_bits=P,this.extra_base=U,this.elems=K,this.max_length=R,this.has_stree=x&&x.length}function B(x,P){this.dyn_tree=x,this.max_code=0,this.stat_desc=P}function T(x){return x<256?M[x]:M[256+(x>>>7)]}function ie(x,P){x.pending_buf[x.pending++]=255&P,x.pending_buf[x.pending++]=P>>>8&255}function Y(x,P,U){x.bi_valid>m-U?(x.bi_buf|=P<<x.bi_valid&65535,ie(x,x.bi_buf),x.bi_buf=P>>m-x.bi_valid,x.bi_valid+=U-m):(x.bi_buf|=P<<x.bi_valid&65535,x.bi_valid+=U)}function Q(x,P,U){Y(x,U[2*P],U[2*P+1])}function we(x,P){for(var U=0;U|=1&x,x>>>=1,U<<=1,0<--P;);return U>>>1}function $e(x,P,U){var K,R,W=new Array(b+1),Z=0;for(K=1;K<=b;K++)W[K]=Z=Z+U[K-1]<<1;for(R=0;R<=P;R++){var H=x[2*R+1];H!==0&&(x[2*R]=we(W[H]++,H))}}function ue(x){var P;for(P=0;P<h;P++)x.dyn_ltree[2*P]=0;for(P=0;P<d;P++)x.dyn_dtree[2*P]=0;for(P=0;P<y;P++)x.bl_tree[2*P]=0;x.dyn_ltree[2*w]=1,x.opt_len=x.static_len=0,x.last_lit=x.matches=0}function le(x){8<x.bi_valid?ie(x,x.bi_buf):0<x.bi_valid&&(x.pending_buf[x.pending++]=x.bi_buf),x.bi_buf=0,x.bi_valid=0}function Ae(x,P,U,K){var R=2*P,W=2*U;return x[R]<x[W]||x[R]===x[W]&&K[P]<=K[U]}function ke(x,P,U){for(var K=x.heap[U],R=U<<1;R<=x.heap_len&&(R<x.heap_len&&Ae(P,x.heap[R+1],x.heap[R],x.depth)&&R++,!Ae(P,K,x.heap[R],x.depth));)x.heap[U]=x.heap[R],U=R,R<<=1;x.heap[U]=K}function st(x,P,U){var K,R,W,Z,H=0;if(x.last_lit!==0)for(;K=x.pending_buf[x.d_buf+2*H]<<8|x.pending_buf[x.d_buf+2*H+1],R=x.pending_buf[x.l_buf+H],H++,K===0?Q(x,R,P):(Q(x,(W=_[R])+f+1,P),(Z=E[W])!==0&&Y(x,R-=F[W],Z),Q(x,W=T(--K),U),(Z=I[W])!==0&&Y(x,K-=L[W],Z)),H<x.last_lit;);Q(x,w,P)}function et(x,P){var U,K,R,W=P.dyn_tree,Z=P.stat_desc.static_tree,H=P.stat_desc.has_stree,ne=P.stat_desc.elems,de=-1;for(x.heap_len=0,x.heap_max=p,U=0;U<ne;U++)W[2*U]!==0?(x.heap[++x.heap_len]=de=U,x.depth[U]=0):W[2*U+1]=0;for(;x.heap_len<2;)W[2*(R=x.heap[++x.heap_len]=de<2?++de:0)]=1,x.depth[R]=0,x.opt_len--,H&&(x.static_len-=Z[2*R+1]);for(P.max_code=de,U=x.heap_len>>1;1<=U;U--)ke(x,W,U);for(R=ne;U=x.heap[1],x.heap[1]=x.heap[x.heap_len--],ke(x,W,1),K=x.heap[1],x.heap[--x.heap_max]=U,x.heap[--x.heap_max]=K,W[2*R]=W[2*U]+W[2*K],x.depth[R]=(x.depth[U]>=x.depth[K]?x.depth[U]:x.depth[K])+1,W[2*U+1]=W[2*K+1]=R,x.heap[1]=R++,ke(x,W,1),2<=x.heap_len;);x.heap[--x.heap_max]=x.heap[1],function(ce,Ve){var un,ut,cn,xe,Jn,co,mt=Ve.dyn_tree,Hs=Ve.max_code,vh=Ve.stat_desc.static_tree,gh=Ve.stat_desc.has_stree,bh=Ve.stat_desc.extra_bits,Gs=Ve.stat_desc.extra_base,ln=Ve.stat_desc.max_length,ei=0;for(xe=0;xe<=b;xe++)ce.bl_count[xe]=0;for(mt[2*ce.heap[ce.heap_max]+1]=0,un=ce.heap_max+1;un<p;un++)ln<(xe=mt[2*mt[2*(ut=ce.heap[un])+1]+1]+1)&&(xe=ln,ei++),mt[2*ut+1]=xe,Hs<ut||(ce.bl_count[xe]++,Jn=0,Gs<=ut&&(Jn=bh[ut-Gs]),co=mt[2*ut],ce.opt_len+=co*(xe+Jn),gh&&(ce.static_len+=co*(vh[2*ut+1]+Jn)));if(ei!==0){do{for(xe=ln-1;ce.bl_count[xe]===0;)xe--;ce.bl_count[xe]--,ce.bl_count[xe+1]+=2,ce.bl_count[ln]--,ei-=2}while(0<ei);for(xe=ln;xe!==0;xe--)for(ut=ce.bl_count[xe];ut!==0;)Hs<(cn=ce.heap[--un])||(mt[2*cn+1]!==xe&&(ce.opt_len+=(xe-mt[2*cn+1])*mt[2*cn],mt[2*cn+1]=xe),ut--)}}(x,P),$e(W,de,x.bl_count)}function v(x,P,U){var K,R,W=-1,Z=P[1],H=0,ne=7,de=4;for(Z===0&&(ne=138,de=3),P[2*(U+1)+1]=65535,K=0;K<=U;K++)R=Z,Z=P[2*(K+1)+1],++H<ne&&R===Z||(H<de?x.bl_tree[2*R]+=H:R!==0?(R!==W&&x.bl_tree[2*R]++,x.bl_tree[2*S]++):H<=10?x.bl_tree[2*k]++:x.bl_tree[2*D]++,W=R,de=(H=0)===Z?(ne=138,3):R===Z?(ne=6,3):(ne=7,4))}function z(x,P,U){var K,R,W=-1,Z=P[1],H=0,ne=7,de=4;for(Z===0&&(ne=138,de=3),K=0;K<=U;K++)if(R=Z,Z=P[2*(K+1)+1],!(++H<ne&&R===Z)){if(H<de)for(;Q(x,R,x.bl_tree),--H!=0;);else R!==0?(R!==W&&(Q(x,R,x.bl_tree),H--),Q(x,S,x.bl_tree),Y(x,H-3,2)):H<=10?(Q(x,k,x.bl_tree),Y(x,H-3,3)):(Q(x,D,x.bl_tree),Y(x,H-11,7));W=R,de=(H=0)===Z?(ne=138,3):R===Z?(ne=6,3):(ne=7,4)}}u(L);var $=!1;function O(x,P,U,K){Y(x,(c<<1)+(K?1:0),3),function(R,W,Z,H){le(R),H&&(ie(R,Z),ie(R,~Z)),o.arraySet(R.pending_buf,R.window,W,Z,R.pending),R.pending+=Z}(x,P,U,!0)}i._tr_init=function(x){$||(function(){var P,U,K,R,W,Z=new Array(b+1);for(R=K=0;R<l-1;R++)for(F[R]=K,P=0;P<1<<E[R];P++)_[K++]=R;for(_[K-1]=R,R=W=0;R<16;R++)for(L[R]=W,P=0;P<1<<I[R];P++)M[W++]=R;for(W>>=7;R<d;R++)for(L[R]=W<<7,P=0;P<1<<I[R]-7;P++)M[256+W++]=R;for(U=0;U<=b;U++)Z[U]=0;for(P=0;P<=143;)G[2*P+1]=8,P++,Z[8]++;for(;P<=255;)G[2*P+1]=9,P++,Z[9]++;for(;P<=279;)G[2*P+1]=7,P++,Z[7]++;for(;P<=287;)G[2*P+1]=8,P++,Z[8]++;for($e(G,h+1,Z),P=0;P<d;P++)C[2*P+1]=5,C[2*P]=we(P,5);ee=new J(G,E,f+1,h,b),j=new J(C,I,0,d,b),te=new J(new Array(0),A,0,y,g)}(),$=!0),x.l_desc=new B(x.dyn_ltree,ee),x.d_desc=new B(x.dyn_dtree,j),x.bl_desc=new B(x.bl_tree,te),x.bi_buf=0,x.bi_valid=0,ue(x)},i._tr_stored_block=O,i._tr_flush_block=function(x,P,U,K){var R,W,Z=0;0<x.level?(x.strm.data_type===2&&(x.strm.data_type=function(H){var ne,de=4093624447;for(ne=0;ne<=31;ne++,de>>>=1)if(1&de&&H.dyn_ltree[2*ne]!==0)return a;if(H.dyn_ltree[18]!==0||H.dyn_ltree[20]!==0||H.dyn_ltree[26]!==0)return s;for(ne=32;ne<f;ne++)if(H.dyn_ltree[2*ne]!==0)return s;return a}(x)),et(x,x.l_desc),et(x,x.d_desc),Z=function(H){var ne;for(v(H,H.dyn_ltree,H.l_desc.max_code),v(H,H.dyn_dtree,H.d_desc.max_code),et(H,H.bl_desc),ne=y-1;3<=ne&&H.bl_tree[2*N[ne]+1]===0;ne--);return H.opt_len+=3*(ne+1)+5+5+4,ne}(x),R=x.opt_len+3+7>>>3,(W=x.static_len+3+7>>>3)<=R&&(R=W)):R=W=U+5,U+4<=R&&P!==-1?O(x,P,U,K):x.strategy===4||W===R?(Y(x,2+(K?1:0),3),st(x,G,C)):(Y(x,4+(K?1:0),3),function(H,ne,de,ce){var Ve;for(Y(H,ne-257,5),Y(H,de-1,5),Y(H,ce-4,4),Ve=0;Ve<ce;Ve++)Y(H,H.bl_tree[2*N[Ve]+1],3);z(H,H.dyn_ltree,ne-1),z(H,H.dyn_dtree,de-1)}(x,x.l_desc.max_code+1,x.d_desc.max_code+1,Z+1),st(x,x.dyn_ltree,x.dyn_dtree)),ue(x),K&&le(x)},i._tr_tally=function(x,P,U){return x.pending_buf[x.d_buf+2*x.last_lit]=P>>>8&255,x.pending_buf[x.d_buf+2*x.last_lit+1]=255&P,x.pending_buf[x.l_buf+x.last_lit]=255&U,x.last_lit++,P===0?x.dyn_ltree[2*U]++:(x.matches++,P--,x.dyn_ltree[2*(_[U]+f+1)]++,x.dyn_dtree[2*T(P)]++),x.last_lit===x.lit_bufsize-1},i._tr_align=function(x){Y(x,2,3),Q(x,w,G),function(P){P.bi_valid===16?(ie(P,P.bi_buf),P.bi_buf=0,P.bi_valid=0):8<=P.bi_valid&&(P.pending_buf[P.pending++]=255&P.bi_buf,P.bi_buf>>=8,P.bi_valid-=8)}(x)}},{"../utils/common":41}],53:[function(r,n,i){n.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(r,n,i){(function(o){(function(a,s){if(!a.setImmediate){var u,c,l,f,h=1,d={},y=!1,p=a.document,b=Object.getPrototypeOf&&Object.getPrototypeOf(a);b=b&&b.setTimeout?b:a,u={}.toString.call(a.process)==="[object process]"?function(S){process.nextTick(function(){g(S)})}:function(){if(a.postMessage&&!a.importScripts){var S=!0,k=a.onmessage;return a.onmessage=function(){S=!1},a.postMessage("","*"),a.onmessage=k,S}}()?(f="setImmediate$"+Math.random()+"$",a.addEventListener?a.addEventListener("message",w,!1):a.attachEvent("onmessage",w),function(S){a.postMessage(f+S,"*")}):a.MessageChannel?((l=new MessageChannel).port1.onmessage=function(S){g(S.data)},function(S){l.port2.postMessage(S)}):p&&"onreadystatechange"in p.createElement("script")?(c=p.documentElement,function(S){var k=p.createElement("script");k.onreadystatechange=function(){g(S),k.onreadystatechange=null,c.removeChild(k),k=null},c.appendChild(k)}):function(S){setTimeout(g,0,S)},b.setImmediate=function(S){typeof S!="function"&&(S=new Function(""+S));for(var k=new Array(arguments.length-1),D=0;D<k.length;D++)k[D]=arguments[D+1];var E={callback:S,args:k};return d[h]=E,u(h),h++},b.clearImmediate=m}function m(S){delete d[S]}function g(S){if(y)setTimeout(g,0,S);else{var k=d[S];if(k){y=!0;try{(function(D){var E=D.callback,I=D.args;switch(I.length){case 0:E();break;case 1:E(I[0]);break;case 2:E(I[0],I[1]);break;case 3:E(I[0],I[1],I[2]);break;default:E.apply(s,I)}})(k)}finally{m(S),y=!1}}}}function w(S){S.source===a&&typeof S.data=="string"&&S.data.indexOf(f)===0&&g(+S.data.slice(f.length))}})(typeof self>"u"?o===void 0?this:o:self)}).call(this,typeof bt<"u"?bt:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(zh);var Uh={exports:{}};(function(e,t){(function(r,n){n()})(bt,function(){function r(c,l){return typeof l>"u"?l={autoBom:!1}:typeof l!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),l={autoBom:!l}),l.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(c.type)?new Blob(["\uFEFF",c],{type:c.type}):c}function n(c,l,f){var h=new XMLHttpRequest;h.open("GET",c),h.responseType="blob",h.onload=function(){u(h.response,l,f)},h.onerror=function(){console.error("could not download file")},h.send()}function i(c){var l=new XMLHttpRequest;l.open("HEAD",c,!1);try{l.send()}catch{}return 200<=l.status&&299>=l.status}function o(c){try{c.dispatchEvent(new MouseEvent("click"))}catch{var l=document.createEvent("MouseEvents");l.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),c.dispatchEvent(l)}}var a=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof bt=="object"&&bt.global===bt?bt:void 0,s=a.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),u=a.saveAs||(typeof window!="object"||window!==a?function(){}:"download"in HTMLAnchorElement.prototype&&!s?function(c,l,f){var h=a.URL||a.webkitURL,d=document.createElement("a");l=l||c.name||"download",d.download=l,d.rel="noopener",typeof c=="string"?(d.href=c,d.origin===location.origin?o(d):i(d.href)?n(c,l,f):o(d,d.target="_blank")):(d.href=h.createObjectURL(c),setTimeout(function(){h.revokeObjectURL(d.href)},4e4),setTimeout(function(){o(d)},0))}:"msSaveOrOpenBlob"in navigator?function(c,l,f){if(l=l||c.name||"download",typeof c!="string")navigator.msSaveOrOpenBlob(r(c,f),l);else if(i(c))n(c,l,f);else{var h=document.createElement("a");h.href=c,h.target="_blank",setTimeout(function(){o(h)})}}:function(c,l,f,h){if(h=h||open("","_blank"),h&&(h.document.title=h.document.body.innerText="downloading..."),typeof c=="string")return n(c,l,f);var d=c.type==="application/octet-stream",y=/constructor/i.test(a.HTMLElement)||a.safari,p=/CriOS\/[\d]+/.test(navigator.userAgent);if((p||d&&y||s)&&typeof FileReader<"u"){var b=new FileReader;b.onloadend=function(){var w=b.result;w=p?w:w.replace(/^data:[^;]*;/,"data:attachment/file;"),h?h.location.href=w:location=w,h=null},b.readAsDataURL(c)}else{var m=a.URL||a.webkitURL,g=m.createObjectURL(c);h?h.location=g:location.href=g,h=null,setTimeout(function(){m.revokeObjectURL(g)},4e4)}});a.saveAs=u.saveAs=u,e.exports=u})})(Uh);const xr=[];function Kh(e,t){return{subscribe:tn(e,t).subscribe}}function tn(e,t=fe){let r;const n=new Set;function i(s){if(Zt(e,s)&&(e=s,r)){const u=!xr.length;for(const c of n)c[1](),xr.push(c,e);if(u){for(let c=0;c<xr.length;c+=2)xr[c][0](xr[c+1]);xr.length=0}}}function o(s){i(s(e))}function a(s,u=fe){const c=[s,u];return n.add(c),n.size===1&&(r=t(i,o)||fe),s(e),()=>{n.delete(c),n.size===0&&r&&(r(),r=null)}}return{set:i,update:o,subscribe:a}}function qr(e){"@babel/helpers - typeof";return qr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qr(e)}function qh(e,t){if(qr(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(qr(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Wh(e){var t=qh(e,"string");return qr(t)==="symbol"?t:String(t)}function Js(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Wh(n.key),n)}}function rn(e,t,r){return t&&Js(e.prototype,t),r&&Js(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Hh(e){return e[e.length-1]}function Xa(e){return Array.isArray(e)?e.slice(0):[e]}function Br(e){return Array.isArray(e)}function Gh(e){return e!=null}function ho(e,t){var r=0,n=-1;for(var i of e){n=n+1;var o=t(i,n);if(o)r=r+1;else break}return r}function Zi(e,t){for(var r=t.length,n=0;n<r;++n){var i=t[n];e.push(i)}}function Qo(e){var t=e.split("-");if(t.length!==2)throw new Error("malformatted revision: "+e);return{height:parseInt(t[0],10),hash:t[1]}}function Qh(e){var t=parseInt(e.split("-")[0],10);return t}function Vo(e,t){var r=t?t._rev:null,n=r?Qo(r).height:0,i=n+1;return i+"-"+e}var Ja=1;function Xi(){return{lwt:Ja}}function Ji(){return""}function Vh(e){return Object.assign({},e,{_meta:void 0,_deleted:void 0,_rev:void 0})}function Yh(e,t,r){if(t.length!==r.length)return!1;for(var n=0,i=t.length;n<i;){var o=t[n],a=r[n];if(n++,o._rev!==a._rev||o[e]!==a[e])return!1}return!0}function Zh(e){return(t,r)=>t._meta.lwt===r._meta.lwt?r[e]<t[e]?1:-1:t._meta.lwt-r._meta.lwt}function Xh(e,t){return t.sort(Zh(e))}class Wr{constructor(t,r){t=this.words=t||[],this.sigBytes=r!==void 0?r:t.length*4}toString(t){return(t||Jh).stringify(this)}concat(t){if(this.clamp(),this.sigBytes%4)for(let r=0;r<t.sigBytes;r++){const n=t.words[r>>>2]>>>24-r%4*8&255;this.words[this.sigBytes+r>>>2]|=n<<24-(this.sigBytes+r)%4*8}else for(let r=0;r<t.sigBytes;r+=4)this.words[this.sigBytes+r>>>2]=t.words[r>>>2];return this.sigBytes+=t.sigBytes,this}clamp(){this.words[this.sigBytes>>>2]&=4294967295<<32-this.sigBytes%4*8,this.words.length=Math.ceil(this.sigBytes/4)}clone(){return new Wr([...this.words])}}const Jh={stringify(e){const t=[];for(let r=0;r<e.sigBytes;r++){const n=e.words[r>>>2]>>>24-r%4*8&255;t.push((n>>>4).toString(16),(n&15).toString(16))}return t.join("")}},ed={parse(e){const t=e.length,r=[];for(let n=0;n<t;n++)r[n>>>2]|=(e.charCodeAt(n)&255)<<24-n%4*8;return new Wr(r,t)}},td={parse(e){return ed.parse(unescape(encodeURIComponent(e)))}};class rd{constructor(){this._minBufferSize=0,this.blockSize=512/32,this.reset()}reset(){this._data=new Wr,this._nDataBytes=0}_append(t){typeof t=="string"&&(t=td.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes}_doProcessBlock(t,r){}_process(t){let r,n=this._data.sigBytes/(this.blockSize*4);t?n=Math.ceil(n):n=Math.max((n|0)-this._minBufferSize,0);const i=n*this.blockSize,o=Math.min(i*4,this._data.sigBytes);if(i){for(let a=0;a<i;a+=this.blockSize)this._doProcessBlock(this._data.words,a);r=this._data.words.splice(0,i),this._data.sigBytes-=o}return new Wr(r,o)}}class nd extends rd{update(t){return this._append(t),this._process(),this}finalize(t){t&&this._append(t)}}const id=[1779033703,-1150833019,1013904242,-1521486534,1359893119,-1694144372,528734635,1541459225],od=[1116352408,1899447441,-1245643825,-373957723,961987163,1508970993,-1841331548,-1424204075,-670586216,310598401,607225278,1426881987,1925078388,-2132889090,-1680079193,-1046744716,-459576895,-272742522,264347078,604807628,770255983,1249150122,1555081692,1996064986,-1740746414,-1473132947,-1341970488,-1084653625,-958395405,-710438585,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,-2117940946,-1838011259,-1564481375,-1474664885,-1035236496,-949202525,-778901479,-694614492,-200395387,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,-2067236844,-1933114872,-1866530822,-1538233109,-1090935817,-965641998],Jt=[];class ad extends nd{constructor(){super(),this.reset()}reset(){super.reset(),this._hash=new Wr([...id])}_doProcessBlock(t,r){const n=this._hash.words;let i=n[0],o=n[1],a=n[2],s=n[3],u=n[4],c=n[5],l=n[6],f=n[7];for(let h=0;h<64;h++){if(h<16)Jt[h]=t[r+h]|0;else{const w=Jt[h-15],S=(w<<25|w>>>7)^(w<<14|w>>>18)^w>>>3,k=Jt[h-2],D=(k<<15|k>>>17)^(k<<13|k>>>19)^k>>>10;Jt[h]=S+Jt[h-7]+D+Jt[h-16]}const d=u&c^~u&l,y=i&o^i&a^o&a,p=(i<<30|i>>>2)^(i<<19|i>>>13)^(i<<10|i>>>22),b=(u<<26|u>>>6)^(u<<21|u>>>11)^(u<<7|u>>>25),m=f+b+d+od[h]+Jt[h],g=p+y;f=l,l=c,c=u,u=s+m|0,s=a,a=o,o=i,i=m+g|0}n[0]=n[0]+i|0,n[1]=n[1]+o|0,n[2]=n[2]+a|0,n[3]=n[3]+s|0,n[4]=n[4]+u|0,n[5]=n[5]+c|0,n[6]=n[6]+l|0,n[7]=n[7]+f|0}finalize(t){super.finalize(t);const r=this._nDataBytes*8,n=this._data.sigBytes*8;return this._data.words[n>>>5]|=128<<24-n%32,this._data.words[(n+64>>>9<<4)+14]=Math.floor(r/4294967296),this._data.words[(n+64>>>9<<4)+15]=r,this._data.sigBytes=this._data.words.length*4,this._process(),this._hash}}function sd(e){return new ad().finalize(e).toString()}function gn(e){return sd(e)}function ud(){return new Promise(e=>setTimeout(e,0))}function cd(e=0){return new Promise(t=>setTimeout(t,e))}Promise.resolve(!0);var Ft=Promise.resolve(!1),ld=Promise.resolve(null),lt=Promise.resolve(),po=lt;function fd(e=void 0){return po=po.then(()=>typeof requestIdleCallback=="function"?new Promise(t=>{requestIdleCallback(()=>t(),{timeout:e})}):cd(0)),po}function hd(e,t){return e.reduce((r,n)=>r.then(n),Promise.resolve(t))}function eo(e=10){for(var t="",r="abcdefghijklmnopqrstuvwxyz",n=0;n<e;n++)t+=r.charAt(Math.floor(Math.random()*r.length));return t}function Rc(e){e+="";var t=e.charAt(0).toUpperCase();return t+e.substr(1)}function Cn(e){for(;e.charAt(0)===".";)e=e.substr(1);for(;e.slice(-1)===".";)e=e.slice(0,-1);return e}function Tc(e){return!!(e.includes("/")||e.includes("\\"))}function Dn(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;var r,n;if(Array.isArray(e)){if(r=e.length,r!==t.length)return!1;for(n=r;n--!==0;)if(!Dn(e[n],t[n]))return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();var i=Object.keys(e);if(r=i.length,r!==Object.keys(t).length)return!1;for(n=r;n--!==0;)if(!Object.prototype.hasOwnProperty.call(t,i[n]))return!1;for(n=r;n--!==0;){var o=i[n];if(!Dn(e[o],t[o]))return!1}return!0}return e!==e&&t!==t}var dd=e=>{var t=typeof e;return e!==null&&(t==="object"||t==="function")},mo=new Set(["__proto__","prototype","constructor"]),pd=new Set("0123456789");function md(e){var t=[],r="",n="start",i=!1;for(var o of e)switch(o){case"\\":{if(n==="index")throw new Error("Invalid character in an index");if(n==="indexEnd")throw new Error("Invalid character after an index");i&&(r+=o),n="property",i=!i;break}case".":{if(n==="index")throw new Error("Invalid character in an index");if(n==="indexEnd"){n="property";break}if(i){i=!1,r+=o;break}if(mo.has(r))return[];t.push(r),r="",n="property";break}case"[":{if(n==="index")throw new Error("Invalid character in an index");if(n==="indexEnd"){n="index";break}if(i){i=!1,r+=o;break}if(n==="property"){if(mo.has(r))return[];t.push(r),r=""}n="index";break}case"]":{if(n==="index"){t.push(Number.parseInt(r,10)),r="",n="indexEnd";break}if(n==="indexEnd")throw new Error("Invalid character after an index")}default:{if(n==="index"&&!pd.has(o))throw new Error("Invalid character in an index");if(n==="indexEnd")throw new Error("Invalid character after an index");n==="start"&&(n="property"),i&&(i=!1,r+="\\"),r+=o}}switch(i&&(r+="\\"),n){case"property":{if(mo.has(r))return[];t.push(r);break}case"index":throw new Error("Index was not closed");case"start":{t.push("");break}}return t}function yd(e,t){if(typeof t!="number"&&Array.isArray(e)){var r=Number.parseInt(t,10);return Number.isInteger(r)&&e[r]===e[t]}return!1}function jt(e,t,r){if(Array.isArray(t)&&(t=t.join(".")),!dd(e)||typeof t!="string")return r===void 0?e:r;var n=md(t);if(n.length===0)return r;for(var i=0;i<n.length;i++){var o=n[i];if(yd(e,o)?e=i===n.length-1?void 0:null:e=e[o],e==null){if(i!==n.length-1)return r;break}}return e===void 0?r:e}function Mc(e){return Object.freeze(e),Object.getOwnPropertyNames(e).forEach(function(t){e.hasOwnProperty(t)&&e[t]!==null&&(typeof e[t]=="object"||typeof e[t]=="function")&&!Object.isFrozen(e[t])&&Mc(e[t])}),e}function vd(e){var t=e.split("."),r=t.length;return r===1?n=>n[e]:n=>{for(var i=n,o=0;o<r;++o){var a=t[o];if(i=i[a],typeof i>"u")return i}return i}}function eu(e,t){var r=e[t];if(!r)throw new Error("missing value from object "+t);return r}function Yo(e){var t={};for(var r in e)if(e.hasOwnProperty(r))if(typeof e[r]=="object"){var n=Yo(e[r]);for(var i in n)n.hasOwnProperty(i)&&(t[r+"."+i]=n[i])}else t[r]=e[r];return t}function Re(e){return Object.assign({},e)}function gd(e){return Object.keys(e)[0]}function Ri(e,t=!1){if(!e)return e;if(!t&&Array.isArray(e))return e.sort((n,i)=>typeof n=="string"&&typeof i=="string"?n.localeCompare(i):typeof n=="object"?1:-1).map(n=>Ri(n,t));if(typeof e=="object"&&!Array.isArray(e)){if(e instanceof RegExp)return e;var r={};return Object.keys(e).sort((n,i)=>n.localeCompare(i)).forEach(n=>{r[n]=Ri(e[n],t)}),r}return e}function Zo(e){if(!e||e===null||typeof e!="object")return e;if(Array.isArray(e)){for(var t=new Array(e.length),r=t.length;r--;)t[r]=Zo(e[r]);return t}var n={};for(var i in e)n[i]=Zo(e[i]);return n}var $r=Zo;function di(e,t,r){return Object.defineProperty(e,t,{get:function(){return r}}),r}function bd(e,t){return t instanceof RegExp?t.toString():t}function An(e,t){var r=e.get(t);if(typeof r>"u")throw new Error("missing value from map "+t);return r}function hr(e,t,r,n){var i=e.get(t);return typeof i>"u"?(i=r(),e.set(t,i)):n&&n(i),i}function ve(e){var t=e.split("-"),r="RxDB";return t.forEach(n=>{r+=Rc(n)}),r+="Plugin",new Error(`You are using a function which must be overwritten by a plugin.
        You should either prevent the usage of this function or add the plugin via:
            import { `+r+" } from 'rxdb/plugins/"+e+`';
            addRxPlugin(`+r+`);
        `)}var yo=0;function ze(){var e=new Date().getTime();e=e+.01,e<=yo&&(e=yo+.01);var t=parseFloat(e.toFixed(2));return yo=t,t}function _e(e){if(!e)throw new Error("ensureNotFalsy() is falsy");return e}var Bc={bufferSize:1,refCount:!0},_d=/\./g,wd=/(\/?)(.+)\1([a-z]*)/i;function kd(e){var t=_e(e.toString().match(wd));return{pattern:t[2],flags:t[3]}}function Pn(e,t){return Pn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Pn(e,t)}function $c(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,Pn(e,t)}function Xo(e){return Xo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Xo(e)}function xd(e){return Function.toString.call(e).indexOf("[native code]")!==-1}function Ed(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function pi(e,t,r){return Ed()?pi=Reflect.construct.bind():pi=function(i,o,a){var s=[null];s.push.apply(s,o);var u=Function.bind.apply(i,s),c=new u;return a&&Pn(c,a.prototype),c},pi.apply(null,arguments)}function Ti(e){var t=typeof Map=="function"?new Map:void 0;return Ti=function(n){if(n===null||!xd(n))return n;if(typeof n!="function")throw new TypeError("Super expression must either be null or a function");if(typeof t<"u"){if(t.has(n))return t.get(n);t.set(n,i)}function i(){return pi(n,arguments,Xo(this).constructor)}return i.prototype=Object.create(n.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),Pn(i,n)},Ti(e)}var Oe={isDevMode(){return!1},deepFreezeWhenDevMode(e){return e},tunnelErrorMessage(e){return"RxDB Error-Code "+e+`.
        Error messages are not included in RxDB core to reduce build size.
        - To find out what this error means, either use the dev-mode-plugin https://rxdb.info/dev-mode.html
        - or search for the error code here: https://github.com/pubkey/rxdb/search?q=`+e+`
        `}};function Sd(e){var t="";return Object.keys(e).length===0||(t+=`Given parameters: {
`,t+=Object.keys(e).map(r=>{var n="[object Object]";try{r==="errors"?n=e[r].map(i=>JSON.stringify(i,Object.getOwnPropertyNames(i))):n=JSON.stringify(e[r],function(i,o){return o===void 0?null:o},2)}catch{}return r+":"+n}).join(`
`),t+="}"),t}function Nc(e,t,r){return"RxError ("+t+`):
`+e+`
`+Sd(r)}var Od=function(e){$c(t,e);function t(n,i,o={}){var a,s=Nc(i,n,o);return a=e.call(this,s)||this,a.code=n,a.message=s,a.parameters=o,a.rxdb=!0,a}var r=t.prototype;return r.toString=function(){return this.message},rn(t,[{key:"name",get:function(){return"RxError ("+this.code+")"}},{key:"typeError",get:function(){return!1}}]),t}(Ti(Error)),Cd=function(e){$c(t,e);function t(n,i,o={}){var a,s=Nc(i,n,o);return a=e.call(this,s)||this,a.code=n,a.message=s,a.parameters=o,a.rxdb=!0,a}var r=t.prototype;return r.toString=function(){return this.message},rn(t,[{key:"name",get:function(){return"RxTypeError ("+this.code+")"}},{key:"typeError",get:function(){return!0}}]),t}(Ti(TypeError));function q(e,t){return new Od(e,Oe.tunnelErrorMessage(e),t)}function Ze(e,t){return new Cd(e,Oe.tunnelErrorMessage(e),t)}function Dd(e){return e&&e.status===409?e:!1}var Ad={409:"document write conflict",422:"schema validation error",510:"attachment data missing"};function Pd(e){return q("COL20",{name:Ad[e.status],document:e.documentId,writeError:e})}var In={preAddRxPlugin:[],preCreateRxDatabase:[],createRxDatabase:[],preCreateRxCollection:[],createRxCollection:[],postDestroyRxCollection:[],postRemoveRxCollection:[],preCreateRxSchema:[],createRxSchema:[],preCreateRxQuery:[],prePrepareQuery:[],createRxDocument:[],postCreateRxDocument:[],preCreateRxStorageInstance:[],preMigrateDocument:[],postMigrateDocument:[],preDestroyRxDatabase:[],postRemoveRxDatabase:[],preReplicationMasterWrite:[],preReplicationMasterWriteDocumentsHandle:[]};function it(e,t){In[e]&&In[e].forEach(r=>r(t))}function Un(e,t){return Promise.all(In[e].map(r=>r(t)))}function Ce(e){return typeof e=="function"}function Id(e){return Ce(e==null?void 0:e.lift)}function Rt(e){return function(t){if(Id(t))return t.lift(function(r){try{return e(r,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}var Jo=function(e,t){return Jo=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])},Jo(e,t)};function _r(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Jo(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}function Rd(e,t,r,n){function i(o){return o instanceof r?o:new r(function(a){a(o)})}return new(r||(r=Promise))(function(o,a){function s(l){try{c(n.next(l))}catch(f){a(f)}}function u(l){try{c(n.throw(l))}catch(f){a(f)}}function c(l){l.done?o(l.value):i(l.value).then(s,u)}c((n=n.apply(e,t||[])).next())})}function Fc(e,t){var r={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,i,o,a;return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(c){return function(l){return u([c,l])}}function u(c){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(r=0)),r;)try{if(n=1,i&&(o=c[0]&2?i.return:c[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,c[1])).done)return o;switch(i=0,o&&(c=[c[0]&2,o.value]),c[0]){case 0:case 1:o=c;break;case 4:return r.label++,{value:c[1],done:!1};case 5:r.label++,i=c[1],c=[0];continue;case 7:c=r.ops.pop(),r.trys.pop();continue;default:if(o=r.trys,!(o=o.length>0&&o[o.length-1])&&(c[0]===6||c[0]===2)){r=0;continue}if(c[0]===3&&(!o||c[1]>o[0]&&c[1]<o[3])){r.label=c[1];break}if(c[0]===6&&r.label<o[1]){r.label=o[1],o=c;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(c);break}o[2]&&r.ops.pop(),r.trys.pop();continue}c=t.call(e,r)}catch(l){c=[6,l],i=0}finally{n=o=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}function Hr(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function dr(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),i,o=[],a;try{for(;(t===void 0||t-- >0)&&!(i=n.next()).done;)o.push(i.value)}catch(s){a={error:s}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return o}function pr(e,t,r){if(r||arguments.length===2)for(var n=0,i=t.length,o;n<i;n++)(o||!(n in t))&&(o||(o=Array.prototype.slice.call(t,0,n)),o[n]=t[n]);return e.concat(o||Array.prototype.slice.call(t))}function Nr(e){return this instanceof Nr?(this.v=e,this):new Nr(e)}function Td(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(e,t||[]),i,o=[];return i={},a("next"),a("throw"),a("return"),i[Symbol.asyncIterator]=function(){return this},i;function a(h){n[h]&&(i[h]=function(d){return new Promise(function(y,p){o.push([h,d,y,p])>1||s(h,d)})})}function s(h,d){try{u(n[h](d))}catch(y){f(o[0][3],y)}}function u(h){h.value instanceof Nr?Promise.resolve(h.value.v).then(c,l):f(o[0][2],h)}function c(h){s("next",h)}function l(h){s("throw",h)}function f(h,d){h(d),o.shift(),o.length&&s(o[0][0],o[0][1])}}function Md(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof Hr=="function"?Hr(e):e[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(o){r[o]=e[o]&&function(a){return new Promise(function(s,u){a=e[o](a),i(s,u,a.done,a.value)})}}function i(o,a,s,u){Promise.resolve(u).then(function(c){o({value:c,done:s})},a)}}var jc=function(e){return e&&typeof e.length=="number"&&typeof e!="function"};function Lc(e){return Ce(e==null?void 0:e.then)}function es(e){var t=function(n){Error.call(n),n.stack=new Error().stack},r=e(t);return r.prototype=Object.create(Error.prototype),r.prototype.constructor=r,r}var vo=es(function(e){return function(r){e(this),this.message=r?r.length+` errors occurred during unsubscription:
`+r.map(function(n,i){return i+1+") "+n.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=r}});function ea(e,t){if(e){var r=e.indexOf(t);0<=r&&e.splice(r,1)}}var to=function(){function e(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}return e.prototype.unsubscribe=function(){var t,r,n,i,o;if(!this.closed){this.closed=!0;var a=this._parentage;if(a)if(this._parentage=null,Array.isArray(a))try{for(var s=Hr(a),u=s.next();!u.done;u=s.next()){var c=u.value;c.remove(this)}}catch(p){t={error:p}}finally{try{u&&!u.done&&(r=s.return)&&r.call(s)}finally{if(t)throw t.error}}else a.remove(this);var l=this.initialTeardown;if(Ce(l))try{l()}catch(p){o=p instanceof vo?p.errors:[p]}var f=this._finalizers;if(f){this._finalizers=null;try{for(var h=Hr(f),d=h.next();!d.done;d=h.next()){var y=d.value;try{tu(y)}catch(p){o=o??[],p instanceof vo?o=pr(pr([],dr(o)),dr(p.errors)):o.push(p)}}}catch(p){n={error:p}}finally{try{d&&!d.done&&(i=h.return)&&i.call(h)}finally{if(n)throw n.error}}}if(o)throw new vo(o)}},e.prototype.add=function(t){var r;if(t&&t!==this)if(this.closed)tu(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=(r=this._finalizers)!==null&&r!==void 0?r:[]).push(t)}},e.prototype._hasParent=function(t){var r=this._parentage;return r===t||Array.isArray(r)&&r.includes(t)},e.prototype._addParent=function(t){var r=this._parentage;this._parentage=Array.isArray(r)?(r.push(t),r):r?[r,t]:t},e.prototype._removeParent=function(t){var r=this._parentage;r===t?this._parentage=null:Array.isArray(r)&&ea(r,t)},e.prototype.remove=function(t){var r=this._finalizers;r&&ea(r,t),t instanceof e&&t._removeParent(this)},e.EMPTY=function(){var t=new e;return t.closed=!0,t}(),e}(),zc=to.EMPTY;function Uc(e){return e instanceof to||e&&"closed"in e&&Ce(e.remove)&&Ce(e.add)&&Ce(e.unsubscribe)}function tu(e){Ce(e)?e():e.unsubscribe()}var Kc={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},ta={setTimeout:function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var i=ta.delegate;return i!=null&&i.setTimeout?i.setTimeout.apply(i,pr([e,t],dr(r))):setTimeout.apply(void 0,pr([e,t],dr(r)))},clearTimeout:function(e){var t=ta.delegate;return((t==null?void 0:t.clearTimeout)||clearTimeout)(e)},delegate:void 0};function qc(e){ta.setTimeout(function(){throw e})}function ru(){}function mi(e){e()}var ts=function(e){_r(t,e);function t(r){var n=e.call(this)||this;return n.isStopped=!1,r?(n.destination=r,Uc(r)&&r.add(n)):n.destination=Fd,n}return t.create=function(r,n,i){return new Gr(r,n,i)},t.prototype.next=function(r){this.isStopped||this._next(r)},t.prototype.error=function(r){this.isStopped||(this.isStopped=!0,this._error(r))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(r){this.destination.next(r)},t.prototype._error=function(r){try{this.destination.error(r)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(to),Bd=Function.prototype.bind;function go(e,t){return Bd.call(e,t)}var $d=function(){function e(t){this.partialObserver=t}return e.prototype.next=function(t){var r=this.partialObserver;if(r.next)try{r.next(t)}catch(n){ni(n)}},e.prototype.error=function(t){var r=this.partialObserver;if(r.error)try{r.error(t)}catch(n){ni(n)}else ni(t)},e.prototype.complete=function(){var t=this.partialObserver;if(t.complete)try{t.complete()}catch(r){ni(r)}},e}(),Gr=function(e){_r(t,e);function t(r,n,i){var o=e.call(this)||this,a;if(Ce(r)||!r)a={next:r??void 0,error:n??void 0,complete:i??void 0};else{var s;o&&Kc.useDeprecatedNextContext?(s=Object.create(r),s.unsubscribe=function(){return o.unsubscribe()},a={next:r.next&&go(r.next,s),error:r.error&&go(r.error,s),complete:r.complete&&go(r.complete,s)}):a=r}return o.destination=new $d(a),o}return t}(ts);function ni(e){qc(e)}function Nd(e){throw e}var Fd={closed:!0,next:ru,error:Nd,complete:ru},rs=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function ns(e){return e}function jd(e){return e.length===0?ns:e.length===1?e[0]:function(r){return e.reduce(function(n,i){return i(n)},r)}}var Xe=function(){function e(t){t&&(this._subscribe=t)}return e.prototype.lift=function(t){var r=new e;return r.source=this,r.operator=t,r},e.prototype.subscribe=function(t,r,n){var i=this,o=zd(t)?t:new Gr(t,r,n);return mi(function(){var a=i,s=a.operator,u=a.source;o.add(s?s.call(o,u):u?i._subscribe(o):i._trySubscribe(o))}),o},e.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(r){t.error(r)}},e.prototype.forEach=function(t,r){var n=this;return r=nu(r),new r(function(i,o){var a=new Gr({next:function(s){try{t(s)}catch(u){o(u),a.unsubscribe()}},error:o,complete:i});n.subscribe(a)})},e.prototype._subscribe=function(t){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(t)},e.prototype[rs]=function(){return this},e.prototype.pipe=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return jd(t)(this)},e.prototype.toPromise=function(t){var r=this;return t=nu(t),new t(function(n,i){var o;r.subscribe(function(a){return o=a},function(a){return i(a)},function(){return n(o)})})},e.create=function(t){return new e(t)},e}();function nu(e){var t;return(t=e??Kc.Promise)!==null&&t!==void 0?t:Promise}function Ld(e){return e&&Ce(e.next)&&Ce(e.error)&&Ce(e.complete)}function zd(e){return e&&e instanceof ts||Ld(e)&&Uc(e)}function Wc(e){return Ce(e[rs])}function Hc(e){return Symbol.asyncIterator&&Ce(e==null?void 0:e[Symbol.asyncIterator])}function Gc(e){return new TypeError("You provided "+(e!==null&&typeof e=="object"?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function Ud(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Qc=Ud();function Vc(e){return Ce(e==null?void 0:e[Qc])}function Yc(e){return Td(this,arguments,function(){var r,n,i,o;return Fc(this,function(a){switch(a.label){case 0:r=e.getReader(),a.label=1;case 1:a.trys.push([1,,9,10]),a.label=2;case 2:return[4,Nr(r.read())];case 3:return n=a.sent(),i=n.value,o=n.done,o?[4,Nr(void 0)]:[3,5];case 4:return[2,a.sent()];case 5:return[4,Nr(i)];case 6:return[4,a.sent()];case 7:return a.sent(),[3,2];case 8:return[3,10];case 9:return r.releaseLock(),[7];case 10:return[2]}})})}function Zc(e){return Ce(e==null?void 0:e.getReader)}function Xt(e){if(e instanceof Xe)return e;if(e!=null){if(Wc(e))return Kd(e);if(jc(e))return qd(e);if(Lc(e))return Wd(e);if(Hc(e))return Xc(e);if(Vc(e))return Hd(e);if(Zc(e))return Gd(e)}throw Gc(e)}function Kd(e){return new Xe(function(t){var r=e[rs]();if(Ce(r.subscribe))return r.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function qd(e){return new Xe(function(t){for(var r=0;r<e.length&&!t.closed;r++)t.next(e[r]);t.complete()})}function Wd(e){return new Xe(function(t){e.then(function(r){t.closed||(t.next(r),t.complete())},function(r){return t.error(r)}).then(null,qc)})}function Hd(e){return new Xe(function(t){var r,n;try{for(var i=Hr(e),o=i.next();!o.done;o=i.next()){var a=o.value;if(t.next(a),t.closed)return}}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}t.complete()})}function Xc(e){return new Xe(function(t){Qd(e,t).catch(function(r){return t.error(r)})})}function Gd(e){return Xc(Yc(e))}function Qd(e,t){var r,n,i,o;return Rd(this,void 0,void 0,function(){var a,s;return Fc(this,function(u){switch(u.label){case 0:u.trys.push([0,5,6,11]),r=Md(e),u.label=1;case 1:return[4,r.next()];case 2:if(n=u.sent(),!!n.done)return[3,4];if(a=n.value,t.next(a),t.closed)return[2];u.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return s=u.sent(),i={error:s},[3,11];case 6:return u.trys.push([6,,9,10]),n&&!n.done&&(o=r.return)?[4,o.call(r)]:[3,8];case 7:u.sent(),u.label=8;case 8:return[3,10];case 9:if(i)throw i.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}})})}function Qr(e,t,r,n,i){return new Vd(e,t,r,n,i)}var Vd=function(e){_r(t,e);function t(r,n,i,o,a,s){var u=e.call(this,r)||this;return u.onFinalize=a,u.shouldUnsubscribe=s,u._next=n?function(c){try{n(c)}catch(l){r.error(l)}}:e.prototype._next,u._error=o?function(c){try{o(c)}catch(l){r.error(l)}finally{this.unsubscribe()}}:e.prototype._error,u._complete=i?function(){try{i()}catch(c){r.error(c)}finally{this.unsubscribe()}}:e.prototype._complete,u}return t.prototype.unsubscribe=function(){var r;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;e.prototype.unsubscribe.call(this),!n&&((r=this.onFinalize)===null||r===void 0||r.call(this))}},t}(ts),Jc={now:function(){return(Jc.delegate||Date).now()},delegate:void 0};function Yd(e){return e&&Ce(e.schedule)}function el(e){return e[e.length-1]}function ro(e){return Yd(el(e))?e.pop():void 0}function tl(e,t){return typeof el(e)=="number"?e.pop():t}function qt(e,t,r,n,i){n===void 0&&(n=0),i===void 0&&(i=!1);var o=t.schedule(function(){r(),i?e.add(this.schedule(null,n)):this.unsubscribe()},n);if(e.add(o),!i)return o}function rl(e,t){return t===void 0&&(t=0),Rt(function(r,n){r.subscribe(Qr(n,function(i){return qt(n,e,function(){return n.next(i)},t)},function(){return qt(n,e,function(){return n.complete()},t)},function(i){return qt(n,e,function(){return n.error(i)},t)}))})}function nl(e,t){return t===void 0&&(t=0),Rt(function(r,n){n.add(e.schedule(function(){return r.subscribe(n)},t))})}function Zd(e,t){return Xt(e).pipe(nl(t),rl(t))}function Xd(e,t){return Xt(e).pipe(nl(t),rl(t))}function Jd(e,t){return new Xe(function(r){var n=0;return t.schedule(function(){n===e.length?r.complete():(r.next(e[n++]),r.closed||this.schedule())})})}function ep(e,t){return new Xe(function(r){var n;return qt(r,t,function(){n=e[Qc](),qt(r,t,function(){var i,o,a;try{i=n.next(),o=i.value,a=i.done}catch(s){r.error(s);return}a?r.complete():r.next(o)},0,!0)}),function(){return Ce(n==null?void 0:n.return)&&n.return()}})}function il(e,t){if(!e)throw new Error("Iterable cannot be null");return new Xe(function(r){qt(r,t,function(){var n=e[Symbol.asyncIterator]();qt(r,t,function(){n.next().then(function(i){i.done?r.complete():r.next(i.value)})},0,!0)})})}function tp(e,t){return il(Yc(e),t)}function rp(e,t){if(e!=null){if(Wc(e))return Zd(e,t);if(jc(e))return Jd(e,t);if(Lc(e))return Xd(e,t);if(Hc(e))return il(e,t);if(Vc(e))return ep(e,t);if(Zc(e))return tp(e,t)}throw Gc(e)}function is(e,t){return t?rp(e,t):Xt(e)}function Lt(e,t){return Rt(function(r,n){var i=0;r.subscribe(Qr(n,function(o){n.next(e.call(t,o,i++))}))})}function np(e,t,r,n,i,o,a,s){var u=[],c=0,l=0,f=!1,h=function(){f&&!u.length&&!c&&t.complete()},d=function(p){return c<n?y(p):u.push(p)},y=function(p){o&&t.next(p),c++;var b=!1;Xt(r(p,l++)).subscribe(Qr(t,function(m){i==null||i(m),o?d(m):t.next(m)},function(){b=!0},void 0,function(){if(b)try{c--;for(var m=function(){var g=u.shift();a?qt(t,a,function(){return y(g)}):y(g)};u.length&&c<n;)m();h()}catch(g){t.error(g)}}))};return e.subscribe(Qr(t,d,function(){f=!0,h()})),function(){s==null||s()}}function Kn(e,t,r){return r===void 0&&(r=1/0),Ce(t)?Kn(function(n,i){return Lt(function(o,a){return t(n,o,i,a)})(Xt(e(n,i)))},r):(typeof t=="number"&&(r=t),Rt(function(n,i){return np(n,i,e,r)}))}var ip=Array.isArray;function op(e){return e.length===1&&ip(e[0])?e[0]:e}function os(e){return e===void 0&&(e=1/0),Kn(ns,e)}function ap(){return os(1)}var sp=es(function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),Ht=function(e){_r(t,e);function t(){var r=e.call(this)||this;return r.closed=!1,r.currentObservers=null,r.observers=[],r.isStopped=!1,r.hasError=!1,r.thrownError=null,r}return t.prototype.lift=function(r){var n=new iu(this,this);return n.operator=r,n},t.prototype._throwIfClosed=function(){if(this.closed)throw new sp},t.prototype.next=function(r){var n=this;mi(function(){var i,o;if(n._throwIfClosed(),!n.isStopped){n.currentObservers||(n.currentObservers=Array.from(n.observers));try{for(var a=Hr(n.currentObservers),s=a.next();!s.done;s=a.next()){var u=s.value;u.next(r)}}catch(c){i={error:c}}finally{try{s&&!s.done&&(o=a.return)&&o.call(a)}finally{if(i)throw i.error}}}})},t.prototype.error=function(r){var n=this;mi(function(){if(n._throwIfClosed(),!n.isStopped){n.hasError=n.isStopped=!0,n.thrownError=r;for(var i=n.observers;i.length;)i.shift().error(r)}})},t.prototype.complete=function(){var r=this;mi(function(){if(r._throwIfClosed(),!r.isStopped){r.isStopped=!0;for(var n=r.observers;n.length;)n.shift().complete()}})},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var r;return((r=this.observers)===null||r===void 0?void 0:r.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(r){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,r)},t.prototype._subscribe=function(r){return this._throwIfClosed(),this._checkFinalizedStatuses(r),this._innerSubscribe(r)},t.prototype._innerSubscribe=function(r){var n=this,i=this,o=i.hasError,a=i.isStopped,s=i.observers;return o||a?zc:(this.currentObservers=null,s.push(r),new to(function(){n.currentObservers=null,ea(s,r)}))},t.prototype._checkFinalizedStatuses=function(r){var n=this,i=n.hasError,o=n.thrownError,a=n.isStopped;i?r.error(o):a&&r.complete()},t.prototype.asObservable=function(){var r=new Xe;return r.source=this,r},t.create=function(r,n){return new iu(r,n)},t}(Xe),iu=function(e){_r(t,e);function t(r,n){var i=e.call(this)||this;return i.destination=r,i.source=n,i}return t.prototype.next=function(r){var n,i;(i=(n=this.destination)===null||n===void 0?void 0:n.next)===null||i===void 0||i.call(n,r)},t.prototype.error=function(r){var n,i;(i=(n=this.destination)===null||n===void 0?void 0:n.error)===null||i===void 0||i.call(n,r)},t.prototype.complete=function(){var r,n;(n=(r=this.destination)===null||r===void 0?void 0:r.complete)===null||n===void 0||n.call(r)},t.prototype._subscribe=function(r){var n,i;return(i=(n=this.source)===null||n===void 0?void 0:n.subscribe(r))!==null&&i!==void 0?i:zc},t}(Ht);function ou(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return ap()(is(e,ro(e)))}var up=new Xe(function(e){return e.complete()});function ra(e,t){return t===void 0&&(t=ns),e=e??cp,Rt(function(r,n){var i,o=!0;r.subscribe(Qr(n,function(a){var s=t(a);(o||!e(i,s))&&(o=!1,i=s,n.next(a))}))})}function cp(e,t){return e===t}function tt(e,t){return Rt(function(r,n){var i=0;r.subscribe(Qr(n,function(o){return e.call(t,o,i++)&&n.next(o)}))})}var lp=es(function(e){return function(){e(this),this.name="EmptyError",this.message="no elements in sequence"}});function fp(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=ro(e),n=tl(e,1/0);return e=op(e),Rt(function(i,o){os(n)(is(pr([i],dr(e)),r)).subscribe(o)})}function hp(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return fp.apply(void 0,pr([],dr(e)))}var dp=function(e){_r(t,e);function t(r){var n=e.call(this)||this;return n._value=r,n}return Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),t.prototype._subscribe=function(r){var n=e.prototype._subscribe.call(this,r);return!n.closed&&r.next(this._value),n},t.prototype.getValue=function(){var r=this,n=r.hasError,i=r.thrownError,o=r._value;if(n)throw i;return this._throwIfClosed(),o},t.prototype.next=function(r){e.prototype.next.call(this,this._value=r)},t}(Ht),pp=function(e){_r(t,e);function t(r,n,i){r===void 0&&(r=1/0),n===void 0&&(n=1/0),i===void 0&&(i=Jc);var o=e.call(this)||this;return o._bufferSize=r,o._windowTime=n,o._timestampProvider=i,o._buffer=[],o._infiniteTimeWindow=!0,o._infiniteTimeWindow=n===1/0,o._bufferSize=Math.max(1,r),o._windowTime=Math.max(1,n),o}return t.prototype.next=function(r){var n=this,i=n.isStopped,o=n._buffer,a=n._infiniteTimeWindow,s=n._timestampProvider,u=n._windowTime;i||(o.push(r),!a&&o.push(s.now()+u)),this._trimBuffer(),e.prototype.next.call(this,r)},t.prototype._subscribe=function(r){this._throwIfClosed(),this._trimBuffer();for(var n=this._innerSubscribe(r),i=this,o=i._infiniteTimeWindow,a=i._buffer,s=a.slice(),u=0;u<s.length&&!r.closed;u+=o?1:2)r.next(s[u]);return this._checkFinalizedStatuses(r),n},t.prototype._trimBuffer=function(){var r=this,n=r._bufferSize,i=r._timestampProvider,o=r._buffer,a=r._infiniteTimeWindow,s=(a?1:2)*n;if(n<1/0&&s<o.length&&o.splice(0,o.length-s),!a){for(var u=i.now(),c=0,l=1;l<o.length&&o[l]<=u;l+=2)c=l;c&&o.splice(0,c+1)}},t}(Ht);function mp(e){e===void 0&&(e={});var t=e.connector,r=t===void 0?function(){return new Ht}:t,n=e.resetOnError,i=n===void 0?!0:n,o=e.resetOnComplete,a=o===void 0?!0:o,s=e.resetOnRefCountZero,u=s===void 0?!0:s;return function(c){var l,f,h,d=0,y=!1,p=!1,b=function(){f==null||f.unsubscribe(),f=void 0},m=function(){b(),l=h=void 0,y=p=!1},g=function(){var w=l;m(),w==null||w.unsubscribe()};return Rt(function(w,S){d++,!p&&!y&&b();var k=h=h??r();S.add(function(){d--,d===0&&!p&&!y&&(f=bo(g,u))}),k.subscribe(S),!l&&d>0&&(l=new Gr({next:function(D){return k.next(D)},error:function(D){p=!0,b(),f=bo(m,i,D),k.error(D)},complete:function(){y=!0,b(),f=bo(m,a),k.complete()}}),Xt(w).subscribe(l))})(c)}}function bo(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];if(t===!0){e();return}if(t!==!1){var i=new Gr({next:function(){i.unsubscribe(),e()}});return Xt(t.apply(void 0,pr([],dr(r)))).subscribe(i)}}function ol(e,t,r){var n,i,o,a,s=!1;return e&&typeof e=="object"?(n=e.bufferSize,a=n===void 0?1/0:n,i=e.windowTime,t=i===void 0?1/0:i,o=e.refCount,s=o===void 0?!1:o,r=e.scheduler):a=e??1/0,mp({connector:function(){return new pp(a,t,r)},resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:s})}function al(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=ro(e);return Rt(function(n,i){(r?ou(e,n,r):ou(e,n)).subscribe(i)})}function sl(e){return e.documentData?e.documentData:e.previousDocumentData}function yp(e){switch(e.operation){case"INSERT":return{operation:e.operation,id:e.documentId,doc:e.documentData,previous:null};case"UPDATE":return{operation:e.operation,id:e.documentId,doc:Oe.deepFreezeWhenDevMode(e.documentData),previous:e.previousDocumentData?e.previousDocumentData:"UNKNOWN"};case"DELETE":return{operation:e.operation,id:e.documentId,doc:null,previous:e.previousDocumentData}}}function Gt(e,t){var r=t;r=r.replace(_d,".properties."),r="properties."+r,r=Cn(r);var n=jt(e,r);return n}function ul(e,t,r){if(typeof t.primaryKey=="string")return r;var n=as(t,r),i=r[e];if(i&&i!==n)throw q("DOC19",{args:{documentData:r,existingPrimary:i,newPrimary:n},schema:t});return r[e]=n,r}function ot(e){return typeof e=="string"?e:e.key}function as(e,t){if(typeof e.primaryKey=="string")return t[e.primaryKey];var r=e.primaryKey;return r.fields.map(n=>{var i=jt(t,n);if(typeof i>"u")throw q("DOC18",{args:{field:n,documentData:t}});return i}).join(r.separator)}function vp(e){var t=Ri(e,!0);return t}function cl(e){e=Re(e);var t=ot(e.primaryKey);e.properties=Re(e.properties),e.additionalProperties=!1,e.hasOwnProperty("keyCompression")||(e.keyCompression=!1),e.indexes=e.indexes?e.indexes.slice(0):[],e.required=e.required?e.required.slice(0):[],e.encrypted=e.encrypted?e.encrypted.slice(0):[],e.properties._rev={type:"string",minLength:1},e.properties._attachments={type:"object"},e.properties._deleted={type:"boolean"},e.properties._meta=gp,e.required=e.required?e.required.slice(0):[],e.required.push("_deleted"),e.required.push("_rev"),e.required.push("_meta"),e.required.push("_attachments");var r=ll(e);return Zi(e.required,r),e.required=e.required.filter(n=>!n.includes(".")).filter((n,i,o)=>o.indexOf(n)===i),e.version=e.version||0,e.indexes&&(e.indexes=e.indexes.map(n=>{var i=Br(n)?n.slice(0):[n];if(!i.includes(t)){var o=i.slice(0);return o.push(t),o}return i})),e}var gp={type:"object",properties:{lwt:{type:"number",minimum:Ja,maximum:1e15,multipleOf:.01}},additionalProperties:!0,required:["lwt"]};function ll(e){var t=Object.keys(e.properties).filter(n=>e.properties[n].final),r=ot(e.primaryKey);return t.push(r),typeof e.primaryKey!="string"&&e.primaryKey.fields.forEach(n=>t.push(n)),t}function bp(e,t){for(var r=Object.keys(e.defaultValues),n=0;n<r.length;++n){var i=r[n];(!t.hasOwnProperty(i)||typeof t[i]>"u")&&(t[i]=e.defaultValues[i])}return t}var _p={type:"object",properties:{id:{type:"string"},lwt:{type:"number"}},required:["id","lwt"],additionalProperties:!1},wp="_rxdb_internal";async function kp(e,t){var r=await e.findDocumentsById([t],!1),n=r[t];return n||null}function xp(e,t,r){var n=t.documentData,i=t.previousDocumentData,o={eventId:t.eventId,documentId:t.documentId,collectionName:r?r.name:void 0,startTime:t.startTime,endTime:t.endTime,isLocal:e,operation:t.operation,documentData:Oe.deepFreezeWhenDevMode(n),previousDocumentData:Oe.deepFreezeWhenDevMode(i)};return o}function na(e,t,r,n){if(n)throw n.status===409?q("CONFLICT",{collection:e.name,id:t,writeError:n,data:r}):n.status===422?q("VD2",{collection:e.name,id:t,writeError:n,data:r}):n}function Ep(e,t,r,n,i){for(var o=!!e.schema.attachments,a=[],s=[],u={},c=[],l=eo(10),f={id:l,events:[],checkpoint:null,context:i},h=[],d=[],y=[],p=ze(),b=typeof r.get=="function",m=b?r.size>0:Object.keys(r).length>0,g,w=n.length,S=function(){var E=n[k],I=E.document[t],A=!1;m&&(A=b?r.get(I):r[I]);var N;if(A){var C=A._rev;if(!E.previous||E.previous&&C!==E.previous._rev){var M={isError:!0,status:409,documentId:I,writeRow:E,documentInDb:A};return u[I]=M,"continue"}var _=o?au(E):E;o&&(E.document._deleted?E.previous&&Object.keys(E.previous._attachments).forEach(L=>{d.push({documentId:I,attachmentId:L,digest:_e(E.previous)._attachments[L].digest})}):(Object.entries(E.document._attachments).find(([L,J])=>{var B=E.previous?E.previous._attachments[L]:void 0;return!B&&!J.data&&(N={documentId:I,documentInDb:A,isError:!0,status:510,writeRow:E,attachmentId:L}),!0}),N||Object.entries(E.document._attachments).forEach(([L,J])=>{var B=E.previous?E.previous._attachments[L]:void 0;if(!B)h.push({documentId:I,attachmentId:L,attachmentData:J,digest:gn(J.data)});else{var T=_.document._attachments[L].digest;J.data&&B.digest!==T&&y.push({documentId:I,attachmentId:L,attachmentData:J,digest:gn(J.data)})}}))),N?u[I]=N:(s.push(_),(!g||g.document._meta.lwt<_.document._meta.lwt)&&(g=_));var F=E.document,ee=null,j=null,te=null;if(E.previous&&E.previous._deleted&&!F._deleted)te="INSERT",ee=o?mn(F):F;else if(E.previous&&!E.previous._deleted&&!F._deleted)te="UPDATE",ee=o?mn(F):F,j=E.previous;else if(F._deleted)te="DELETE",ee=_e(E.document),j=E.previous;else throw q("SNH",{args:{writeRow:E}});c.push(I),f.events.push({eventId:su(l,k,I,E),documentId:I,documentData:ee,previousDocumentData:j,operation:te,startTime:p,endTime:ze()})}else{var G=!!E.document._deleted;o&&Object.entries(E.document._attachments).forEach(([L,J])=>{J.data?h.push({documentId:I,attachmentId:L,attachmentData:J,digest:gn(J.data)}):(N={documentId:I,isError:!0,status:510,writeRow:E,attachmentId:L},u[I]=N)}),N||(o?a.push(au(E)):a.push(E),(!g||g.document._meta.lwt<E.document._meta.lwt)&&(g=E)),G||(c.push(I),f.events.push({eventId:su(l,k,I,E),documentId:I,operation:"INSERT",documentData:o?mn(E.document):E.document,previousDocumentData:o&&E.previous?mn(E.previous):E.previous,startTime:p,endTime:ze()}))}},k=0;k<w;k++)var D=S();return{bulkInsertDocs:a,bulkUpdateDocs:s,newestRow:g,errors:u,changedDocumentIds:c,eventBulk:f,attachmentsAdd:h,attachmentsRemove:d,attachmentsUpdate:y}}function au(e){return{previous:e.previous,document:mn(e.document)}}function Sp(e){return atob(e).length}function Op(e){var t=e.data;if(!t)return e;var r={digest:gn(t),length:Sp(t),type:e.type};return r}function mn(e){var t=Re(e);return t._attachments={},Object.entries(e._attachments).forEach(([r,n])=>{t._attachments[r]=Op(n)}),t}function fl(e){var t=Re(e);return t._meta=Re(e._meta),t}function su(e,t,r,n){return e+"|"+t+"|"+r+"|"+n.document._rev}function hl(e,t,r){Oe.deepFreezeWhenDevMode(r);var n=ot(r.primaryKey);function i(a){var s=Re(a.document);return s._meta=Re(s._meta),Oe.isDevMode()&&(s=ul(n,r,s),a.previous,a.previous&&Object.keys(a.previous._meta).forEach(u=>{if(!a.document._meta.hasOwnProperty(u))throw q("SNH",{dataBefore:a.previous,dataAfter:a.document})})),s._meta.lwt=ze(),s._rev=Vo(e.token,a.previous),{document:s,previous:a.previous}}var o={originalStorageInstance:t,schema:t.schema,internals:t.internals,collectionName:t.collectionName,databaseName:t.databaseName,options:t.options,bulkWrite(a,s){var u=a.map(c=>i(c));return e.lockedRun(()=>t.bulkWrite(u,s)).then(c=>{var l=Object.values(c.error).filter(d=>!!(d.status===409&&!d.writeRow.previous&&!d.writeRow.document._deleted&&_e(d.documentInDb)._deleted));if(l.length>0){var f={error:Re(c.error),success:Re(c.success)},h=l.map(d=>(delete f.error[d.documentId],{previous:d.documentInDb,document:Object.assign({},d.writeRow.document,{_rev:Vo(e.token,d.documentInDb)})}));return e.lockedRun(()=>t.bulkWrite(h,s)).then(d=>(f.error=Object.assign(f.error,d.error),f.success=Object.assign(f.success,d.success),f))}return c})},query(a){return e.lockedRun(()=>t.query(a))},count(a){return e.lockedRun(()=>t.count(a))},findDocumentsById(a,s){return e.lockedRun(()=>t.findDocumentsById(a,s))},getAttachmentData(a,s,u){return e.lockedRun(()=>t.getAttachmentData(a,s,u))},getChangedDocumentsSince(a,s){return e.lockedRun(()=>t.getChangedDocumentsSince(_e(a),s))},cleanup(a){return e.lockedRun(()=>t.cleanup(a))},remove(){return e.storageInstances.delete(o),e.lockedRun(()=>t.remove())},close(){return e.storageInstances.delete(o),e.lockedRun(()=>t.close())},changeStream(){return t.changeStream()},conflictResultionTasks(){return t.conflictResultionTasks()},resolveConflictResultionTask(a){if(a.output.isEqual)return t.resolveConflictResultionTask(a);var s=Object.assign({},a.output.documentData,{_meta:Xi(),_rev:Ji(),_attachments:{}}),u=Re(s);return delete u._meta,delete u._rev,delete u._attachments,t.resolveConflictResultionTask({id:a.id,output:{isEqual:!1,documentData:u}})}};return e.storageInstances.add(o),o}function Cp(e){if(e.schema.keyCompression)throw q("UT5",{args:{params:e}});if(Dp(e.schema))throw q("UT6",{args:{params:e}});if(e.schema.attachments&&e.schema.attachments.compression)throw q("UT7",{args:{params:e}})}function Dp(e){return!!(e.encrypted&&e.encrypted.length>0||e.attachments&&e.attachments.encrypted)}var Ap=function(){function e(r,n,i,o){this.queueByDocId=new Map,this.isRunning=!1,this.storageInstance=r,this.primaryPath=n,this.preWrite=i,this.postWrite=o}var t=e.prototype;return t.addWrite=function(n,i){var o=n[this.primaryPath],a=hr(this.queueByDocId,o,()=>[]),s=new Promise((u,c)=>{var l={lastKnownDocumentState:n,modifier:i,resolve:u,reject:c};_e(a).push(l),this.triggerRun()});return s},t.triggerRun=async function(){if(!(this.isRunning===!0||this.queueByDocId.size===0)){this.isRunning=!0;var n=[],i=this.queueByDocId;this.queueByDocId=new Map,await Promise.all(Array.from(i.entries()).map(async([a,s])=>{var u=Pp(s.map(f=>f.lastKnownDocumentState)),c=u;for(var l of s)try{c=await l.modifier($r(c))}catch(f){l.reject(f),l.reject=()=>{},l.resolve=()=>{}}try{await this.preWrite(c,u)}catch(f){s.forEach(h=>h.reject(f));return}n.push({previous:u,document:c})}));var o=n.length>0?await this.storageInstance.bulkWrite(n,"incremental-write"):{error:{},success:{}};return await Promise.all(Array.from(Object.entries(o.success)).map(([a,s])=>{this.postWrite(s);var u=An(i,a);u.forEach(c=>c.resolve(s))})),Array.from(Object.entries(o.error)).forEach(([a,s])=>{var u=An(i,a),c=Dd(s);if(c){var l=hr(this.queueByDocId,a,()=>[]);u.reverse().forEach(h=>{h.lastKnownDocumentState=_e(c.documentInDb),_e(l).unshift(h)})}else{var f=Pd(s);u.forEach(h=>h.reject(f))}}),this.isRunning=!1,this.triggerRun()}},e}();function uu(e){var t=async r=>{var n=Vh(r);n._deleted=r._deleted;var i=await e(n),o=Object.assign({},i,{_meta:r._meta,_attachments:r._attachments,_rev:r._rev,_deleted:typeof i._deleted<"u"?i._deleted:r._deleted});return typeof o._deleted>"u"&&(o._deleted=!1),o};return t}function Pp(e){var t=e[0],r=Qo(t._rev).height;return e.forEach(n=>{var i=Qo(n._rev).height;i>r&&(t=n,r=i)}),t}var qn={get primaryPath(){var e=this;if(e.isInstanceOfRxDocument)return e.collection.schema.primaryPath},get primary(){var e=this;if(e.isInstanceOfRxDocument)return e._data[e.primaryPath]},get revision(){var e=this;if(e.isInstanceOfRxDocument)return e._data._rev},get deleted$(){var e=this;if(e.isInstanceOfRxDocument)return e.$.pipe(Lt(t=>t._deleted))},get deleted(){var e=this;if(e.isInstanceOfRxDocument)return e._data._deleted},getLatest(){var e=this.collection._docCache.getLatestDocumentData(this.primary);return this.collection._docCache.getCachedRxDocument(e)},get $(){var e=this;return e.collection.$.pipe(tt(t=>!t.isLocal),tt(t=>t.documentId===this.primary),Lt(t=>sl(t)),al(e.collection._docCache.getLatestDocumentData(this.primary)),ra((t,r)=>t._rev===r._rev),Lt(t=>this.collection._docCache.getCachedRxDocument(t)),ol(Bc))},get$(e){if(Oe.isDevMode()){if(e.includes(".item."))throw q("DOC1",{path:e});if(e===this.primaryPath)throw q("DOC2");if(this.collection.schema.finalFields.includes(e))throw q("DOC3",{path:e});var t=Gt(this.collection.schema.jsonSchema,e);if(!t)throw q("DOC4",{path:e})}return this.$.pipe(Lt(r=>jt(r,e)),ra())},populate(e){var t=Gt(this.collection.schema.jsonSchema,e),r=this.get(e);if(!r)return ld;if(!t)throw q("DOC5",{path:e});if(!t.ref)throw q("DOC6",{path:e,schemaObj:t});var n=this.collection.database.collections[t.ref];if(!n)throw q("DOC7",{ref:t.ref,path:e,schemaObj:t});return t.type==="array"?n.findByIds(r).exec().then(i=>{var o=i.values();return Array.from(o)}):n.findOne(r).exec()},get(e){if(this._data){var t=this._propertyCache.get(e);if(t)return t;var r=jt(this._data,e);return typeof r!="object"||Array.isArray(r)?Oe.deepFreezeWhenDevMode(r):(r=$r(r),pl(this.collection.schema,r,e,this),this._propertyCache.set(e,r),r)}},toJSON(e=!1){if(e)return Oe.deepFreezeWhenDevMode(this._data);var t=Re(this._data);return delete t._rev,delete t._attachments,delete t._deleted,delete t._meta,Oe.deepFreezeWhenDevMode(t)},toMutableJSON(e=!1){return $r(this.toJSON(e))},update(e){throw ve("update")},incrementalUpdate(e){throw ve("update")},updateCRDT(e){throw ve("crdt")},putAttachment(){throw ve("attachments")},getAttachment(){throw ve("attachments")},allAttachments(){throw ve("attachments")},get allAttachments$(){throw ve("attachments")},async modify(e,t){var r=this._data,n=await uu(e)(r);return this._saveData(n,r)},incrementalModify(e,t){return this.collection.incrementalWriteQueue.addWrite(this._data,uu(e)).then(r=>this.collection._docCache.getCachedRxDocument(r))},patch(e){var t=this._data,r=$r(t);return Object.entries(e).forEach(([n,i])=>{r[n]=i}),this._saveData(r,t)},incrementalPatch(e){return this.incrementalModify(t=>(Object.entries(e).forEach(([r,n])=>{t[r]=n}),t))},async _saveData(e,t){if(e=Re(e),this._data._deleted)throw q("DOC11",{id:this.primary,document:this});await ml(this.collection,e,t);var r=await this.collection.storageInstance.bulkWrite([{previous:t,document:e}],"rx-document-save-data"),n=r.error[this.primary];return na(this.collection,this.primary,e,n),await this.collection._runHooks("post","save",e,this),this.collection._docCache.getCachedRxDocument(eu(r.success,this.primary))},remove(){var e=this.collection;if(this.deleted)return Promise.reject(q("DOC13",{document:this,id:this.primary}));var t=Re(this._data),r;return e._runHooks("pre","remove",t,this).then(async()=>{t._deleted=!0;var n=await e.storageInstance.bulkWrite([{previous:this._data,document:t}],"rx-document-remove"),i=n.error[this.primary];return na(e,this.primary,t,i),eu(n.success,this.primary)}).then(n=>(r=n,this.collection._runHooks("post","remove",t,this))).then(()=>this.collection._docCache.getCachedRxDocument(r))},incrementalRemove(){return this.incrementalModify(async e=>(await this.collection._runHooks("pre","remove",e,this),e._deleted=!0,e)).then(async e=>(await this.collection._runHooks("post","remove",e._data,e),e))},destroy(){throw q("DOC14")}};function dl(e=qn){var t=function(n,i){this.collection=n,this._data=i,this._propertyCache=new Map,this.isInstanceOfRxDocument=!0};return t.prototype=e,t}function pl(e,t,r="",n=!1){if(t!==null){var i=Gt(e.jsonSchema,r);typeof i>"u"||(i.properties&&(i=i.properties),Object.keys(i).forEach(o=>{var a=Cn(r+"."+o);t.__defineGetter__(o,function(){var s=n||this;if(!(!s.get||typeof s.get!="function")){var u=s.get(a);return u}}),Object.defineProperty(t,o+"$",{get:function(){var s=n||this;return s.get$(a)},enumerable:!1,configurable:!1}),Object.defineProperty(t,o+"_",{get:function(){var s=n||this;return s.populate(a)},enumerable:!1,configurable:!1}),t.__defineSetter__(o,function(s){var u=n||this;return u.set(a,s)})}))}}function Ip(e,t,r){var n=new e(t,r);return it("createRxDocument",n),n}function ml(e,t,r){return t._meta=Object.assign({},r._meta,t._meta),Oe.isDevMode()&&e.schema.validateChange(r,t),e._runHooks("pre","save",t,r)}var yl=function(){function e(r,n){this.jsonSchema=r,this.hashFunction=n,this.indexes=Rp(this.jsonSchema),this.primaryPath=ot(this.jsonSchema.primaryKey),this.finalFields=ll(this.jsonSchema)}var t=e.prototype;return t.validateChange=function(n,i){this.finalFields.forEach(o=>{if(!Dn(n[o],i[o]))throw q("DOC9",{dataBefore:n,dataAfter:i,fieldName:o,schema:this.jsonSchema})})},t.getDocumentPrototype=function(){var n={};return pl(this,n,""),di(this,"getDocumentPrototype",()=>n),n},t.getPrimaryOfDocumentData=function(n){return as(this.jsonSchema,n)},rn(e,[{key:"version",get:function(){return this.jsonSchema.version}},{key:"defaultValues",get:function(){var r={};return Object.entries(this.jsonSchema.properties).filter(([,n])=>n.hasOwnProperty("default")).forEach(([n,i])=>r[n]=i.default),di(this,"defaultValues",r)}},{key:"hash",get:function(){return di(this,"hash",this.hashFunction(JSON.stringify(this.jsonSchema)))}}]),e}();function Rp(e){return(e.indexes||[]).map(t=>Br(t)?t:[t])}function Tp(e){var t=e.version?e.version:0,r=0;return new Array(t).fill(0).map(()=>r++)}function Mp(e,t,r=!0){r&&it("preCreateRxSchema",e);var n=cl(e);n=vp(n),Oe.deepFreezeWhenDevMode(n);var i=new yl(n,t);return it("createRxSchema",i),i}function Bp(e,t){var r=typeof t=="object";return new Promise(function(n,i){var o=new Gr({next:function(a){n(a),o.unsubscribe()},error:i,complete:function(){r?n(t.defaultValue):i(new lp)}});e.subscribe(o)})}function $p(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=ro(e),n=tl(e,1/0),i=e;return i.length?i.length===1?Xt(i[0]):os(n)(is(i,r)):up}const Wn="UNKNOWN";function ss(e){return e[e.length-1]}function Np(e){const t=typeof e;return e!==null&&(t==="object"||t==="function")}function cu(e,t,r){if(Array.isArray(t)&&(t=t.join(".")),!Np(e)||typeof t!="string")return r===void 0?e:r;const n=t.split(".");if(n.length===0)return r;for(let i=0;i<n.length;i++){const o=n[i];if(Fp(e,o)?e=i===n.length-1?void 0:null:e=e[o],e==null){if(i!==n.length-1)return r;break}}return e===void 0?r:e}function Fp(e,t){if(typeof t!="number"&&Array.isArray(e)){const r=Number.parseInt(t,10);return Number.isInteger(r)&&e[r]===e[t]}return!1}const vl=e=>!!e.queryParams.limit,jp=e=>e.queryParams.limit===1,Lp=e=>!!(e.queryParams.skip&&e.queryParams.skip>0),zp=e=>e.changeEvent.operation==="DELETE",Up=e=>e.changeEvent.operation==="INSERT",Kp=e=>e.changeEvent.operation==="UPDATE",qp=e=>e.changeEvent.previous===Wn,Wp=e=>vl(e)&&e.previousResults.length>=e.queryParams.limit,Hp=e=>{const t=e.queryParams.sortFields,r=e.changeEvent.previous,n=e.changeEvent.doc;if(!n)return!1;if(!r||r===Wn)return!0;for(let i=0;i<t.length;i++){const o=t[i],a=cu(r,o),s=cu(n,o);if(a!==s)return!0}return!1},Gp=e=>{const t=e.changeEvent.id;if(e.keyDocumentMap)return e.keyDocumentMap.has(t);{const r=e.queryParams.primaryKey,n=e.previousResults;for(let i=0;i<n.length;i++)if(n[i][r]===t)return!0;return!1}},Qp=e=>{const t=e.previousResults[0];return!!(t&&t[e.queryParams.primaryKey]===e.changeEvent.id)},Vp=e=>{const t=ss(e.previousResults);return!!(t&&t[e.queryParams.primaryKey]===e.changeEvent.id)},Yp=e=>{const t=e.changeEvent.previous;if(!t||t===Wn)return!1;const r=e.previousResults[0];return r?r[e.queryParams.primaryKey]===e.changeEvent.id?!0:e.queryParams.sortComparator(t,r)<0:!1},Zp=e=>{const t=e.changeEvent.previous;if(!t||t===Wn)return!1;const r=ss(e.previousResults);return r?r[e.queryParams.primaryKey]===e.changeEvent.id?!0:e.queryParams.sortComparator(t,r)>0:!1},Xp=e=>{const t=e.changeEvent.doc;if(!t)return!1;const r=e.previousResults[0];return r?r[e.queryParams.primaryKey]===e.changeEvent.id?!0:e.queryParams.sortComparator(t,r)<0:!1},Jp=e=>{const t=e.changeEvent.doc;if(!t)return!1;const r=ss(e.previousResults);return r?r[e.queryParams.primaryKey]===e.changeEvent.id?!0:e.queryParams.sortComparator(t,r)>0:!1},em=e=>{const t=e.changeEvent.previous;return!t||t===Wn?!1:e.queryParams.queryMatcher(t)},tm=e=>{const t=e.changeEvent.doc;return t?e.queryParams.queryMatcher(t):!1},rm=e=>e.previousResults.length===0,nm={0:Up,1:Kp,2:zp,3:vl,4:jp,5:Lp,6:rm,7:qp,8:Wp,9:Qp,10:Vp,11:Hp,12:Gp,13:Yp,14:Zp,15:Xp,16:Jp,17:em,18:tm};function im(e,t,r,n){var i=n?e:e.slice(0),o=i.length-1,a=0,s=0;if(i.length===0)return i.push(t),[i,0];for(var u;a<=o;)s=a+(o-a>>1),u=i[s],r(u,t)<=0?a=s+1:o=s-1;return r(u,t)<=0&&s++,i.splice(s,0,t),[i,s]}const om=e=>{},us=e=>{e.previousResults.unshift(e.changeEvent.doc),e.keyDocumentMap&&e.keyDocumentMap.set(e.changeEvent.id,e.changeEvent.doc)},cs=e=>{e.previousResults.push(e.changeEvent.doc),e.keyDocumentMap&&e.keyDocumentMap.set(e.changeEvent.id,e.changeEvent.doc)},ls=e=>{const t=e.previousResults.shift();e.keyDocumentMap&&t&&e.keyDocumentMap.delete(t[e.queryParams.primaryKey])},fs=e=>{const t=e.previousResults.pop();e.keyDocumentMap&&t&&e.keyDocumentMap.delete(t[e.queryParams.primaryKey])},am=e=>{ls(e),cs(e)},sm=e=>{fs(e),us(e)},um=e=>{ls(e),us(e)},cm=e=>{fs(e),cs(e)},gl=e=>{e.keyDocumentMap&&e.keyDocumentMap.delete(e.changeEvent.id);const t=e.queryParams.primaryKey,r=e.previousResults;for(let n=0;n<r.length;n++)if(r[n][t]===e.changeEvent.id){r.splice(n,1);break}},lm=e=>{const t=e.changeEvent.doc,r=e.queryParams.primaryKey,n=e.previousResults;for(let i=0;i<n.length;i++)if(n[i][r]===e.changeEvent.id){n[i]=t,e.keyDocumentMap&&e.keyDocumentMap.set(e.changeEvent.id,t);break}},fm=e=>{const t={_id:"wrongHuman"+new Date().getTime()};e.previousResults.length=0,e.previousResults.push(t),e.keyDocumentMap&&(e.keyDocumentMap.clear(),e.keyDocumentMap.set(t._id,t))},bl=e=>{const t=e.changeEvent.id,r=e.changeEvent.doc;if(e.keyDocumentMap){if(e.keyDocumentMap.has(t))return;e.keyDocumentMap.set(t,r)}else if(e.previousResults.find(i=>i[e.queryParams.primaryKey]===t))return;im(e.previousResults,r,e.queryParams.sortComparator,!0)},hm=e=>{gl(e),bl(e)},dm=e=>{throw new Error("Action runFullQueryAgain must be implemented by yourself")},pm=e=>{throw new Error("Action unknownAction should never be called")},mm=["doNothing","insertFirst","insertLast","removeFirstItem","removeLastItem","removeFirstInsertLast","removeLastInsertFirst","removeFirstInsertFirst","removeLastInsertLast","removeExisting","replaceExisting","alwaysWrong","insertAtSortPosition","removeExistingAndInsertAtSortPosition","runFullQueryAgain","unknownAction"],ym={doNothing:om,insertFirst:us,insertLast:cs,removeFirstItem:ls,removeLastItem:fs,removeFirstInsertLast:am,removeLastInsertFirst:sm,removeFirstInsertFirst:um,removeLastInsertLast:cm,removeExisting:gl,replaceExisting:lm,alwaysWrong:fm,insertAtSortPosition:bl,removeExistingAndInsertAtSortPosition:hm,runFullQueryAgain:dm,unknownAction:pm},vm=40;function _o(e){return e.charCodeAt(0)-vm}function gm(e){return e?"1":"0"}function lu(e,t){const r=[];for(let n=0,i=e.length;n<i;n+=t)r.push(e.substring(n,n+t));return r}function bm(e){const t=new Map,n=2+parseInt(e.charAt(0)+e.charAt(1),10)*2,i=e.substring(2,n),o=lu(i,2);for(let p=0;p<o.length;p++){const b=o[p],m=b.charAt(0),g=_o(b.charAt(1));t.set(m,g)}const a=e.substring(n,e.length-3),s=lu(a,4);for(let p=0;p<s.length;p++){const b=s[p],m=b.charAt(0),g=b.charAt(1),w=b.charAt(2),S=_o(b.charAt(3));if(!t.has(g))throw new Error("missing node with id "+g);if(!t.has(w))throw new Error("missing node with id "+w);const k=t.get(g),D=t.get(w),E={l:S,0:k,1:D};t.set(m,E)}const u=e.slice(-3),c=u.charAt(0),l=u.charAt(1),f=_o(u.charAt(2)),h=t.get(c),d=t.get(l);return{l:f,0:h,1:d}}function _m(e,t,r){let n=e,i=e.l;for(;;){const o=t[i](r),a=gm(o);if(n=n[a],typeof n=="number"||typeof n=="string")return n;i=n.l}}const wm="14a2b0c/d1e,f+g5h.i4j*k-l)m(n6ohk1pdf1qef1rin-sjn-ton-ugn-vmn-whn-xkn-yln-zdf5{ef5|wx5}df7~dz7ef7¡bk7¢e{7£g|7¤ry7¥dp7¦gk7§eq7¨gt7©ac7ªmv7«gu7¬nm7­iy7®nw7¯¤s8°«¦8±¬k8²ªm8³®v8´«n8µ¬n8¶vm8·xv8¸mn8¹­j8º®m8»xm8¼­¹3½}~3¾©°3¿¢3À¡£3Ám±3Â®º3Ãmº3Ä©´3Åb®3Æmµ3Çm»3Èx»3Ékn3Êm¸3Ë¼j6ÌÂm6ÍÆÃ6ÎÈm6Ïnm6ÐÊÇ6ÑÌÎ,ÒÍÐ,ÓÅÉ,Ô²¶,Õ³·,Ö®n,×º»,Ømf9ÙËÁ9Úym9ÛmÏ9ÜÑÒ9Ýz{2Þpq2ß½¿2à¾À2á¥§2â°¨2ãÄÓ2ä´Ö2åÝn0æÞn0çØÛ0èÙÜ0éßn0êàã0ë²Ô0ì¯Õ0íán0îâä0ï¹×0ðçv/ñåæ/òçë/óèì/ôéí/õêî/öÚy/÷òm(øóï(ùöy(ú÷ø:ûôõ:ümù:ýðñ4þúû4ÿþý*Āüm*ÿĀ.";let wo;function km(){return wo||(wo=bm(wm)),wo}const xm=e=>_m(km(),nm,e);function Em(e){const t=xm(e);return mm[t]}function Sm(e,t,r,n,i){const o=ym[e];return o({queryParams:t,changeEvent:r,previousResults:n,keyDocumentMap:i}),n}var Ir=String.fromCharCode(65535),ir=Number.MIN_VALUE;function Om(e,t){var r=ot(e.primaryKey),n=t.selector,i=e.indexes?e.indexes.slice(0):[];t.index?i=[t.index]:i.push([r]);var o=t.sort.map(l=>Object.keys(l)[0]),a=o.join(","),s=!!t.sort.find(l=>Object.values(l)[0]==="desc"),u=-1,c;return i.forEach(l=>{var f=!0,h=!0,d=l.map(b=>{var m=n[b],g=m?Object.keys(m):[],w={};if(!m||!g.length){var S=h?ir:Ir;w={startKey:S,endKey:f?Ir:ir,inclusiveStart:!0,inclusiveEnd:!0}}else g.forEach(k=>{if(hs.has(k)){var D=m[k],E=Am(k,D);w=Object.assign(w,E)}});return typeof w.startKey>"u"&&(w.startKey=ir),typeof w.endKey>"u"&&(w.endKey=Ir),typeof w.inclusiveStart>"u"&&(w.inclusiveStart=!0),typeof w.inclusiveEnd>"u"&&(w.inclusiveEnd=!0),h&&!w.inclusiveStart&&(h=!1),f&&!w.inclusiveEnd&&(f=!1),w}),y={index:l,startKeys:d.map(b=>b.startKey),endKeys:d.map(b=>b.endKey),inclusiveEnd:f,inclusiveStart:h,sortFieldsSameAsIndexFields:!s&&a===l.join(","),selectorSatisfiedByIndex:fu(l,t.selector)},p=Pm(e,t,y);(p>0&&p>u||t.index)&&(u=p,c=y)}),c||(c={index:[r],startKeys:[ir],endKeys:[Ir],inclusiveEnd:!0,inclusiveStart:!0,sortFieldsSameAsIndexFields:!s&&a===r,selectorSatisfiedByIndex:fu([r],t.selector)}),c}var hs=new Set(["$eq","$gt","$gte","$lt","$lte"]),Cm=new Set(["$eq","$gt","$gte"]),Dm=new Set(["$eq","$lt","$lte"]);function fu(e,t){var r=Object.entries(t),n=r.find(([u,c])=>{if(!e.includes(u))return!0;var l=Object.entries(c).find(([f,h])=>!hs.has(f));return l});if(n)return!1;var i,o=e.find(u=>{var c=t[u];if(!c)return!1;var l=Object.keys(c).find(f=>Cm.has(f));return i&&l?!0:(l!=="$eq"&&(i=l),!1)});if(o)return!1;var a,s=e.find(u=>{var c=t[u];if(!c)return!1;var l=Object.keys(c).find(f=>Dm.has(f));return a&&l?!0:(l!=="$eq"&&(a=l),!1)});return!s}function Am(e,t){switch(e){case"$eq":return{startKey:t,endKey:t};case"$lte":return{endKey:t};case"$gte":return{startKey:t};case"$lt":return{endKey:t,inclusiveEnd:!1};case"$gt":return{startKey:t,inclusiveStart:!1};default:throw new Error("SNH")}}function Pm(e,t,r){var n=0,i=l=>{l>0&&(n=n+l)},o=10,a=ho(r.startKeys,l=>l!==ir&&l!==Ir);i(a*o);var s=ho(r.startKeys,l=>l!==Ir&&l!==ir);i(s*o);var u=ho(r.startKeys,(l,f)=>l===r.endKeys[f]);i(u*o*1.5);var c=r.sortFieldsSameAsIndexFields?5:0;return i(c),n}const Im=2147483647,Rm=-2147483648,Tm=Number.MAX_SAFE_INTEGER,Mm=Number.MIN_SAFE_INTEGER,Rn=Symbol("missing"),ds=e=>{const t=Fr(e);let r=0,n=t.length;for(;n;)r=(r<<5)-r^t.charCodeAt(--n);return r>>>0},_l=new Set(["null","undefined","boolean","number","string","date","regexp"]),hu={null:0,undefined:0,number:1,string:2,object:3,array:4,boolean:5,date:6,regexp:7,function:8},Tn=(e,t)=>{e===Rn&&(e=void 0),t===Rn&&(t=void 0);const[r,n]=[e,t].map(a=>Ct(a).toLowerCase()),i=hu[r],o=hu[n];return i!==o?i-o:e<t?-1:e>t?1:0},Bm=Object.getPrototypeOf({}),$m="[object Object]",Nm=/^\[object ([a-zA-Z0-9]+)\]$/;function Qe(e,t){if(!e)throw new Error(t)}function Mi(e){return e instanceof Array?e.map(Mi):e instanceof Date?new Date(e):Be(e)?jm(e,Mi):e}function Ct(e){return Nm.exec(Object.prototype.toString.call(e))[1]}function ko(e){return typeof e=="boolean"}function Dt(e){return typeof e=="string"}function $t(e){return!isNaN(e)&&typeof e=="number"}const At=Array.isArray;function Be(e){if(!e)return!1;const t=Object.getPrototypeOf(e);return(t===Bm||t===null)&&$m===Object.prototype.toString.call(e)}function no(e){return e===Object(e)}function du(e){return e instanceof Date}function yi(e){return e instanceof RegExp}function We(e){return e==null}function Mn(e,t){return e.includes(t)}function wl(e,t){return!Mn(e,t)}function Fm(e,t){return!!e||t&&e===""}function nn(e){return We(e)||Dt(e)&&!e||e instanceof Array&&e.length===0||Be(e)&&Object.keys(e).length===0}function pu(e){return e===Rn}function Hn(e){return e instanceof Array?e:[e]}function Ye(e,t){return!!e&&Object.prototype.hasOwnProperty.call(e,t)}function jm(e,t){const r={},n=Object.keys(e);for(let i=0;i<n.length;i++){const o=n[i];r[o]=t(e[o],o)}return r}function ia(e,t,r){if(pu(e))return t;if(pu(t))return e;const n=[e,t];if(!(n.every(Be)||n.every(At)))throw Error("mismatched types. must both be array or object");if(r=r||{flatten:!1},At(e)){const i=e,o=t;if(r.flatten){let a=0,s=0;for(;a<i.length&&s<o.length;)i[a]=ia(i[a++],o[s++],r);for(;s<o.length;)i.push(t[s++])}else Vr(i,o)}else Object.keys(t).forEach(i=>{Ye(t,i)&&(Ye(e,i)?e[i]=ia(e[i],t[i],r):e[i]=t[i])});return e}function oa(e,t,r){e.key<t?e.right?oa(e.right,t,r):e.right={key:t,indexes:[r]}:e.key>t?e.left?oa(e.left,t,r):e.left={key:t,indexes:[r]}:e.indexes.push(r)}function aa(e,t){if(e.key==t)return e.indexes;if(e.key<t)return e.right?aa(e.right,t):void 0;if(e.key>t)return e.left?aa(e.left,t):void 0}function kl(e,t=ds){if(e.some(c=>c.length==0))return[];const r=e.map((c,l)=>[l,c.length]);r.sort((c,l)=>c[1]-l[1]);const n=[],i=e[r[0][0]],o={key:vi(i[0],t),indexes:[0]};for(let c=1;c<i.length;c++){const l=i[c],f=vi(l,t);oa(o,f,c)}r[0][1];const a=[];for(let c=1;c<r.length;c++){const l=r[c][0],f=e[l];let h=0;for(let d=0;d<f.length;d++){const y=vi(f[d],t),p=aa(o,y);if(!p)continue;const b=p.map(m=>i[m]).findIndex(m=>sa(m,f[d]));b!=-1&&(n.length<c&&n.push({}),n[n.length-1][p[b]]=!0,h=Object.keys(n[n.length-1]).length,l==0&&a.indexOf(p[b])==-1&&a.push(p[b]))}if(h==0)return[]}const s={};n.forEach(c=>{Object.keys(c).forEach(l=>{const f=parseFloat(l);s[f]=s[f]||0,s[f]++})});const u=a;return u.length==0&&(u.push(...Object.keys(s).map(parseFloat)),u.sort()),u.filter(c=>s[c]==e.length-1).map(c=>i[c])}function xl(e,t){const r=[];function n(i,o){for(let a=0,s=i.length;a<s;a++)At(i[a])&&(o>0||o<0)?n(i[a],Math.max(-1,o-1)):r.push(i[a])}return n(e,t),r}function sa(e,t){const r=[e],n=[t];for(;r.length>0;){if(e=r.pop(),t=n.pop(),e===t)continue;const i=Ct(e).toLowerCase();if(i!==Ct(t).toLowerCase()||i==="function")return!1;if(i==="array"){const o=e,a=t;if(o.length!==a.length)return!1;if(o.length===a.length&&o.length===0)continue;Vr(r,o),Vr(n,a)}else if(i==="object"){const o=Object.keys(e),a=Object.keys(t);if(o.length!==a.length)return!1;for(let s=0,u=o.length;s<u;s++){const c=o[s];if(!Ye(t,c))return!1;r.push(e[c]),n.push(t[c])}}else if(Fr(e)!==Fr(t))return!1}return r.length===0}function Fr(e){const t=Ct(e).toLowerCase();switch(t){case"boolean":case"number":case"regexp":return e.toString();case"string":return JSON.stringify(e);case"date":return e.toISOString();case"null":case"undefined":return t;case"array":return"["+e.map(Fr).join(",")+"]"}const r=t==="object"?"":`${Ct(e)}`,n=Object.keys(e);return n.sort(),`${r}{`+n.map(i=>`${Fr(i)}:${Fr(e[i])}`).join(",")+"}"}function vi(e,t=ds){return We(e)?null:t(e).toString()}function Lm(e,t,r=Tn){const n=[],i=[];if(nn(e))return e;for(let o=0;o<e.length;o++){const a=e[o],s=t(a,o);We(s)?i.push(a):n.push([s,a])}return n.sort((o,a)=>r(o[0],a[0])),i.push(...n.map(o=>o[1])),i}function zm(e,t,r=ds){const n={keys:new Array,groups:new Array},i={};for(let o=0;o<e.length;o++){const a=e[o],s=t(a,o),u=vi(s,r);let c=-1;i[u]===void 0&&(c=n.keys.length,i[u]=c,n.keys.push(s),n.groups.push([])),c=i[u],n.groups[c].push(a)}return n}const xo=5e4;function Vr(e,...t){return e instanceof Array?t.reduce((r,n)=>{let i=Math.ceil(n.length/xo),o=0;for(;i-- >0;)Array.prototype.push.apply(r,n.slice(o,o+xo)),o+=xo;return r},e):t.filter(no).reduce((r,n)=>(Object.assign(r,n),r),e)}function ua(e,t){return no(e)?e[t]:void 0}function Um(e,t){if(t<1)return e;for(;t--&&e.length===1;)e=e[0];return e}function ps(e,t,r){let n=0;function i(a,s){let u=a;for(let c=0;c<s.length;c++){const l=s[c];if(/^\d+$/.exec(l)===null&&u instanceof Array){if(c===0&&n>0)break;n+=1;const h=s.slice(c);u=u.reduce((d,y)=>{const p=i(y,h);return p!==void 0&&d.push(p),d},[]);break}else u=ua(u,l);if(u===void 0)break}return u}const o=_l.has(Ct(e).toLowerCase())?e:i(e,t.split("."));return o instanceof Array&&(r!=null&&r.unwrapArray)?Um(o,n):o}function gi(e,t,r){const n=t.split("."),i=n[0],o=n.slice(1).join("."),a=/^\d+$/.exec(i)!==null,s=n.length>1;let u,c;if(e instanceof Array)if(a)u=ua(e,Number(i)),s&&(u=gi(u,o,r)),u=[u];else{u=[];for(const l of e)c=gi(l,t,r),r!=null&&r.preserveMissing?(c===void 0&&(c=Rn),u.push(c)):c!==void 0&&u.push(c)}else{if(c=ua(e,i),s&&(c=gi(c,o,r)),c===void 0)return;u=r!=null&&r.preserveKeys?{...e}:{},u[i]=c}return u}function ca(e){if(e instanceof Array)for(let t=e.length-1;t>=0;t--)e[t]===Rn?e.splice(t,1):ca(e[t]);else if(Be(e))for(const t in e)Ye(e,t)&&ca(e[t])}function Bi(e,t,r,n){if(We(e))return;const i=t.split("."),o=i[0],a=i.slice(1).join(".");if(i.length===1)r(e,o);else{n!=null&&n.buildGraph&&We(e[o])&&(e[o]={});const s=e[o],u=!!(i.length>1&&i[1].match(/^\d+$/));s instanceof Array&&(n!=null&&n.descendArray)&&!u?s.forEach(c=>Bi(c,a,r,n)):Bi(s,a,r,n)}}function Km(e,t,r){Bi(e,t,(n,i)=>{n[i]=r},{buildGraph:!0})}function mu(e,t,r){Bi(e,t,(n,i)=>{if(n instanceof Array){if(/^\d+$/.test(i))n.splice(parseInt(i),1);else if(r&&r.descendArray)for(const o of n)Be(o)&&delete o[i]}else Be(n)&&delete n[i]},r)}const qm=/^\$[a-zA-Z0-9_]+$/;function on(e){return qm.test(e)}function El(e){if(_l.has(Ct(e).toLowerCase()))return yi(e)?{$regex:e}:{$eq:e};if(no(e)){if(!Object.keys(e).some(on))return{$eq:e};if(Ye(e,"$regex"))return{$regex:new RegExp(e.$regex,e.$options)}}return e}var zt;(function(e){e.CLONE_ALL="CLONE_ALL",e.CLONE_INPUT="CLONE_INPUT",e.CLONE_OUTPUT="CLONE_OUTPUT",e.CLONE_OFF="CLONE_OFF"})(zt||(zt={}));class Bn{constructor(t,r,n,i=Date.now()){ge(this,"options");ge(this,"_root");ge(this,"_local");ge(this,"timestamp");this.options=t,this._root=r,this._local=n,this.timestamp=i,this.options=t,this.update(r,n)}static init(t,r,n){return t instanceof Bn?t.update(We(t.root)?r:t.root,Object.assign({},t.local,n)):new Bn(t||ms(),r,n)}update(t,r){var n;return this._root=t,this._local=r&&Object.assign({},r,{variables:Object.assign({},(n=this._local)==null?void 0:n.variables,r==null?void 0:r.variables)}),this}get root(){return this._root}get local(){return this._local}get idKey(){var t;return(t=this.options)==null?void 0:t.idKey}get collation(){var t;return(t=this.options)==null?void 0:t.collation}get processingMode(){var t;return((t=this.options)==null?void 0:t.processingMode)||zt.CLONE_OFF}get useStrictMode(){var t;return(t=this.options)==null?void 0:t.useStrictMode}get scriptEnabled(){var t;return(t=this.options)==null?void 0:t.scriptEnabled}get hashFunction(){var t;return(t=this.options)==null?void 0:t.hashFunction}get collectionResolver(){var t;return(t=this.options)==null?void 0:t.collectionResolver}get jsonSchemaValidator(){var t;return(t=this.options)==null?void 0:t.jsonSchemaValidator}get variables(){var t;return(t=this.options)==null?void 0:t.variables}}function ms(e){return Object.freeze({idKey:"_id",scriptEnabled:!0,useStrictMode:!0,processingMode:zt.CLONE_OFF,...e})}var Me;(function(e){e.ACCUMULATOR="accumulator",e.EXPRESSION="expression",e.PIPELINE="pipeline",e.PROJECTION="projection",e.QUERY="query",e.WINDOW="window"})(Me||(Me={}));const ys={[Me.ACCUMULATOR]:{},[Me.EXPRESSION]:{},[Me.PIPELINE]:{},[Me.PROJECTION]:{},[Me.QUERY]:{},[Me.WINDOW]:{}};function yu(e,t){for(const[r,n]of Object.entries(t)){Qe(n instanceof Function&&on(r),`'${r}' is not a valid operator`);const i=Yr(e,r);Qe(!i||n===i,`${r} already exists for '${e}' operators. Cannot change operator function once registered.`)}Vr(ys[e],t)}function Yr(e,t){return ys[e][t]}const vu={$$ROOT(e,t,r){return r.root},$$CURRENT(e,t,r){return e},$$REMOVE(e,t,r){},$$NOW(e,t,r){return new Date(r.timestamp)}},la={$$KEEP(e,t,r){return e},$$PRUNE(e,t,r){},$$DESCEND(e,t,r){if(!Ye(t,"$cond"))return e;let n;for(const[i,o]of Object.entries(e))if(no(o)){if(o instanceof Array){const a=[];for(let s of o)Be(s)&&(s=gu(s,t,r.update(s))),We(s)||a.push(s);n=a}else n=gu(o,t,r.update(o));We(n)?delete e[i]:e[i]=n}return e}};function _t(e,t,r,n){var o;const i=Bn.init(n,e);if(on(r)){const a=Yr(Me.EXPRESSION,r);if(a)return a(e,t,i);const s=Yr(Me.ACCUMULATOR,r);if(s)return e instanceof Array||(e=_t(e,t,null,i),t=null),Qe(e instanceof Array,`'${r}' target must be an array.`),s(e,t,i.update(null,i.local));throw new Error(`operator '${r}' is not registered`)}if(Dt(t)&&t.length>0&&t[0]==="$"){if(Ye(la,t))return t;let a=i.root;const s=t.split(".");if(Ye(vu,s[0]))a=vu[s[0]](e,null,i),t=t.slice(s[0].length+1);else if(s[0].slice(0,2)==="$$"){a=Object.assign({},i.variables,{this:e},(o=i.local)==null?void 0:o.variables);const u=s[0].slice(2);Qe(Ye(a,u),`Use of undefined variable: ${u}`),t=t.slice(2)}else t=t.slice(1);return t===""?a:ps(a,t)}if(t instanceof Array)return t.map(a=>_t(e,a,null,i));if(Be(t)){const a={};for(const[s,u]of Object.entries(t))if(a[s]=_t(e,u,s,i),[Me.EXPRESSION,Me.ACCUMULATOR].some(c=>Ye(ys[c],s)))return Qe(Object.keys(t).length===1,"Invalid aggregation expression '"+JSON.stringify(t)+"'"),a[s];return a}return t}function gu(e,t,r){const n=_t(e,t,null,r);return Ye(la,n)?la[n](e,t,r):n}function Zr(e){return e instanceof bu?e:new bu(e)}function Wm(...e){let t=0;return Zr(()=>{for(;t<e.length;){const r=e[t].next();if(!r.done)return r;t++}return{done:!0}})}function Hm(e){return!!e&&typeof e=="object"&&(e==null?void 0:e.next)instanceof Function}function Gm(e,t){const r=e.slice(t+1);e.splice(t),Array.prototype.push.apply(e,r)}const fa=new Error;var ht;(function(e){e[e.MAP=0]="MAP",e[e.FILTER=1]="FILTER",e[e.TAKE=2]="TAKE",e[e.DROP=3]="DROP"})(ht||(ht={}));function Qm(e,t,r){let n=!1,i=-1,o=0;return function(a){try{e:for(;!n;){let s=e();i++;let u=-1;const c=t.length;let l=!1;for(;++u<c;){const f=t[u];switch(f.action){case ht.MAP:s=f.func(s,i);break;case ht.FILTER:if(!f.func(s,i))continue e;break;case ht.TAKE:--f.count,f.count||(l=!0);break;case ht.DROP:--f.count,f.count||Gm(t,u);continue e;default:break e}}if(n=l,a)r[o++]=s;else return{value:s,done:!1}}}catch(s){if(s!==fa)throw s}return n=!0,{done:n}}}class bu{constructor(t){ge(this,"iteratees",[]);ge(this,"yieldedValues",[]);ge(this,"getNext");ge(this,"isDone",!1);let r;if(t instanceof Function&&(t={next:t}),Hm(t)){const n=t;r=()=>{const i=n.next();if(i.done)throw fa;return i.value}}else if(t instanceof Array){const n=t,i=n.length;let o=0;r=()=>{if(o<i)return n[o++];throw fa}}else if(!(t instanceof Function))throw new Error(`Source is of type '${typeof t}'. Must be Array, Function, or Generator`);this.getNext=Qm(r,this.iteratees,this.yieldedValues)}push(t,r){return typeof r=="function"?this.iteratees.push({action:t,func:r}):typeof r=="number"&&this.iteratees.push({action:t,count:r}),this}next(){return this.getNext()}map(t){return this.push(ht.MAP,t)}filter(t){return this.push(ht.FILTER,t)}take(t){return t>0?this.push(ht.TAKE,t):this}drop(t){return t>0?this.push(ht.DROP,t):this}transform(t){const r=this;let n;return Zr(()=>(n||(n=Zr(t(r.value()))),n.next()))}value(){return this.isDone||(this.isDone=this.getNext(!0).done),this.yieldedValues}each(t){for(;;){const r=this.next();if(r.done)break;if(t(r.value)===!1)return!1}return!0}reduce(t,r){let n=this.next();for(r===void 0&&!n.done&&(r=n.value,n=this.next());!n.done;)r=t(r,n.value),n=this.next();return r}size(){return this.reduce((t,r)=>++t,0)}[Symbol.iterator](){return this}}class Vm{constructor(t,r){ge(this,"pipeline");ge(this,"options");this.pipeline=t,this.options=r,this.options=ms(r)}stream(t){let r=Zr(t);const n=this.options.processingMode;(n==zt.CLONE_ALL||n==zt.CLONE_INPUT)&&r.map(Mi);const i=[];if(!nn(this.pipeline))for(const o of this.pipeline){const a=Object.keys(o),s=a[0],u=Yr(Me.PIPELINE,s);Qe(a.length===1&&!!u,`invalid aggregation operator ${s}`),i.push(s),r=u(r,o[s],this.options)}return(n==zt.CLONE_OUTPUT||n==zt.CLONE_ALL&&kl([["$group","$unwind"],i]).length)&&r.map(Mi),r}run(t){return this.stream(t).value()}}class Ym{constructor(t,r,n,i){ge(this,"source");ge(this,"predicate");ge(this,"projection");ge(this,"options");ge(this,"operators",[]);ge(this,"result",null);ge(this,"buffer",[]);this.source=t,this.predicate=r,this.projection=n,this.options=i}fetch(){return this.result?this.result:(Be(this.projection)&&this.operators.push({$project:this.projection}),this.result=Zr(this.source).filter(this.predicate),this.operators.length>0&&(this.result=new Vm(this.operators,this.options).stream(this.result)),this.result)}fetchAll(){const t=Zr([...this.buffer]);return this.buffer=[],Wm(t,this.fetch())}all(){return this.fetchAll().value()}count(){return this.all().length}skip(t){return this.operators.push({$skip:t}),this}limit(t){return this.operators.push({$limit:t}),this}sort(t){return this.operators.push({$sort:t}),this}collation(t){return this.options={...this.options,collation:t},this}next(){if(this.buffer.length>0)return this.buffer.pop();const t=this.fetch().next();if(!t.done)return t.value}hasNext(){if(this.buffer.length>0)return!0;const t=this.fetch().next();return t.done?!1:(this.buffer.push(t.value),!0)}map(t){return this.all().map(t)}forEach(t){this.all().forEach(t)}[Symbol.iterator](){return this.fetchAll()}}class Gn{constructor(t,r){ge(this,"criteria");ge(this,"options");ge(this,"compiled");this.criteria=t,this.options=r,this.options=ms(r),this.compiled=[],this.compile()}compile(){Qe(Be(this.criteria),"query criteria must be an object");let t;for(const[r,n]of Object.entries(this.criteria)){if(r==="$where")t={field:r,expr:n};else if(Mn(["$and","$or","$nor","$expr","$jsonSchema"],r))this.processOperator(r,r,n);else{Qe(!on(r),`unknown top level operator: ${r}`);for(const[i,o]of Object.entries(El(n)))this.processOperator(r,i,o)}Be(t)&&this.processOperator(t.field,t.field,t.expr)}}processOperator(t,r,n){const i=Yr(Me.QUERY,r);Qe(!!i,`unknown operator ${r}`);const o=i(t,n,this.options);this.compiled.push(o)}test(t){for(let r=0,n=this.compiled.length;r<n;r++)if(!this.compiled[r](t))return!1;return!0}find(t,r){return new Ym(t,n=>this.test(n),r||{},this.options)}remove(t){return t.reduce((r,n)=>(this.test(n)||r.push(n),r),[])}}function Zm(e,t,r){if(nn(t))return e;let n=Object.keys(t),i=!1;Sl(t,r);const o=r.idKey;if(Mn(n,o)){const s=t[o];(s===0||s===!1)&&(n=n.filter(wl.bind(null,[o])),i=n.length==0)}else n.push(o);const a=Bn.init(r);return e.map(s=>ha(s,t,a.update(s),n,i))}function ha(e,t,r,n,i){let o={},a=!1,s=!1;const u=[];i&&u.push(r.idKey);for(const c of n){let l;const f=t[c];if(c!==r.idKey&&Mn([0,!1],f)&&(s=!0),c===r.idKey&&nn(f))l=e[c];else if(Dt(f))l=_t(e,f,c,r);else if(!Mn([1,!0],f))if(f instanceof Array)l=f.map(d=>{const y=_t(e,d,null,r);return We(y)?null:y});else if(Be(f)){const d=f,y=Object.keys(f),p=y.length==1?y[0]:null,b=Yr(Me.PROJECTION,p);if(b)p==="$slice"?Hn(d[p]).every($t)?(l=b(e,d[p],c),a=!0):l=_t(e,d,c,r):l=b(e,d[p],c,r);else if(on(p))l=_t(e,d[p],p,r);else if(Ye(e,c)){Sl(d,r);let m=e[c];m instanceof Array?l=m.map(g=>ha(g,d,r,y,!1)):(m=Be(m)?m:e,l=ha(m,d,r,y,!1))}else l=_t(e,f,null,r)}else{u.push(c);continue}const h=gi(e,c,{preserveMissing:!0});h!==void 0&&ia(o,h,{flatten:!0}),wl([0,1,!1,!0],f)&&(l===void 0?mu(o,c,{descendArray:!0}):Km(o,c,l))}if(ca(o),(a||s||i)&&(o=Vr({},e,o),u.length>0))for(const c of u)mu(o,c,{descendArray:!0});return o}function Sl(e,t){const r=[!1,!1];for(const[n,i]of Object.entries(e)){if(n===t.idKey)return;i===0||i===!1?r[0]=!0:(i===1||i===!0)&&(r[1]=!0),Qe(!(r[0]&&r[1]),"Projection cannot have a mix of inclusion and exclusion.")}}function Xm(e,t,r){if(nn(t)||!Be(t))return e;let n=Tn;const i=r.collation;return Be(i)&&Dt(i.locale)&&(n=ey(i)),e.transform(o=>{const a=Object.keys(t);for(const s of a.reverse()){const u=zm(o,f=>ps(f,s),r==null?void 0:r.hashFunction),c={},l=Lm(u.keys,(f,h)=>(c[f]=h,f),n);t[s]===-1&&l.reverse(),o=[];for(const f of l)Vr(o,u.groups[c[f]])}return o})}const Jm={1:"base",2:"accent",3:"variant"};function ey(e){const t={sensitivity:Jm[e.strength||3],caseFirst:e.caseFirst==="off"?"false":e.caseFirst||"false",numeric:e.numericOrdering||!1,ignorePunctuation:e.alternate==="shifted"};(e.caseLevel||!1)===!0&&(t.sensitivity==="base"&&(t.sensitivity="case"),t.sensitivity==="accent"&&(t.sensitivity="variant"));const r=new Intl.Collator(e.locale,t);return(n,i)=>{if(!Dt(n)||!Dt(i))return Tn(n,i);const o=r.compare(n,i);return o<0?-1:o>0?1:0}}function ty(e,t,r){Qe(At(t),"Invalid expression: $and expects value to be an Array");const n=new Array;return t.forEach(i=>n.push(new Gn(i,r))),i=>{for(let o=0;o<n.length;o++)if(!n[o].test(i))return!1;return!0}}function ry(e,t,r){const n={};n[e]=El(t);const i=new Gn(n,r);return o=>!i.test(o)}function Ol(e,t,r){Qe(At(t),"Invalid expression. $or expects value to be an Array");const n=t.map(i=>new Gn(i,r));return i=>{for(let o=0;o<n.length;o++)if(n[o].test(i))return!0;return!1}}function ny(e,t,r){Qe(At(t),"Invalid expression. $nor expects value to be an Array");const n=Ol("$or",t,r);return i=>!n(i)}function He(e){return(t,r,n)=>{const i={unwrapArray:!0},o=Math.max(1,t.split(".").length-1);return a=>{const s=ps(a,t,i);return e(s,r,{...n,depth:o})}}}function Cl(e,t,r){if(sa(e,t)||We(e)&&We(t))return!0;if(e instanceof Array){const n=sa.bind(null,t);return e.some(n)||xl(e,r==null?void 0:r.depth).some(n)}return!1}function iy(e,t,r){return!Cl(e,t,r)}function Dl(e,t,r){return We(e)?t.some(n=>n===null):kl([Hn(e),t],r==null?void 0:r.hashFunction).length>0}function oy(e,t,r){return!Dl(e,t,r)}function ay(e,t,r){return io(e,t,(n,i)=>n<i)}function sy(e,t,r){return io(e,t,(n,i)=>n<=i)}function uy(e,t,r){return io(e,t,(n,i)=>n>i)}function cy(e,t,r){return io(e,t,(n,i)=>n>=i)}function ly(e,t,r){return Hn(e).some(n=>t.length===2&&n%t[0]===t[1])}function fy(e,t,r){const n=Hn(e),i=o=>Dt(o)&&Fm(t.exec(o),r.useStrictMode);return n.some(i)||xl(n,1).some(i)}function hy(e,t,r){return(t===!1||t===0)&&e===void 0||(t===!0||t===1)&&e!==void 0}function dy(e,t,r){return Array.isArray(e)&&e.length===t}function py(e){return on(e)&&["$and","$or","$nor"].indexOf(e)===-1}function my(e,t,r){if(At(e)&&!nn(e)){let n=a=>a,i=t;Object.keys(t).every(py)&&(i={temp:t},n=a=>({temp:a}));const o=new Gn(i,r);for(let a=0,s=e.length;a<s;a++)if(o.test(n(e[a])))return!0}return!1}const _u=e=>e===null,wu=e=>$t(e)&&e>=Rm&&e<=Im&&e.toString().indexOf(".")===-1,ku=e=>$t(e)&&e>=Mm&&e<=Tm&&e.toString().indexOf(".")===-1,yy={array:At,bool:ko,boolean:ko,date:du,decimal:$t,double:$t,int:wu,long:ku,number:$t,null:_u,object:Be,regex:yi,regexp:yi,string:Dt,undefined:We,function:e=>{throw new Error("unsupported type key `function`.")},1:$t,2:Dt,3:Be,4:At,6:We,8:ko,9:du,10:_u,11:yi,16:wu,18:ku,19:$t};function xu(e,t,r){const n=yy[t];return n?n(e):!1}function vy(e,t,r){return Array.isArray(t)?t.findIndex(n=>xu(e,n))>=0:xu(e,t)}function io(e,t,r){return Hn(e).some(n=>Ct(n)===Ct(t)&&r(n,t))}const gy=He(Cl),by=He(iy),_y=He(uy),wy=He(cy),ky=He(ay),xy=He(sy),Ey=He(fy),Sy=He(ly),Oy=He(my),Cy=He(hy),Dy=He(oy),Ay=He(Dl),Py=He(dy),Iy=He(vy);var Eu=!1;function Ry(e){return Eu||(yu(Me.PIPELINE,{$sort:Xm,$project:Zm}),yu(Me.QUERY,{$and:ty,$eq:gy,$elemMatch:Oy,$exists:Cy,$gt:_y,$gte:wy,$in:Ay,$lt:ky,$lte:xy,$ne:by,$nin:Dy,$mod:Sy,$nor:ny,$not:ry,$or:Ol,$regex:Ey,$size:Py,$type:Iy}),Eu=!0),new Gn(e)}function da(e,t){var r=ot(e.primaryKey);t=Re(t),t.selector&&(t.selector=pa(t.selector));var n=$r(t);if(typeof n.skip!="number"&&(n.skip=0),n.selector?(n.selector=n.selector,Object.entries(n.selector).forEach(([c,l])=>{(typeof l!="object"||l===null)&&(n.selector[c]={$eq:l})})):n.selector={},n.index){var i=Xa(n.index);i.includes(r)||i.push(r),n.index=i}if(n.sort){var u=n.sort.find(c=>gd(c)===r);u||(n.sort=n.sort.slice(0),n.sort.push({[r]:"asc"}))}else if(n.index)n.sort=n.index.map(c=>({[c]:"asc"}));else{if(e.indexes){var o=new Set;Object.entries(n.selector).forEach(([c,l])=>{var f=!1;typeof l=="object"&&l!==null?f=!!Object.keys(l).find(h=>hs.has(h)):f=!0,f&&o.add(c)});var a=-1,s;e.indexes.forEach(c=>{var l=Br(c)?c:[c],f=l.findIndex(h=>!o.has(h));f>0&&f>a&&(a=f,s=l)}),s&&(n.sort=s.map(c=>({[c]:"asc"})))}n.sort||(n.sort=[{[r]:"asc"}])}return n}function pa(e){if(typeof e!="object"||e===null)return e;var t=Object.keys(e),r={};return t.forEach(n=>{var i=e[n];if(n==="$regex"&&i instanceof RegExp){var o=kd(i);r.$regex=o.pattern,r.$options=o.flags}else Array.isArray(i)?r[n]=i.map(a=>pa(a)):r[n]=pa(i)}),r}function Al(e,t){if(!t.sort)throw q("SNH",{query:t});var r=[];t.sort.forEach(i=>{var o=Object.keys(i)[0],a=Object.values(i)[0];r.push({key:o,direction:a,getValueFn:vd(o)})});var n=(i,o)=>{for(var a=0;a<r.length;++a){var s=r[a],u=s.getValueFn(i),c=s.getValueFn(o);if(u!==c){var l=s.direction==="asc"?Tn(u,c):Tn(c,u);return l}}};return n}function vs(e,t){if(!t.sort)throw q("SNH",{query:t});var r=Ry(t.selector),n=i=>{if(i._deleted)return!1;var o=r.find([i]),a=o.next();return!!a};return n}function Ty(e,t){return!t.sort||t.sort.length===0?[e]:t.sort.map(r=>Object.keys(r)[0])}var My=new WeakMap;function By(e){return hr(My,e,()=>{var t=e.collection,r=da(t.storageInstance.schema,$r(e.mangoQuery)),n=t.schema.primaryPath,i=Al(t.schema.jsonSchema,r),o=(c,l)=>{var f={docA:c,docB:l,rxQuery:e};return i(f.docA,f.docB)},a=vs(t.schema.jsonSchema,r),s=c=>{var l={doc:c,rxQuery:e};return a(l.doc)},u={primaryKey:e.collection.schema.primaryPath,skip:r.skip,limit:r.limit,sortFields:Ty(n,r),sortComparator:o,queryMatcher:s};return u})}function $y(e,t){if(!e.collection.database.eventReduce)return{runFullQueryAgain:!0};var r=By(e),n=_e(e._result).docsData.slice(0),i=_e(e._result).docsDataMap,o=!1,a=t.map(u=>yp(u)).filter(Gh),s=a.find(u=>{var c={queryParams:r,changeEvent:u,previousResults:n,keyDocumentMap:i},l=Em(c);if(l==="runFullQueryAgain")return!0;if(l!=="doNothing")return o=!0,Sm(l,r,u,n,i),!1});return s?{runFullQueryAgain:!0}:{runFullQueryAgain:!1,changed:o,newResults:n}}var Ny=function(){function e(){this._map=new Map}var t=e.prototype;return t.getByQuery=function(n){var i=n.toString();return hr(this._map,i,()=>n)},e}();function Fy(){return new Ny}function Su(e,t){t.uncached=!0;var r=t.toString();e._map.delete(r)}function jy(e){return e.refCount$.observers.length}var Ly=100,zy=30*1e3,Uy=(e,t)=>(r,n)=>{if(!(n._map.size<e)){var i=ze()-t,o=[],a=Array.from(n._map.values());for(var s of a)if(!(jy(s)>0)){if(s._lastEnsureEqual===0&&s._creationTime<i){Su(n,s);continue}o.push(s)}var u=o.length-e;if(!(u<=0)){var c=o.sort((f,h)=>f._lastEnsureEqual-h._lastEnsureEqual),l=c.slice(0,u);l.forEach(f=>Su(n,f))}}},Pl=Uy(Ly,zy),Eo=new WeakSet;function Ky(e){Eo.has(e)||(Eo.add(e),ud().then(()=>fd(200)).then(()=>{e.destroyed||e.cacheReplacementPolicy(e,e._queryCache),Eo.delete(e)}))}var qy=0,Wy=function(){return++qy},Il=function(){function e(r,n,i,o={}){this.id=Wy(),this._execOverDatabaseCount=0,this._creationTime=ze(),this._lastEnsureEqual=0,this.uncached=!1,this.refCount$=new dp(null),this._result=null,this._latestChangeEvent=-1,this._lastExecStart=0,this._lastExecEnd=0,this._ensureEqualQueue=Ft,this.op=r,this.mangoQuery=n,this.collection=i,this.other=o,n||(this.mangoQuery=bi()),this.isFindOneByIdQuery=Vy(this.collection.schema.primaryPath,n)}var t=e.prototype;return t._setResultData=function(n){if(typeof n=="number"){this._result={docsData:[],docsMap:new Map,docsDataMap:new Map,count:n,docs:[],time:ze()};return}else n instanceof Map&&(n=Array.from(n.values()));var i=new Map,o=new Map,a=n.map(u=>this.collection._docCache.getCachedRxDocument(u)),s=a.map(u=>(i.set(u.primary,u._data),o.set(u.primary,u),u._data));this._result={docsData:s,docsMap:o,docsDataMap:i,count:s.length,docs:a,time:ze()}},t._execOverDatabase=async function(){if(this._execOverDatabaseCount=this._execOverDatabaseCount+1,this._lastExecStart=ze(),this.op==="count"){var n=this.getPreparedQuery(),i=await this.collection.storageInstance.count(n);if(i.mode==="slow"&&!this.collection.database.allowSlowCount)throw q("QU14",{collection:this.collection,queryObj:this.mangoQuery});return i.count}if(this.op==="findByIds"){var o=_e(this.mangoQuery.selector)[this.collection.schema.primaryPath].$in,a=new Map,s=[];if(o.forEach(l=>{var f=this.collection._docCache.getLatestDocumentDataIfExists(l);if(f){if(!f._deleted){var h=this.collection._docCache.getCachedRxDocument(f);a.set(l,h)}}else s.push(l)}),s.length>0){var u=await this.collection.storageInstance.findDocumentsById(s,!1);Object.values(u).forEach(l=>{var f=this.collection._docCache.getCachedRxDocument(l);a.set(f.primary,f)})}return a}var c=Qy(this);return c.then(l=>(this._lastExecEnd=ze(),l))},t.exec=function(n){if(n&&this.op!=="findOne")throw q("QU9",{collection:this.collection.name,query:this.mangoQuery,op:this.op});return Ou(this).then(()=>Bp(this.$)).then(i=>{if(!i&&n)throw q("QU10",{collection:this.collection.name,query:this.mangoQuery,op:this.op});return i})},t.toString=function(){var n=Ri({op:this.op,query:this.mangoQuery,other:this.other},!0),i=JSON.stringify(n,bd);return this.toString=()=>i,i},t.getPreparedQuery=function(){var n={rxQuery:this,mangoQuery:da(this.collection.schema.jsonSchema,this.mangoQuery)};it("prePrepareQuery",n);var i=this.collection.database.storage.statics.prepareQuery(this.collection.schema.jsonSchema,n.mangoQuery);return this.getPreparedQuery=()=>i,i},t.doesDocumentDataMatch=function(n){return n._deleted?!1:this.queryMatcher(n)},t.remove=function(){return this.exec().then(n=>Array.isArray(n)?Promise.all(n.map(i=>i.remove())):n.remove())},t.update=function(n){throw ve("update")},t.where=function(n){throw ve("query-builder")},t.sort=function(n){throw ve("query-builder")},t.skip=function(n){throw ve("query-builder")},t.limit=function(n){throw ve("query-builder")},rn(e,[{key:"$",get:function(){if(!this._$){var r=this.collection.$.pipe(tt(n=>!n.isLocal),al(null),Kn(()=>Ou(this)),Lt(()=>this._result),ol(Bc),ra((n,i)=>!!(n&&n.time===_e(i).time)),tt(n=>!!n),Lt(n=>{var i=_e(n);return this.op==="count"?i.count:this.op==="findOne"?i.docs.length===0?null:i.docs[0]:this.op==="findByIds"?i.docsMap:i.docs.slice(0)}));this._$=$p(r,this.refCount$.pipe(tt(()=>!1)))}return this._$}},{key:"queryMatcher",get:function(){var r=this.collection.schema.jsonSchema,n=da(this.collection.schema.jsonSchema,this.mangoQuery);return di(this,"queryMatcher",vs(r,n))}},{key:"asRxQuery",get:function(){return this}}]),e}();function bi(){return{selector:{}}}function Hy(e){return e.collection._queryCache.getByQuery(e)}function fn(e,t,r,n){it("preCreateRxQuery",{op:e,queryObj:t,collection:r,other:n});var i=new Il(e,t,r,n);return i=Hy(i),Ky(r),i}function Rl(e){var t=e.asRxQuery.collection._changeEventBuffer.counter;return e._latestChangeEvent>=t}function Ou(e){return e.collection.database.destroyed||Rl(e)?Ft:(e._ensureEqualQueue=e._ensureEqualQueue.then(()=>Gy(e)),e._ensureEqualQueue)}function Gy(e){if(e._lastEnsureEqual=ze(),e.collection.database.destroyed||Rl(e))return Ft;var t=!1,r=!1;if(e._latestChangeEvent===-1&&(r=!0),!r){var n=e.asRxQuery.collection._changeEventBuffer.getFrom(e._latestChangeEvent+1);if(n===null)r=!0;else{e._latestChangeEvent=e.asRxQuery.collection._changeEventBuffer.counter;var i=e.asRxQuery.collection._changeEventBuffer.reduceByLastOfDoc(n);if(e.op==="count"){var o=_e(e._result).count,a=o;i.forEach(c=>{var l=c.previousDocumentData&&e.doesDocumentDataMatch(c.previousDocumentData),f=e.doesDocumentDataMatch(c.documentData);!l&&f&&a++,l&&!f&&a--}),a!==o&&(t=!0,e._setResultData(a))}else{var s=$y(e,i);s.runFullQueryAgain?r=!0:s.changed&&(t=!0,e._setResultData(s.newResults))}}}if(r){var u=e.collection._changeEventBuffer.counter;return e._execOverDatabase().then(c=>(e._latestChangeEvent=u,typeof c=="number"?((!e._result||c!==e._result.count)&&(t=!0,e._setResultData(c)),t):((!e._result||!Yh(e.collection.schema.primaryPath,c,e._result.docsData))&&(t=!0,e._setResultData(c)),t)))}return Promise.resolve(t)}async function Qy(e){var t=[],r=e.collection;if(e.isFindOneByIdQuery)if(Array.isArray(e.isFindOneByIdQuery)){var n=e.isFindOneByIdQuery;if(n=n.filter(l=>{var f=e.collection._docCache.getLatestDocumentDataIfExists(l);return f?(f._deleted||t.push(f),!1):!0}),n.length>0){var i=await r.storageInstance.findDocumentsById(n,!1);Object.values(i).forEach(l=>{t.push(l)})}}else{var o=e.isFindOneByIdQuery,a=e.collection._docCache.getLatestDocumentDataIfExists(o);if(!a){var s=await r.storageInstance.findDocumentsById([o],!1);a=s[o]}a&&!a._deleted&&t.push(a)}else{var u=e.getPreparedQuery(),c=await r.storageInstance.query(u);t=c.documents}return t}function Vy(e,t){if(!t.skip&&t.selector&&Object.keys(t.selector).length===1&&t.selector[e]){var r=t.selector[e];if(typeof r=="string")return r;if(Object.keys(r).length===1&&typeof r.$eq=="string"||Object.keys(r).length===1&&Array.isArray(r.$eq)&&!r.$eq.find(n=>typeof n!="string"))return r.$eq}return!1}var bn="collection",gs="storage-token",Yy="RxInternalDocument",bs=cl({version:0,title:Yy,primaryKey:{key:"id",fields:["context","key"],separator:"|"},type:"object",properties:{id:{type:"string",maxLength:200},key:{type:"string"},context:{type:"string",enum:[bn,gs,"OTHER"]},data:{type:"object",additionalProperties:!0}},indexes:[],required:["key","context","data"],additionalProperties:!1,sharding:{shards:1,mode:"collection"}});function ma(e,t){return as(bs,{key:e,context:t})}async function Tl(e,t){var r=e.prepareQuery(t.schema,{selector:{context:bn},sort:[{id:"asc"}],skip:0}),n=await t.query(r),i=n.documents;return i}var Ml="storageToken",ii=ma(Ml,gs);async function Zy(e){var t=eo(10),r=e.password?e.hashFunction(JSON.stringify(e.password)):void 0,n={id:ii,context:gs,key:Ml,data:{token:t,instanceToken:e.token,passwordHash:r},_deleted:!1,_meta:Xi(),_rev:Ji(),_attachments:{}},i=await e.internalStore.bulkWrite([{document:n}],"internal-add-storage-token");if(i.success[ii])return i.success[ii];var o=_e(i.error[ii]);if(o.isError&&o.status===409){var a=o;if(r&&r!==a.documentInDb.data.passwordHash)throw q("DB1",{passwordHash:r,existingPasswordHash:a.documentInDb.data.passwordHash});var s=a.documentInDb;return _e(s)}throw o}function Cu(e,t){return e+"-"+t.version}function So(e,t){return t=Re(t),t=bp(e,t),t=ul(e.primaryPath,e.jsonSchema,t),t._meta=Xi(),t.hasOwnProperty("_deleted")||(t._deleted=!1),t.hasOwnProperty("_attachments")||(t._attachments={}),t.hasOwnProperty("_rev")||(t._rev=Ji()),t}async function Xy(e,t){t.multiInstance=e.multiInstance;var r=await e.storage.createStorageInstance(t);return r}async function Bl(e,t,r,n,i,o){var a=await Tl(e.statics,t),s=a.filter(f=>f.data.name===i),u=[];s.forEach(f=>{u.push({collectionName:f.data.name,schema:f.data.schema,isCollection:!0}),f.data.connectedStorages.forEach(h=>u.push({collectionName:h.collectionName,isCollection:!1,schema:h.schema}))});var c=new Set;if(u=u.filter(f=>{var h=f.collectionName+"||"+f.schema.version;return c.has(h)?!1:(c.add(h),!0)}),await Promise.all(u.map(async f=>{var h=await e.createStorageInstance({collectionName:f.collectionName,databaseInstanceToken:r,databaseName:n,multiInstance:!1,options:{},schema:f.schema,devMode:Oe.isDevMode()});await h.remove(),f.isCollection&&await Un("postRemoveRxCollection",{storage:e,databaseName:n,collectionName:i})})),o){var l=s.map(f=>{var h=fl(f);return h._deleted=!0,h._meta.lwt=ze(),h._rev=Vo(r,f),{previous:f,document:h}});await t.bulkWrite(l,"rx-database-remove-collection-all")}}var Jy=function(){function e(r,n,i){this.cacheItemByDocId=new Map,this.registry=typeof FinalizationRegistry=="function"?new FinalizationRegistry(o=>{var a=o.docId,s=this.cacheItemByDocId.get(a);s&&(s.documentByRevisionHeight.delete(o.revisionHeight),s.documentByRevisionHeight.size===0&&this.cacheItemByDocId.delete(a))}):void 0,this.primaryPath=r,this.changes$=n,this.documentCreator=i,n.subscribe(o=>{var a=o.documentId,s=this.cacheItemByDocId.get(a);if(s){var u=sl(o);s.latestDoc=u}})}var t=e.prototype;return t.getCachedRxDocument=function(n){var i=n[this.primaryPath],o=Qh(n._rev),a=hr(this.cacheItemByDocId,i,()=>ev(n)),s=a.documentByRevisionHeight.get(o),u=s?s.deref():void 0;return u||(n=Oe.deepFreezeWhenDevMode(n),u=this.documentCreator(n),a.documentByRevisionHeight.set(o,rv(u)),this.registry&&this.registry.register(u,{docId:i,revisionHeight:o})),u},t.getLatestDocumentData=function(n){var i=An(this.cacheItemByDocId,n);return i.latestDoc},t.getLatestDocumentDataIfExists=function(n){var i=this.cacheItemByDocId.get(n);if(i)return i.latestDoc},e}();function ev(e){return{documentByRevisionHeight:new Map,latestDoc:e}}var tv=typeof WeakRef=="function";function rv(e){return tv?new WeakRef(e):{deref(){return e}}}var nv=function(){function e(r){this.subs=[],this.limit=100,this.counter=0,this.eventCounterMap=new WeakMap,this.buffer=[],this.collection=r,this.subs.push(this.collection.$.pipe(tt(n=>!n.isLocal)).subscribe(n=>this._handleChangeEvent(n)))}var t=e.prototype;return t._handleChangeEvent=function(n){for(this.counter++,this.buffer.push(n),this.eventCounterMap.set(n,this.counter);this.buffer.length>this.limit;)this.buffer.shift()},t.getArrayIndexByPointer=function(n){var i=this.buffer[0],o=this.eventCounterMap.get(i);if(n<o)return null;var a=n-o;return a},t.getFrom=function(n){var i=[],o=this.getArrayIndexByPointer(n);if(o===null)return null;for(;;){var a=this.buffer[o];if(o++,a)i.push(a);else return i}},t.runFrom=function(n,i){var o=this.getFrom(n);if(o===null)throw new Error("out of bounds");o.forEach(a=>i(a))},t.reduceByLastOfDoc=function(n){return n.slice(0)},t.destroy=function(){this.subs.forEach(n=>n.unsubscribe())},e}();function iv(e){return new nv(e)}var ov=new WeakMap;function av(e){var t=e.schema.getDocumentPrototype(),r=cv(e),n=qn,i={};return[t,r,n].forEach(o=>{var a=Object.getOwnPropertyNames(o);a.forEach(s=>{var u=Object.getOwnPropertyDescriptor(o,s),c=!0;(s.startsWith("_")||s.endsWith("_")||s.startsWith("$")||s.endsWith("$"))&&(c=!1),typeof u.value=="function"?Object.defineProperty(i,s,{get(){return u.value.bind(this)},enumerable:c,configurable:!1}):(u.enumerable=c,u.configurable=!1,u.writable&&(u.writable=!1),Object.defineProperty(i,s,u))})}),i}function sv(e){return hr(ov,e,()=>dl(av(e)))}function uv(e,t){var r=Ip(sv(e),e,Oe.deepFreezeWhenDevMode(t));return e._runHooksSync("post","create",t,r),it("postCreateRxDocument",r),r}function cv(e){var t={};return Object.entries(e.methods).forEach(([r,n])=>{t[r]=n}),t}var $l=function(e,t){return Dn(e.newDocumentState,e.realMasterState)?Promise.resolve({isEqual:!0}):Promise.resolve({isEqual:!1,documentData:e.realMasterState})},Nl=["pre","post"],Fl=["insert","save","remove","create"],Du=!1,_s=function(){function e(r,n,i,o,a={},s={},u={},c={},l={},f=Pl,h={},d=$l){this.storageInstance={},this.timeouts=new Set,this.incrementalWriteQueue={},this._incrementalUpsertQueues=new Map,this.synced=!1,this.hooks={},this._subs=[],this._docCache={},this._queryCache=Fy(),this.$={},this.checkpoint$={},this._changeEventBuffer={},this.onDestroy=[],this.destroyed=!1,this.database=r,this.name=n,this.schema=i,this.internalStorageInstance=o,this.instanceCreationOptions=a,this.migrationStrategies=s,this.methods=u,this.attachments=c,this.options=l,this.cacheReplacementPolicy=f,this.statics=h,this.conflictHandler=d,lv(this.asRxCollection)}var t=e.prototype;return t.prepare=async function(){this.storageInstance=hl(this.database,this.internalStorageInstance,this.schema.jsonSchema),this.incrementalWriteQueue=new Ap(this.storageInstance,this.schema.primaryPath,(a,s)=>ml(this,a,s),a=>this._runHooks("post","save",a));var n=this.database.eventBulks$.pipe(tt(a=>a.collectionName===this.name));this.$=n.pipe(Kn(a=>a.events)),this.checkpoint$=n.pipe(Lt(a=>a.checkpoint)),this._changeEventBuffer=iv(this.asRxCollection),this._docCache=new Jy(this.schema.primaryPath,this.$.pipe(tt(a=>!a.isLocal)),a=>uv(this.asRxCollection,a));var i=await this.database.storageToken,o=this.storageInstance.changeStream().subscribe(a=>{var s={id:a.id,internal:!1,collectionName:this.name,storageToken:i,events:a.events.map(u=>xp(!1,u,this)),databaseToken:this.database.token,checkpoint:a.checkpoint,context:a.context};this.database.$emit(s)});return this._subs.push(o),this._subs.push(this.storageInstance.conflictResultionTasks().subscribe(a=>{this.conflictHandler(a.input,a.context).then(s=>{this.storageInstance.resolveConflictResultionTask({id:a.id,output:s})})})),lt},t.migrationNeeded=function(){throw ve("migration")},t.getDataMigrator=function(){throw ve("migration")},t.migrate=function(n=10){return this.getDataMigrator().migrate(n)},t.migratePromise=function(n=10){return this.getDataMigrator().migratePromise(n)},t.insert=async function(n){var i=await this.bulkInsert([n]),o=i.error[0];na(this,n[this.schema.primaryPath],n,o);var a=_e(i.success[0]);return a},t.bulkInsert=async function(n){if(n.length===0)return{success:[],error:[]};var i=this.schema.primaryPath,o=n.map(f=>{var h=So(this.schema,f);return h}),a=this.hasHooks("pre","insert")?await Promise.all(o.map(f=>this._runHooks("pre","insert",f).then(()=>f))):o,s=new Map,u=a.map(f=>{s.set(f[i],f);var h={document:f};return h}),c=await this.storageInstance.bulkWrite(u,"rx-collection-bulk-insert"),l=Object.values(c.success).map(f=>this._docCache.getCachedRxDocument(f));return this.hasHooks("post","insert")&&await Promise.all(l.map(f=>this._runHooks("post","insert",s.get(f.primary),f))),{success:l,error:Object.values(c.error)}},t.bulkRemove=async function(n){if(n.length===0)return{success:[],error:[]};var i=await this.findByIds(n).exec(),o=[],a=new Map;Array.from(i.values()).forEach(f=>{var h=f.toMutableJSON(!0);o.push(h),a.set(f.primary,h)}),await Promise.all(o.map(f=>{var h=f[this.schema.primaryPath];return this._runHooks("pre","remove",f,i.get(h))}));var s=o.map(f=>{var h=Re(f);return h._deleted=!0,{previous:f,document:h}}),u=await this.storageInstance.bulkWrite(s,"rx-collection-bulk-remove"),c=Object.keys(u.success);await Promise.all(c.map(f=>this._runHooks("post","remove",a.get(f),i.get(f))));var l=c.map(f=>An(i,f));return{success:l,error:Object.values(u.error)}},t.bulkUpsert=async function(n){var i=[],o=new Map;n.forEach(c=>{var l=So(this.schema,c),f=l[this.schema.primaryPath];if(!f)throw q("COL3",{primaryPath:this.schema.primaryPath,data:l,schema:this.schema.jsonSchema});o.set(f,l),i.push(l)});var a=await this.bulkInsert(i),s=a.success.slice(0),u=await Promise.all(a.error.map(async c=>{if(c.status!==409)throw q("VD2",{collection:this.name,writeError:c});var l=c.documentId,f=An(o,l),h=_e(c.documentInDb),d=this._docCache.getCachedRxDocument(h),y=await d.incrementalModify(()=>f);return y}));return Zi(s,u),s},t.upsert=function(n){return this.bulkUpsert([n]).then(i=>i[0])},t.incrementalUpsert=function(n){var i=So(this.schema,n),o=i[this.schema.primaryPath];if(!o)throw q("COL4",{data:n});var a=this._incrementalUpsertQueues.get(o);return a||(a=lt),a=a.then(()=>hv(this,o,i)).then(s=>s.inserted?s.doc:fv(s.doc,i)),this._incrementalUpsertQueues.set(o,a),a},t.find=function(n){if(typeof n=="string")throw q("COL5",{queryObj:n});n||(n=bi());var i=fn("find",n,this);return i},t.findOne=function(n){var i;if(typeof n=="string")i=fn("findOne",{selector:{[this.schema.primaryPath]:n},limit:1},this);else{if(n||(n=bi()),n.limit)throw q("QU6");n.limit=1,i=fn("findOne",n,this)}if(typeof n=="number"||Array.isArray(n))throw Ze("COL6",{queryObj:n});return i},t.count=function(n){n||(n=bi());var i=fn("count",n,this);return i},t.findByIds=function(n){var i={selector:{[this.schema.primaryPath]:{$in:n.slice(0)}}},o=fn("findByIds",i,this);return o},t.exportJSON=function(){throw ve("json-dump")},t.importJSON=function(n){throw ve("json-dump")},t.insertCRDT=function(n){throw ve("crdt")},t.addHook=function(n,i,o,a=!1){if(typeof o!="function")throw Ze("COL7",{key:i,when:n});if(!Nl.includes(n))throw Ze("COL8",{key:i,when:n});if(!Fl.includes(i))throw q("COL9",{key:i});if(n==="post"&&i==="create"&&a===!0)throw q("COL10",{when:n,key:i,parallel:a});var s=o.bind(this),u=a?"parallel":"series";this.hooks[i]=this.hooks[i]||{},this.hooks[i][n]=this.hooks[i][n]||{series:[],parallel:[]},this.hooks[i][n][u].push(s)},t.getHooks=function(n,i){return!this.hooks[i]||!this.hooks[i][n]?{series:[],parallel:[]}:this.hooks[i][n]},t.hasHooks=function(n,i){var o=this.getHooks(n,i);return o?o.series.length>0||o.parallel.length>0:!1},t._runHooks=function(n,i,o,a){var s=this.getHooks(n,i);if(!s)return lt;var u=s.series.map(c=>()=>c(o,a));return hd(u).then(()=>Promise.all(s.parallel.map(c=>c(o,a))))},t._runHooksSync=function(n,i,o,a){var s=this.getHooks(n,i);s&&s.series.forEach(u=>u(o,a))},t.promiseWait=function(n){var i=new Promise(o=>{var a=setTimeout(()=>{this.timeouts.delete(a),o()},n);this.timeouts.add(a)});return i},t.destroy=function(){return this.destroyed?Ft:(this.destroyed=!0,Array.from(this.timeouts).forEach(n=>clearTimeout(n)),this._changeEventBuffer&&this._changeEventBuffer.destroy(),this.database.requestIdlePromise().then(()=>Promise.all(this.onDestroy.map(n=>n()))).then(()=>this.storageInstance.close()).then(()=>(this._subs.forEach(n=>n.unsubscribe()),delete this.database.collections[this.name],Un("postDestroyRxCollection",this).then(()=>!0))))},t.remove=async function(){await this.destroy(),await Bl(this.database.storage,this.database.internalStore,this.database.token,this.database.name,this.name,this.database.hashFunction)},rn(e,[{key:"insert$",get:function(){return this.$.pipe(tt(r=>r.operation==="INSERT"))}},{key:"update$",get:function(){return this.$.pipe(tt(r=>r.operation==="UPDATE"))}},{key:"remove$",get:function(){return this.$.pipe(tt(r=>r.operation==="DELETE"))}},{key:"asRxCollection",get:function(){return this}}]),e}();function lv(e){if(!Du){Du=!0;var t=Object.getPrototypeOf(e);Fl.forEach(r=>{Nl.map(n=>{var i=n+Rc(r);t[i]=function(o,a){return this.addHook(n,r,o,a)}})})}}function fv(e,t){return e.incrementalModify(r=>t)}function hv(e,t,r){var n=e._docCache.getLatestDocumentDataIfExists(t);return n?Promise.resolve({doc:e._docCache.getCachedRxDocument(n),inserted:!1}):e.findOne(t).exec().then(i=>i?{doc:i,inserted:!1}:e.insert(r).then(o=>({doc:o,inserted:!0})))}function dv({database:e,name:t,schema:r,instanceCreationOptions:n={},migrationStrategies:i={},autoMigrate:o=!0,statics:a={},methods:s={},attachments:u={},options:c={},localDocuments:l=!1,cacheReplacementPolicy:f=Pl,conflictHandler:h=$l}){var d={databaseInstanceToken:e.token,databaseName:e.name,collectionName:t,schema:r.jsonSchema,options:n,multiInstance:e.multiInstance,password:e.password,devMode:Oe.isDevMode()};return it("preCreateRxStorageInstance",d),Xy(e,d).then(y=>{var p=new _s(e,t,r,y,n,i,s,u,c,f,a,h);return p.prepare().then(()=>{Object.entries(a).forEach(([m,g])=>{Object.defineProperty(p,m,{get:()=>g.bind(p)})});var b=lt;return o&&p.schema.version!==0&&(b=p.migratePromise()),b}).then(()=>(it("createRxCollection",{collection:p,creator:{name:t,schema:r,storageInstance:y,instanceCreationOptions:n,migrationStrategies:i,methods:s,attachments:u,options:c,cacheReplacementPolicy:f,localDocuments:l,statics:a}}),p)).catch(b=>y.close().then(()=>Promise.reject(b)))})}var jl=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1;this._parallels=t||1,this._qC=0,this._iC=new Set,this._lHN=0,this._hPM=new Map,this._pHM=new Map};jl.prototype={isIdle:function(){return this._qC<this._parallels},lock:function(){this._qC++},unlock:function(){this._qC--,ya(this)},wrapCall:function(t){var r=this;this.lock();var n;try{n=t()}catch(i){throw this.unlock(),i}return!n.then||typeof n.then!="function"?(this.unlock(),n):n.then(function(i){return r.unlock(),i}).catch(function(i){throw r.unlock(),i})},requestIdlePromise:function(t){var r=this;t=t||{};var n,i=new Promise(function(s){return n=s}),o=function(){Oo(r,i),n()};if(i._manRes=o,t.timeout){var a=setTimeout(function(){i._manRes()},t.timeout);i._timeoutObj=a}return this._iC.add(i),ya(this),i},cancelIdlePromise:function(t){Oo(this,t)},requestIdleCallback:function(t,r){var n=this._lHN++,i=this.requestIdlePromise(r);return this._hPM.set(n,i),this._pHM.set(i,n),i.then(function(){return t()}),n},cancelIdleCallback:function(t){var r=this._hPM.get(t);this.cancelIdlePromise(r)},clear:function(){var t=this;this._iC.forEach(function(r){return Oo(t,r)}),this._qC=0,this._iC.clear(),this._hPM=new Map,this._pHM=new Map}};function pv(e){if(e._iC.size!==0){var t=e._iC.values(),r=t.next().value;r._manRes(),setTimeout(function(){return ya(e)},0)}}function Oo(e,t){if(t){if(t._timeoutObj&&clearTimeout(t._timeoutObj),e._pHM.has(t)){var r=e._pHM.get(t);e._hPM.delete(r),e._pHM.delete(t)}e._iC.delete(t)}}function ya(e){e._tryIR||e._iC.size===0||(e._tryIR=!0,setTimeout(function(){if(!e.isIdle()){e._tryIR=!1;return}setTimeout(function(){if(!e.isIdle()){e._tryIR=!1;return}pv(e),e._tryIR=!1},0)},0))}var ws=function(){function e(t){this.ttl=t,this.map=new Map,this._to=!1}return e.prototype.has=function(t){return this.map.has(t)},e.prototype.add=function(t){var r=this;this.map.set(t,Ll()),this._to||(this._to=!0,setTimeout(function(){r._to=!1,mv(r)},0))},e.prototype.clear=function(){this.map.clear()},e}();function mv(e){for(var t=Ll()-e.ttl,r=e.map[Symbol.iterator]();;){var n=r.next().value;if(!n)return;var i=n[0],o=n[1];if(o<t)e.map.delete(i);else return}}function Ll(){return new Date().getTime()}var $i=new Set,ks=function(){function e(r,n,i,o,a,s,u=!1,c={},l,f,h,d){this.idleQueue=new jl,this.storageInstances=new Set,this._subs=[],this.startupErrors=[],this.onDestroy=[],this.destroyed=!1,this.collections={},this.eventBulks$=new Ht,this.observable$=this.eventBulks$.pipe(Kn(y=>y.events)),this.storageToken=Ft,this.storageTokenDocument=Ft,this.emittedEventBulkIds=new ws(60*1e3),this.name=r,this.token=n,this.storage=i,this.instanceCreationOptions=o,this.password=a,this.multiInstance=s,this.eventReduce=u,this.options=c,this.internalStore=l,this.hashFunction=f,this.cleanupPolicy=h,this.allowSlowCount=d,this.name!=="pseudoInstance"&&(this.internalStore=hl(this.asRxDatabase,l,bs),this.storageTokenDocument=Zy(this.asRxDatabase).catch(y=>this.startupErrors.push(y)),this.storageToken=this.storageTokenDocument.then(y=>y.data.token).catch(y=>this.startupErrors.push(y)))}var t=e.prototype;return t.$emit=function(n){this.emittedEventBulkIds.has(n.id)||(this.emittedEventBulkIds.add(n.id),this.eventBulks$.next(n))},t.removeCollectionDoc=async function(n,i){var o=await kp(this.internalStore,ma(Cu(n,i),bn));if(!o)throw q("SNH",{name:n,schema:i});var a=fl(o);a._deleted=!0,await this.internalStore.bulkWrite([{document:a,previous:o}],"rx-database-remove-collection")},t.addCollections=async function(n){var i={},o={},a=[],s={};Object.entries(n).forEach(([l,f])=>{var h=l,d=f.schema;i[h]=d;var y=Mp(d,this.hashFunction);if(o[h]=y,this.collections[l])throw q("DB3",{name:l});var p=Cu(l,d),b={id:ma(p,bn),key:p,context:bn,data:{name:h,schemaHash:y.hash,schema:y.jsonSchema,version:y.version,connectedStorages:[]},_deleted:!1,_meta:Xi(),_rev:Ji(),_attachments:{}};a.push({document:b});var m=Object.assign({},f,{name:h,schema:y,database:this}),g=Re(f);g.database=this,g.name=l,it("preCreateRxCollection",g),m.conflictHandler=g.conflictHandler,s[h]=m});var u=await this.internalStore.bulkWrite(a,"rx-database-add-collection");await bv(this),Object.entries(u.error).forEach(([l,f])=>{if(f.status!==409)throw q("DB12",{database:this.name,writeError:f});var h=_e(f.documentInDb),d=h.data.name,y=o[d];if(h.data.schemaHash!==y.hash)throw q("DB6",{database:this.name,collection:d,previousSchemaHash:h.data.schemaHash,schemaHash:y.hash,previousSchema:h.data.schema,schema:_e(i[d])})});var c={};return await Promise.all(Object.keys(n).map(async l=>{var f=s[l],h=await dv(f);c[l]=h,this.collections[l]=h,this[l]||Object.defineProperty(this,l,{get:()=>this.collections[l]})})),c},t.lockedRun=function(n){return this.idleQueue.wrapCall(n)},t.requestIdlePromise=function(){return this.idleQueue.requestIdlePromise()},t.exportJSON=function(n){throw ve("json-dump")},t.importJSON=function(n){throw ve("json-dump")},t.backup=function(n){throw ve("backup")},t.leaderElector=function(){throw ve("leader-election")},t.isLeader=function(){throw ve("leader-election")},t.waitForLeadership=function(){throw ve("leader-election")},t.migrationStates=function(){throw ve("migration")},t.destroy=async function(){return this.destroyed||(this.destroyed=!0,await Un("preDestroyRxDatabase",this),this.eventBulks$.complete(),this._subs.map(n=>n.unsubscribe()),this.name==="pseudoInstance")?Ft:this.requestIdlePromise().then(()=>Promise.all(this.onDestroy.map(n=>n()))).then(()=>Promise.all(Object.keys(this.collections).map(n=>this.collections[n]).map(n=>n.destroy()))).then(()=>this.internalStore.close()).then(()=>$i.delete(this.name)).then(()=>!0)},t.remove=function(){return this.destroy().then(()=>gv(this.name,this.storage))},rn(e,[{key:"$",get:function(){return this.observable$}},{key:"asRxDatabase",get:function(){return this}}]),e}();function yv(e){if($i.has(e))throw q("DB8",{name:e,link:"https://pubkey.github.io/rxdb/rx-database.html#ignoreduplicate"})}async function zl(e,t,r,n,i,o){var a=await t.createStorageInstance({databaseInstanceToken:e,databaseName:r,collectionName:wp,schema:bs,options:n,multiInstance:i,password:o,devMode:Oe.isDevMode()});return a}function vv({storage:e,instanceCreationOptions:t,name:r,password:n,multiInstance:i=!0,eventReduce:o=!1,ignoreDuplicate:a=!1,options:s={},cleanupPolicy:u,allowSlowCount:c=!1,localDocuments:l=!1,hashFunction:f=gn}){it("preCreateRxDatabase",{storage:e,instanceCreationOptions:t,name:r,password:n,multiInstance:i,eventReduce:o,ignoreDuplicate:a,options:s,localDocuments:l}),a||yv(r),$i.add(r);var h=eo(10);return zl(h,e,r,t,i,n).catch(d=>{throw $i.delete(r),d}).then(d=>{var y=new ks(r,h,e,t,n,i,o,s,d,f,u,c);return Un("createRxDatabase",{database:y,creator:{storage:e,instanceCreationOptions:t,name:r,password:n,multiInstance:i,eventReduce:o,ignoreDuplicate:a,options:s,localDocuments:l}}).then(()=>y)})}async function gv(e,t){var r=eo(10),n=await zl(r,t,e,{},!1),i=await Tl(t.statics,n),o=new Set;i.forEach(s=>o.add(s.data.name));var a=Array.from(o);return await Promise.all(a.map(s=>Bl(t,n,r,e,s))),await Un("postRemoveRxDatabase",{databaseName:e,storage:t}),await n.remove(),a}async function bv(e){if(await e.storageToken,e.startupErrors[0])throw e.startupErrors[0]}var _v={RxSchema:yl.prototype,RxDocument:qn,RxQuery:Il.prototype,RxCollection:_s.prototype,RxDatabase:ks.prototype},Co=new Set,Au=new Set;function Ul(e){if(it("preAddRxPlugin",{plugin:e,plugins:Co}),!Co.has(e)){{if(Au.has(e.name))throw q("PL3",{name:e.name,plugin:e});Co.add(e),Au.add(e.name)}if(!e.rxdb)throw Ze("PL1",{plugin:e});e.init&&e.init(),e.prototypes&&Object.entries(e.prototypes).forEach(([t,r])=>r(_v[t])),e.overwritable&&Object.assign(Oe,e.overwritable),e.hooks&&Object.entries(e.hooks).forEach(([t,r])=>{r.after&&In[t].push(r.after),r.before&&In[t].unshift(r.before)})}}var wv={prepareQuery(e,t){if(!t.sort)throw q("SNH",{query:t});var r=Om(e,t);return{query:t,queryPlan:r}},checkpointSchema:_p};function kv(e){return e&&typeof e.then=="function"}Promise.resolve(!1);Promise.resolve(!0);var ar=Promise.resolve();function Kl(e,t){return e||(e=0),new Promise(function(r){return setTimeout(function(){return r(t)},e)})}function xv(e,t){return Math.floor(Math.random()*(t-e+1)+e)}function xs(){return Math.random().toString(36).substring(2)}var Pu=0,Do=0;function oo(){var e=new Date().getTime();return e===Pu?(Do++,e*1e3+Do):(Pu=e,Do=0,e*1e3)}var Ev=oo,Sv="native";function Ov(e){var t={messagesCallback:null,bc:new BroadcastChannel(e),subFns:[]};return t.bc.onmessage=function(r){t.messagesCallback&&t.messagesCallback(r.data)},t}function Cv(e){e.bc.close(),e.subFns=[]}function Dv(e,t){try{return e.bc.postMessage(t,!1),ar}catch(r){return Promise.reject(r)}}function Av(e,t){e.messagesCallback=t}function Pv(){if((typeof window<"u"||typeof self<"u")&&typeof BroadcastChannel=="function"){if(BroadcastChannel._pubkey)throw new Error("BroadcastChannel: Do not overwrite window.BroadcastChannel with this module, this is not a polyfill");return!0}else return!1}function Iv(){return 150}var Rv={create:Ov,close:Cv,onMessage:Av,postMessage:Dv,canBeUsed:Pv,type:Sv,averageResponseTime:Iv,microSeconds:Ev};function Es(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=JSON.parse(JSON.stringify(e));return typeof t.webWorkerSupport>"u"&&(t.webWorkerSupport=!0),t.idb||(t.idb={}),t.idb.ttl||(t.idb.ttl=1e3*45),t.idb.fallbackInterval||(t.idb.fallbackInterval=150),e.idb&&typeof e.idb.onclose=="function"&&(t.idb.onclose=e.idb.onclose),t.localstorage||(t.localstorage={}),t.localstorage.removeTimeout||(t.localstorage.removeTimeout=1e3*60),e.methods&&(t.methods=e.methods),t.node||(t.node={}),t.node.ttl||(t.node.ttl=1e3*60*2),t.node.maxParallelWrites||(t.node.maxParallelWrites=2048),typeof t.node.useFastPath>"u"&&(t.node.useFastPath=!0),t}var Tv=oo,Mv="pubkey.broadcast-channel-0-",Pt="messages",ao={durability:"relaxed"},Bv="idb";function ql(){if(typeof indexedDB<"u")return indexedDB;if(typeof window<"u"){if(typeof window.mozIndexedDB<"u")return window.mozIndexedDB;if(typeof window.webkitIndexedDB<"u")return window.webkitIndexedDB;if(typeof window.msIndexedDB<"u")return window.msIndexedDB}return!1}function Ss(e){e.commit&&e.commit()}function $v(e){var t=ql(),r=Mv+e,n=t.open(r);return n.onupgradeneeded=function(i){var o=i.target.result;o.createObjectStore(Pt,{keyPath:"id",autoIncrement:!0})},new Promise(function(i,o){n.onerror=function(a){return o(a)},n.onsuccess=function(){i(n.result)}})}function Nv(e,t,r){var n=new Date().getTime(),i={uuid:t,time:n,data:r},o=e.transaction([Pt],"readwrite",ao);return new Promise(function(a,s){o.oncomplete=function(){return a()},o.onerror=function(c){return s(c)};var u=o.objectStore(Pt);u.add(i),Ss(o)})}function Fv(e,t){var r=e.transaction(Pt,"readonly",ao),n=r.objectStore(Pt),i=[],o=IDBKeyRange.bound(t+1,1/0);if(n.getAll){var a=n.getAll(o);return new Promise(function(u,c){a.onerror=function(l){return c(l)},a.onsuccess=function(l){u(l.target.result)}})}function s(){try{return o=IDBKeyRange.bound(t+1,1/0),n.openCursor(o)}catch{return n.openCursor()}}return new Promise(function(u,c){var l=s();l.onerror=function(f){return c(f)},l.onsuccess=function(f){var h=f.target.result;h?h.value.id<t+1?h.continue(t+1):(i.push(h.value),h.continue()):(Ss(r),u(i))}})}function jv(e,t){if(e.closed)return Promise.resolve([]);var r=e.db.transaction(Pt,"readwrite",ao),n=r.objectStore(Pt);return Promise.all(t.map(function(i){var o=n.delete(i);return new Promise(function(a){o.onsuccess=function(){return a()}})}))}function Lv(e,t){var r=new Date().getTime()-t,n=e.transaction(Pt,"readonly",ao),i=n.objectStore(Pt),o=[];return new Promise(function(a){i.openCursor().onsuccess=function(s){var u=s.target.result;if(u){var c=u.value;c.time<r?(o.push(c),u.continue()):(Ss(n),a(o))}else a(o)}})}function zv(e){return Lv(e.db,e.options.idb.ttl).then(function(t){return jv(e,t.map(function(r){return r.id}))})}function Uv(e,t){return t=Es(t),$v(e).then(function(r){var n={closed:!1,lastCursorId:0,channelName:e,options:t,uuid:xs(),eMIs:new ws(t.idb.ttl*2),writeBlockPromise:ar,messagesCallback:null,readQueuePromises:[],db:r};return r.onclose=function(){n.closed=!0,t.idb.onclose&&t.idb.onclose()},Wl(n),n})}function Wl(e){e.closed||Hl(e).then(function(){return Kl(e.options.idb.fallbackInterval)}).then(function(){return Wl(e)})}function Kv(e,t){return!(e.uuid===t.uuid||t.eMIs.has(e.id)||e.data.time<t.messagesCallbackTime)}function Hl(e){return e.closed||!e.messagesCallback?ar:Fv(e.db,e.lastCursorId).then(function(t){var r=t.filter(function(n){return!!n}).map(function(n){return n.id>e.lastCursorId&&(e.lastCursorId=n.id),n}).filter(function(n){return Kv(n,e)}).sort(function(n,i){return n.time-i.time});return r.forEach(function(n){e.messagesCallback&&(e.eMIs.add(n.id),e.messagesCallback(n.data))}),ar})}function qv(e){e.closed=!0,e.db.close()}function Wv(e,t){return e.writeBlockPromise=e.writeBlockPromise.then(function(){return Nv(e.db,e.uuid,t)}).then(function(){xv(0,10)===0&&zv(e)}),e.writeBlockPromise}function Hv(e,t,r){e.messagesCallbackTime=r,e.messagesCallback=t,Hl(e)}function Gv(){return!!ql()}function Qv(e){return e.idb.fallbackInterval*2}var Vv={create:Uv,close:qv,onMessage:Hv,postMessage:Wv,canBeUsed:Gv,type:Bv,averageResponseTime:Qv,microSeconds:Tv},Yv=oo,Zv="pubkey.broadcastChannel-",Xv="localstorage";function Gl(){var e;if(typeof window>"u")return null;try{e=window.localStorage,e=window["ie8-eventlistener/storage"]||window.localStorage}catch{}return e}function Ql(e){return Zv+e}function Jv(e,t){return new Promise(function(r){Kl().then(function(){var n=Ql(e.channelName),i={token:xs(),time:new Date().getTime(),data:t,uuid:e.uuid},o=JSON.stringify(i);Gl().setItem(n,o);var a=document.createEvent("Event");a.initEvent("storage",!0,!0),a.key=n,a.newValue=o,window.dispatchEvent(a),r()})})}function eg(e,t){var r=Ql(e),n=function(o){o.key===r&&t(JSON.parse(o.newValue))};return window.addEventListener("storage",n),n}function tg(e){window.removeEventListener("storage",e)}function rg(e,t){if(t=Es(t),!Vl())throw new Error("BroadcastChannel: localstorage cannot be used");var r=xs(),n=new ws(t.localstorage.removeTimeout),i={channelName:e,uuid:r,eMIs:n};return i.listener=eg(e,function(o){i.messagesCallback&&o.uuid!==r&&(!o.token||n.has(o.token)||o.data.time&&o.data.time<i.messagesCallbackTime||(n.add(o.token),i.messagesCallback(o.data)))}),i}function ng(e){tg(e.listener)}function ig(e,t,r){e.messagesCallbackTime=r,e.messagesCallback=t}function Vl(){var e=Gl();if(!e)return!1;try{var t="__broadcastchannel_check";e.setItem(t,"works"),e.removeItem(t)}catch{return!1}return!0}function og(){var e=120,t=navigator.userAgent.toLowerCase();return t.includes("safari")&&!t.includes("chrome")?e*2:e}var ag={create:rg,close:ng,onMessage:ig,postMessage:Jv,canBeUsed:Vl,type:Xv,averageResponseTime:og,microSeconds:Yv},sg=oo,ug="simulate",Os=new Set;function cg(e){var t={name:e,messagesCallback:null};return Os.add(t),t}function lg(e){Os.delete(e)}function fg(e,t){return new Promise(function(r){return setTimeout(function(){var n=Array.from(Os);n.filter(function(i){return i.name===e.name}).filter(function(i){return i!==e}).filter(function(i){return!!i.messagesCallback}).forEach(function(i){return i.messagesCallback(t)}),r()},5)})}function hg(e,t){e.messagesCallback=t}function dg(){return!0}function pg(){return 5}var mg={create:cg,close:lg,onMessage:hg,postMessage:fg,canBeUsed:dg,type:ug,averageResponseTime:pg,microSeconds:sg},Iu=[Rv,Vv,ag];function yg(e){var t=[].concat(e.methods,Iu).filter(Boolean);if(e.type){if(e.type==="simulate")return mg;var r=t.find(function(i){return i.type===e.type});if(r)return r;throw new Error("method-type "+e.type+" not found")}e.webWorkerSupport||(t=t.filter(function(i){return i.type!=="idb"}));var n=t.find(function(i){return i.canBeUsed()});if(n)return n;throw new Error("No usable method found in "+JSON.stringify(Iu.map(function(i){return i.type})))}var Yl=new Set,vg=0,Cs=function(t,r){this.id=vg++,Yl.add(this),this.name=t,Ru&&(r=Ru),this.options=Es(r),this.method=yg(this.options),this._iL=!1,this._onML=null,this._addEL={message:[],internal:[]},this._uMP=new Set,this._befC=[],this._prepP=null,gg(this)};Cs._pubkey=!0;var Ru;Cs.prototype={postMessage:function(t){if(this.closed)throw new Error("BroadcastChannel.postMessage(): Cannot post message after channel has closed "+JSON.stringify(t));return Tu(this,"message",t)},postInternal:function(t){return Tu(this,"internal",t)},set onmessage(e){var t=this.method.microSeconds(),r={time:t,fn:e};Bu(this,"message",this._onML),e&&typeof e=="function"?(this._onML=r,Mu(this,"message",r)):this._onML=null},addEventListener:function(t,r){var n=this.method.microSeconds(),i={time:n,fn:r};Mu(this,t,i)},removeEventListener:function(t,r){var n=this._addEL[t].find(function(i){return i.fn===r});Bu(this,t,n)},close:function(){var t=this;if(!this.closed){Yl.delete(this),this.closed=!0;var r=this._prepP?this._prepP:ar;return this._onML=null,this._addEL.message=[],r.then(function(){return Promise.all(Array.from(t._uMP))}).then(function(){return Promise.all(t._befC.map(function(n){return n()}))}).then(function(){return t.method.close(t._state)})}},get type(){return this.method.type},get isClosed(){return this.closed}};function Tu(e,t,r){var n=e.method.microSeconds(),i={time:n,type:t,data:r},o=e._prepP?e._prepP:ar;return o.then(function(){var a=e.method.postMessage(e._state,i);return e._uMP.add(a),a.catch().then(function(){return e._uMP.delete(a)}),a})}function gg(e){var t=e.method.create(e.name,e.options);kv(t)?(e._prepP=t,t.then(function(r){e._state=r})):e._state=t}function Zl(e){return e._addEL.message.length>0||e._addEL.internal.length>0}function Mu(e,t,r){e._addEL[t].push(r),bg(e)}function Bu(e,t,r){e._addEL[t]=e._addEL[t].filter(function(n){return n!==r}),_g(e)}function bg(e){if(!e._iL&&Zl(e)){var t=function(i){e._addEL[i.type].forEach(function(o){var a=1e5,s=o.time-a;i.time>=s&&o.fn(i.data)})},r=e.method.microSeconds();e._prepP?e._prepP.then(function(){e._iL=!0,e.method.onMessage(e._state,t,r)}):(e._iL=!0,e.method.onMessage(e._state,t,r))}}function _g(e){if(e._iL&&!Zl(e)){e._iL=!1;var t=e.method.microSeconds();e.method.onMessage(e._state,null,t)}}var Ni=new Map;function wg(e,t,r){var n=Ni.get(e);return n||(n={bc:new Cs("RxDB:"+t),refs:new Set},Ni.set(e,n)),n.refs.add(r),n.bc}function $u(e,t){var r=Ni.get(e);if(r&&(r.refs.delete(t),r.refs.size===0))return Ni.delete(e),r.bc.close()}function kg(e,t,r,n){if(t.multiInstance){var i=n||wg(t.databaseInstanceToken,r.databaseName,r),o=new Ht,a=h=>{h.storageName===e&&h.databaseName===t.databaseName&&h.collectionName===t.collectionName&&h.version===t.schema.version&&o.next(h.eventBulk)};i.addEventListener("message",a);var s=r.changeStream(),u=!1,c=s.subscribe(h=>{u||i.postMessage({storageName:e,databaseName:t.databaseName,collectionName:t.collectionName,version:t.schema.version,eventBulk:h})});r.changeStream=function(){return o.asObservable().pipe(hp(s))};var l=r.close.bind(r);r.close=async function(){return u=!0,c.unsubscribe(),i.removeEventListener("message",a),n||await $u(t.databaseInstanceToken,r),l()};var f=r.remove.bind(r);r.remove=async function(){return u=!0,c.unsubscribe(),i.removeEventListener("message",a),n||await $u(t.databaseInstanceToken,r),f()}}}const me=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Se=Object.keys,Fe=Array.isArray;function Ke(e,t){return typeof t!="object"||Se(t).forEach(function(r){e[r]=t[r]}),e}typeof Promise>"u"||me.Promise||(me.Promise=Promise);const Xr=Object.getPrototypeOf,xg={}.hasOwnProperty;function Je(e,t){return xg.call(e,t)}function Jr(e,t){typeof t=="function"&&(t=t(Xr(e))),(typeof Reflect>"u"?Se:Reflect.ownKeys)(t).forEach(r=>{St(e,r,t[r])})}const Xl=Object.defineProperty;function St(e,t,r,n){Xl(e,t,Ke(r&&Je(r,"get")&&typeof r.get=="function"?{get:r.get,set:r.set,configurable:!0}:{value:r,configurable:!0,writable:!0},n))}function jr(e){return{from:function(t){return e.prototype=Object.create(t.prototype),St(e.prototype,"constructor",e),{extend:Jr.bind(null,e.prototype)}}}}const Eg=Object.getOwnPropertyDescriptor;function Ds(e,t){let r;return Eg(e,t)||(r=Xr(e))&&Ds(r,t)}const Sg=[].slice;function Fi(e,t,r){return Sg.call(e,t,r)}function Jl(e,t){return t(e)}function yn(e){if(!e)throw new Error("Assertion Failed")}function ef(e){me.setImmediate?setImmediate(e):setTimeout(e,0)}function tf(e,t){return e.reduce((r,n,i)=>{var o=t(n,i);return o&&(r[o[0]]=o[1]),r},{})}function Ot(e,t){if(Je(e,t))return e[t];if(!t)return e;if(typeof t!="string"){for(var r=[],n=0,i=t.length;n<i;++n){var o=Ot(e,t[n]);r.push(o)}return r}var a=t.indexOf(".");if(a!==-1){var s=e[t.substr(0,a)];return s===void 0?void 0:Ot(s,t.substr(a+1))}}function nt(e,t,r){if(e&&t!==void 0&&(!("isFrozen"in Object)||!Object.isFrozen(e)))if(typeof t!="string"&&"length"in t){yn(typeof r!="string"&&"length"in r);for(var n=0,i=t.length;n<i;++n)nt(e,t[n],r[n])}else{var o=t.indexOf(".");if(o!==-1){var a=t.substr(0,o),s=t.substr(o+1);if(s==="")r===void 0?Fe(e)&&!isNaN(parseInt(a))?e.splice(a,1):delete e[a]:e[a]=r;else{var u=e[a];u&&Je(e,a)||(u=e[a]={}),nt(u,s,r)}}else r===void 0?Fe(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=r}}function rf(e){var t={};for(var r in e)Je(e,r)&&(t[r]=e[r]);return t}const Og=[].concat;function nf(e){return Og.apply([],e)}const of="Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(nf([8,16,32,64].map(e=>["Int","Uint","Float"].map(t=>t+e+"Array")))).filter(e=>me[e]),Cg=of.map(e=>me[e]);tf(of,e=>[e,!0]);let Mt=null;function Qn(e){Mt=typeof WeakMap<"u"&&new WeakMap;const t=va(e);return Mt=null,t}function va(e){if(!e||typeof e!="object")return e;let t=Mt&&Mt.get(e);if(t)return t;if(Fe(e)){t=[],Mt&&Mt.set(e,t);for(var r=0,n=e.length;r<n;++r)t.push(va(e[r]))}else if(Cg.indexOf(e.constructor)>=0)t=e;else{const o=Xr(e);for(var i in t=o===Object.prototype?{}:Object.create(o),Mt&&Mt.set(e,t),e)Je(e,i)&&(t[i]=va(e[i]))}return t}const{toString:Dg}={};function ga(e){return Dg.call(e).slice(8,-1)}const ba=typeof Symbol<"u"?Symbol.iterator:"@@iterator",Ag=typeof ba=="symbol"?function(e){var t;return e!=null&&(t=e[ba])&&t.apply(e)}:function(){return null},Dr={};function wt(e){var t,r,n,i;if(arguments.length===1){if(Fe(e))return e.slice();if(this===Dr&&typeof e=="string")return[e];if(i=Ag(e)){for(r=[];!(n=i.next()).done;)r.push(n.value);return r}if(e==null)return[e];if(typeof(t=e.length)=="number"){for(r=new Array(t);t--;)r[t]=e[t];return r}return[e]}for(t=arguments.length,r=new Array(t);t--;)r[t]=arguments[t];return r}const As=typeof Symbol<"u"?e=>e[Symbol.toStringTag]==="AsyncFunction":()=>!1;var pt=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function af(e,t){pt=e,sf=t}var sf=()=>!0;const Pg=!new Error("").stack;function wr(){if(Pg)try{throw wr.arguments,new Error}catch(e){return e}return new Error}function _a(e,t){var r=e.stack;return r?(t=t||0,r.indexOf(e.name)===0&&(t+=(e.name+e.message).split(`
`).length),r.split(`
`).slice(t).filter(sf).map(n=>`
`+n).join("")):""}var uf=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Ps=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(uf),Ig={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Lr(e,t){this._e=wr(),this.name=e,this.message=t}function cf(e,t){return e+". Errors: "+Object.keys(t).map(r=>t[r].toString()).filter((r,n,i)=>i.indexOf(r)===n).join(`
`)}function ji(e,t,r,n){this._e=wr(),this.failures=t,this.failedKeys=n,this.successCount=r,this.message=cf(e,t)}function _n(e,t){this._e=wr(),this.name="BulkError",this.failures=Object.keys(t).map(r=>t[r]),this.failuresByPos=t,this.message=cf(e,t)}jr(Lr).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+_a(this._e,2))}},toString:function(){return this.name+": "+this.message}}),jr(ji).from(Lr),jr(_n).from(Lr);var Is=Ps.reduce((e,t)=>(e[t]=t+"Error",e),{});const Rg=Lr;var oe=Ps.reduce((e,t)=>{var r=t+"Error";function n(i,o){this._e=wr(),this.name=r,i?typeof i=="string"?(this.message=`${i}${o?`
 `+o:""}`,this.inner=o||null):typeof i=="object"&&(this.message=`${i.name} ${i.message}`,this.inner=i):(this.message=Ig[t]||r,this.inner=null)}return jr(n).from(Rg),e[t]=n,e},{});oe.Syntax=SyntaxError,oe.Type=TypeError,oe.Range=RangeError;var Nu=uf.reduce((e,t)=>(e[t+"Error"]=oe[t],e),{}),_i=Ps.reduce((e,t)=>(["Syntax","Type","Range"].indexOf(t)===-1&&(e[t+"Error"]=oe[t]),e),{});function he(){}function $n(e){return e}function Tg(e,t){return e==null||e===$n?t:function(r){return t(e(r))}}function mr(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function Mg(e,t){return e===he?t:function(){var r=e.apply(this,arguments);r!==void 0&&(arguments[0]=r);var n=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var o=t.apply(this,arguments);return n&&(this.onsuccess=this.onsuccess?mr(n,this.onsuccess):n),i&&(this.onerror=this.onerror?mr(i,this.onerror):i),o!==void 0?o:r}}function Bg(e,t){return e===he?t:function(){e.apply(this,arguments);var r=this.onsuccess,n=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),r&&(this.onsuccess=this.onsuccess?mr(r,this.onsuccess):r),n&&(this.onerror=this.onerror?mr(n,this.onerror):n)}}function $g(e,t){return e===he?t:function(r){var n=e.apply(this,arguments);Ke(r,n);var i=this.onsuccess,o=this.onerror;this.onsuccess=null,this.onerror=null;var a=t.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?mr(i,this.onsuccess):i),o&&(this.onerror=this.onerror?mr(o,this.onerror):o),n===void 0?a===void 0?void 0:a:Ke(n,a)}}function Ng(e,t){return e===he?t:function(){return t.apply(this,arguments)!==!1&&e.apply(this,arguments)}}function Rs(e,t){return e===he?t:function(){var r=e.apply(this,arguments);if(r&&typeof r.then=="function"){for(var n=this,i=arguments.length,o=new Array(i);i--;)o[i]=arguments[i];return r.then(function(){return t.apply(n,o)})}return t.apply(this,arguments)}}_i.ModifyError=ji,_i.DexieError=Lr,_i.BulkError=_n;var Nn={};const[wa,Li,ka]=typeof Promise>"u"?[]:(()=>{let e=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[e,Xr(e),e];const t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,Xr(t),e]})(),lf=Li&&Li.then,wi=wa&&wa.constructor,Ts=!!ka;var xa=!1,Fg=ka?()=>{ka.then(oi)}:me.setImmediate?setImmediate.bind(null,oi):me.MutationObserver?()=>{var e=document.createElement("div");new MutationObserver(()=>{oi(),e=null}).observe(e,{attributes:!0}),e.setAttribute("i","1")}:()=>{setTimeout(oi,0)},wn=function(e,t){vn.push([e,t]),zi&&(Fg(),zi=!1)},Ea=!0,zi=!0,sr=[],ki=[],Sa=null,Oa=$n,zr={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:ju,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach(e=>{try{ju(e[0],e[1])}catch{}})}},re=zr,vn=[],ur=0,xi=[];function X(e){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=he,this._lib=!1;var t=this._PSD=re;if(pt&&(this._stackHolder=wr(),this._prev=null,this._numPrev=0),typeof e!="function"){if(e!==Nn)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&Da(this,this._value))}this._state=null,this._value=null,++t.ref,hf(this,e)}const Ca={get:function(){var e=re,t=Ui;function r(n,i){var o=!e.global&&(e!==re||t!==Ui);const a=o&&!It();var s=new X((u,c)=>{Ms(this,new ff(Ki(n,e,o,a),Ki(i,e,o,a),u,c,e))});return pt&&mf(s,this),s}return r.prototype=Nn,r},set:function(e){St(this,"then",e&&e.prototype===Nn?Ca:{get:function(){return e},set:Ca.set})}};function ff(e,t,r,n,i){this.onFulfilled=typeof e=="function"?e:null,this.onRejected=typeof t=="function"?t:null,this.resolve=r,this.reject=n,this.psd=i}function hf(e,t){try{t(r=>{if(e._state===null){if(r===e)throw new TypeError("A promise cannot be resolved with itself.");var n=e._lib&&Vn();r&&typeof r.then=="function"?hf(e,(i,o)=>{r instanceof X?r._then(i,o):r.then(i,o)}):(e._state=!0,e._value=r,df(e)),n&&Yn()}},Da.bind(null,e))}catch(r){Da(e,r)}}function Da(e,t){if(ki.push(t),e._state===null){var r=e._lib&&Vn();t=Oa(t),e._state=!1,e._value=t,pt&&t!==null&&typeof t=="object"&&!t._promise&&function(n,i,o){try{n.apply(null,o)}catch(a){i&&i(a)}}(()=>{var n=Ds(t,"stack");t._promise=e,St(t,"stack",{get:()=>xa?n&&(n.get?n.get.apply(t):n.value):e.stack})}),function(n){sr.some(i=>i._value===n._value)||sr.push(n)}(e),df(e),r&&Yn()}}function df(e){var t=e._listeners;e._listeners=[];for(var r=0,n=t.length;r<n;++r)Ms(e,t[r]);var i=e._PSD;--i.ref||i.finalize(),ur===0&&(++ur,wn(()=>{--ur==0&&Bs()},[]))}function Ms(e,t){if(e._state!==null){var r=e._state?t.onFulfilled:t.onRejected;if(r===null)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++ur,wn(jg,[r,e,t])}else e._listeners.push(t)}function jg(e,t,r){try{Sa=t;var n,i=t._value;t._state?n=e(i):(ki.length&&(ki=[]),n=e(i),ki.indexOf(i)===-1&&function(o){for(var a=sr.length;a;)if(sr[--a]._value===o._value)return void sr.splice(a,1)}(t)),r.resolve(n)}catch(o){r.reject(o)}finally{Sa=null,--ur==0&&Bs(),--r.psd.ref||r.psd.finalize()}}function pf(e,t,r){if(t.length===r)return t;var n="";if(e._state===!1){var i,o,a=e._value;a!=null?(i=a.name||"Error",o=a.message||a,n=_a(a,0)):(i=a,o=""),t.push(i+(o?": "+o:"")+n)}return pt&&((n=_a(e._stackHolder,2))&&t.indexOf(n)===-1&&t.push(n),e._prev&&pf(e._prev,t,r)),t}function mf(e,t){var r=t?t._numPrev+1:0;r<100&&(e._prev=t,e._numPrev=r)}function oi(){Vn()&&Yn()}function Vn(){var e=Ea;return Ea=!1,zi=!1,e}function Yn(){var e,t,r;do for(;vn.length>0;)for(e=vn,vn=[],r=e.length,t=0;t<r;++t){var n=e[t];n[0].apply(null,n[1])}while(vn.length>0);Ea=!0,zi=!0}function Bs(){var e=sr;sr=[],e.forEach(n=>{n._PSD.onunhandled.call(null,n._value,n)});for(var t=xi.slice(0),r=t.length;r;)t[--r]()}function ai(e){return new X(Nn,!1,e)}function ye(e,t){var r=re;return function(){var n=Vn(),i=re;try{return Vt(r,!0),e.apply(this,arguments)}catch(o){t&&t(o)}finally{Vt(i,!1),n&&Yn()}}}Jr(X.prototype,{then:Ca,_then:function(e,t){Ms(this,new ff(null,null,e,t,re))},catch:function(e){if(arguments.length===1)return this.then(null,e);var t=arguments[0],r=arguments[1];return typeof t=="function"?this.then(null,n=>n instanceof t?r(n):ai(n)):this.then(null,n=>n&&n.name===t?r(n):ai(n))},finally:function(e){return this.then(t=>(e(),t),t=>(e(),ai(t)))},stack:{get:function(){if(this._stack)return this._stack;try{xa=!0;var e=pf(this,[],20).join(`
From previous: `);return this._state!==null&&(this._stack=e),e}finally{xa=!1}}},timeout:function(e,t){return e<1/0?new X((r,n)=>{var i=setTimeout(()=>n(new oe.Timeout(t)),e);this.then(r,n).finally(clearTimeout.bind(null,i))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&St(X.prototype,Symbol.toStringTag,"Dexie.Promise"),zr.env=yf(),Jr(X,{all:function(){var e=wt.apply(null,arguments).map(si);return new X(function(t,r){e.length===0&&t([]);var n=e.length;e.forEach((i,o)=>X.resolve(i).then(a=>{e[o]=a,--n||t(e)},r))})},resolve:e=>{if(e instanceof X)return e;if(e&&typeof e.then=="function")return new X((r,n)=>{e.then(r,n)});var t=new X(Nn,!0,e);return mf(t,Sa),t},reject:ai,race:function(){var e=wt.apply(null,arguments).map(si);return new X((t,r)=>{e.map(n=>X.resolve(n).then(t,r))})},PSD:{get:()=>re,set:e=>re=e},totalEchoes:{get:()=>Ui},newPSD:Qt,usePSD:sn,scheduler:{get:()=>wn,set:e=>{wn=e}},rejectionMapper:{get:()=>Oa,set:e=>{Oa=e}},follow:(e,t)=>new X((r,n)=>Qt((i,o)=>{var a=re;a.unhandleds=[],a.onunhandled=o,a.finalize=mr(function(){(function(s){function u(){s(),xi.splice(xi.indexOf(u),1)}xi.push(u),++ur,wn(()=>{--ur==0&&Bs()},[])})(()=>{this.unhandleds.length===0?i():o(this.unhandleds[0])})},a.finalize),e()},t,r,n))}),wi&&(wi.allSettled&&St(X,"allSettled",function(){const e=wt.apply(null,arguments).map(si);return new X(t=>{e.length===0&&t([]);let r=e.length;const n=new Array(r);e.forEach((i,o)=>X.resolve(i).then(a=>n[o]={status:"fulfilled",value:a},a=>n[o]={status:"rejected",reason:a}).then(()=>--r||t(n)))})}),wi.any&&typeof AggregateError<"u"&&St(X,"any",function(){const e=wt.apply(null,arguments).map(si);return new X((t,r)=>{e.length===0&&r(new AggregateError([]));let n=e.length;const i=new Array(n);e.forEach((o,a)=>X.resolve(o).then(s=>t(s),s=>{i[a]=s,--n||r(new AggregateError(i))}))})}));const Ne={awaits:0,echoes:0,id:0};var Lg=0,Ei=[],Ao=0,Ui=0,zg=0;function Qt(e,t,r,n){var i=re,o=Object.create(i);o.parent=i,o.ref=0,o.global=!1,o.id=++zg;var a=zr.env;o.env=Ts?{Promise:X,PromiseProp:{value:X,configurable:!0,writable:!0},all:X.all,race:X.race,allSettled:X.allSettled,any:X.any,resolve:X.resolve,reject:X.reject,nthen:Fu(a.nthen,o),gthen:Fu(a.gthen,o)}:{},t&&Ke(o,t),++i.ref,o.finalize=function(){--this.parent.ref||this.parent.finalize()};var s=sn(o,e,r,n);return o.ref===0&&o.finalize(),s}function an(){return Ne.id||(Ne.id=++Lg),++Ne.awaits,Ne.echoes+=100,Ne.id}function It(){return!!Ne.awaits&&(--Ne.awaits==0&&(Ne.id=0),Ne.echoes=100*Ne.awaits,!0)}function si(e){return Ne.echoes&&e&&e.constructor===wi?(an(),e.then(t=>(It(),t),t=>(It(),De(t)))):e}function Ug(e){++Ui,Ne.echoes&&--Ne.echoes!=0||(Ne.echoes=Ne.id=0),Ei.push(re),Vt(e,!0)}function Kg(){var e=Ei[Ei.length-1];Ei.pop(),Vt(e,!1)}function Vt(e,t){var r=re;if((t?!Ne.echoes||Ao++&&e===re:!Ao||--Ao&&e===re)||vf(t?Ug.bind(null,e):Kg),e!==re&&(re=e,r===zr&&(zr.env=yf()),Ts)){var n=zr.env.Promise,i=e.env;Li.then=i.nthen,n.prototype.then=i.gthen,(r.global||e.global)&&(Object.defineProperty(me,"Promise",i.PromiseProp),n.all=i.all,n.race=i.race,n.resolve=i.resolve,n.reject=i.reject,i.allSettled&&(n.allSettled=i.allSettled),i.any&&(n.any=i.any))}}function yf(){var e=me.Promise;return Ts?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(me,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject,nthen:Li.then,gthen:e.prototype.then}:{}}function sn(e,t,r,n,i){var o=re;try{return Vt(e,!0),t(r,n,i)}finally{Vt(o,!1)}}function vf(e){lf.call(wa,e)}function Ki(e,t,r,n){return typeof e!="function"?e:function(){var i=re;r&&an(),Vt(t,!0);try{return e.apply(this,arguments)}finally{Vt(i,!1),n&&vf(It)}}}function Fu(e,t){return function(r,n){return e.call(this,Ki(r,t),Ki(n,t))}}(""+lf).indexOf("[native code]")===-1&&(an=It=he);function ju(e,t){var r;try{r=t.onuncatched(e)}catch{}if(r!==!1)try{var n,i={promise:t,reason:e};if(me.document&&document.createEvent?((n=document.createEvent("Event")).initEvent("unhandledrejection",!0,!0),Ke(n,i)):me.CustomEvent&&Ke(n=new CustomEvent("unhandledrejection",{detail:i}),i),n&&me.dispatchEvent&&(dispatchEvent(n),!me.PromiseRejectionEvent&&me.onunhandledrejection))try{me.onunhandledrejection(n)}catch{}pt&&n&&!n.defaultPrevented&&console.warn(`Unhandled rejection: ${e.stack||e}`)}catch{}}var De=X.reject;function Aa(e,t,r,n){if(e.idbdb&&(e._state.openComplete||re.letThrough||e._vip)){var i=e._createTransaction(t,r,e._dbSchema);try{i.create(),e._state.PR1398_maxLoop=3}catch(o){return o.name===Is.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e._close(),e.open().then(()=>Aa(e,t,r,n))):De(o)}return i._promise(t,(o,a)=>Qt(()=>(re.trans=i,n(o,a,i)))).then(o=>i._completion.then(()=>o))}if(e._state.openComplete)return De(new oe.DatabaseClosed(e._state.dbOpenError));if(!e._state.isBeingOpened){if(!e._options.autoOpen)return De(new oe.DatabaseClosed);e.open().catch(he)}return e._state.dbReadyPromise.then(()=>Aa(e,t,r,n))}const or=String.fromCharCode(65535),yt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",kn=[],so=typeof navigator<"u"&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),qg=so,Wg=so,gf=e=>!/(dexie\.js|dexie\.min\.js)/.test(e);function yr(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}const bf={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function ui(e){return typeof e!="string"||/\./.test(e)?t=>t:t=>(t[e]===void 0&&e in t&&delete(t=Qn(t))[e],t)}function Hg(){throw oe.Type()}class Gg{_trans(t,r,n){const i=this._tx||re.trans,o=this.name;function a(u,c,l){if(!l.schema[o])throw new oe.NotFound("Table "+o+" not part of transaction");return r(l.idbtrans,l)}const s=Vn();try{return i&&i.db===this.db?i===re.trans?i._promise(t,a,n):Qt(()=>i._promise(t,a,n),{trans:i,transless:re.transless||re}):Aa(this.db,t,[this.name],a)}finally{s&&Yn()}}get(t,r){return t&&t.constructor===Object?this.where(t).first(r):this._trans("readonly",n=>this.core.get({trans:n,key:t}).then(i=>this.hook.reading.fire(i))).then(r)}where(t){if(typeof t=="string")return new this.db.WhereClause(this,t);if(Fe(t))return new this.db.WhereClause(this,`[${t.join("+")}]`);const r=Se(t);if(r.length===1)return this.where(r[0]).equals(t[r[0]]);const n=this.schema.indexes.concat(this.schema.primKey).filter(c=>c.compound&&r.every(l=>c.keyPath.indexOf(l)>=0)&&c.keyPath.every(l=>r.indexOf(l)>=0))[0];if(n&&this.db._maxKey!==or)return this.where(n.name).equals(n.keyPath.map(c=>t[c]));!n&&pt&&console.warn(`The query ${JSON.stringify(t)} on ${this.name} would benefit of a compound index [${r.join("+")}]`);const{idxByName:i}=this.schema,o=this.db._deps.indexedDB;function a(c,l){try{return o.cmp(c,l)===0}catch{return!1}}const[s,u]=r.reduce(([c,l],f)=>{const h=i[f],d=t[f];return[c||h,c||!h?yr(l,h&&h.multi?y=>{const p=Ot(y,f);return Fe(p)&&p.some(b=>a(d,b))}:y=>a(d,Ot(y,f))):l]},[null,null]);return s?this.where(s.name).equals(t[s.keyPath]).filter(u):n?this.filter(u):this.where(r).equals("")}filter(t){return this.toCollection().and(t)}count(t){return this.toCollection().count(t)}offset(t){return this.toCollection().offset(t)}limit(t){return this.toCollection().limit(t)}each(t){return this.toCollection().each(t)}toArray(t){return this.toCollection().toArray(t)}toCollection(){return new this.db.Collection(new this.db.WhereClause(this))}orderBy(t){return new this.db.Collection(new this.db.WhereClause(this,Fe(t)?`[${t.join("+")}]`:t))}reverse(){return this.toCollection().reverse()}mapToClass(t){const{db:r,name:n}=this;this.schema.mappedClass=t,t.prototype instanceof Hg&&(t=class extends t{get db(){return r}table(){return n}});const i=new Set;for(let a=t.prototype;a;a=Xr(a))Object.getOwnPropertyNames(a).forEach(s=>i.add(s));const o=a=>{if(!a)return a;const s=Object.create(t.prototype);for(let u in a)if(!i.has(u))try{s[u]=a[u]}catch{}return s};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=o,this.hook("reading",o),t}defineClass(){return this.mapToClass(function(t){Ke(this,t)})}add(t,r){const{auto:n,keyPath:i}=this.schema.primKey;let o=t;return i&&n&&(o=ui(i)(t)),this._trans("readwrite",a=>this.core.mutate({trans:a,type:"add",keys:r!=null?[r]:null,values:[o]})).then(a=>a.numFailures?X.reject(a.failures[0]):a.lastResult).then(a=>{if(i)try{nt(t,i,a)}catch{}return a})}update(t,r){if(typeof t!="object"||Fe(t))return this.where(":id").equals(t).modify(r);{const n=Ot(t,this.schema.primKey.keyPath);if(n===void 0)return De(new oe.InvalidArgument("Given object does not contain its primary key"));try{typeof r!="function"?Se(r).forEach(i=>{nt(t,i,r[i])}):r(t,{value:t,primKey:n})}catch{}return this.where(":id").equals(n).modify(r)}}put(t,r){const{auto:n,keyPath:i}=this.schema.primKey;let o=t;return i&&n&&(o=ui(i)(t)),this._trans("readwrite",a=>this.core.mutate({trans:a,type:"put",values:[o],keys:r!=null?[r]:null})).then(a=>a.numFailures?X.reject(a.failures[0]):a.lastResult).then(a=>{if(i)try{nt(t,i,a)}catch{}return a})}delete(t){return this._trans("readwrite",r=>this.core.mutate({trans:r,type:"delete",keys:[t]})).then(r=>r.numFailures?X.reject(r.failures[0]):void 0)}clear(){return this._trans("readwrite",t=>this.core.mutate({trans:t,type:"deleteRange",range:bf})).then(t=>t.numFailures?X.reject(t.failures[0]):void 0)}bulkGet(t){return this._trans("readonly",r=>this.core.getMany({keys:t,trans:r}).then(n=>n.map(i=>this.hook.reading.fire(i))))}bulkAdd(t,r,n){const i=Array.isArray(r)?r:void 0,o=(n=n||(i?void 0:r))?n.allKeys:void 0;return this._trans("readwrite",a=>{const{auto:s,keyPath:u}=this.schema.primKey;if(u&&i)throw new oe.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(i&&i.length!==t.length)throw new oe.InvalidArgument("Arguments objects and keys must have the same length");const c=t.length;let l=u&&s?t.map(ui(u)):t;return this.core.mutate({trans:a,type:"add",keys:i,values:l,wantResults:o}).then(({numFailures:f,results:h,lastResult:d,failures:y})=>{if(f===0)return o?h:d;throw new _n(`${this.name}.bulkAdd(): ${f} of ${c} operations failed`,y)})})}bulkPut(t,r,n){const i=Array.isArray(r)?r:void 0,o=(n=n||(i?void 0:r))?n.allKeys:void 0;return this._trans("readwrite",a=>{const{auto:s,keyPath:u}=this.schema.primKey;if(u&&i)throw new oe.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(i&&i.length!==t.length)throw new oe.InvalidArgument("Arguments objects and keys must have the same length");const c=t.length;let l=u&&s?t.map(ui(u)):t;return this.core.mutate({trans:a,type:"put",keys:i,values:l,wantResults:o}).then(({numFailures:f,results:h,lastResult:d,failures:y})=>{if(f===0)return o?h:d;throw new _n(`${this.name}.bulkPut(): ${f} of ${c} operations failed`,y)})})}bulkDelete(t){const r=t.length;return this._trans("readwrite",n=>this.core.mutate({trans:n,type:"delete",keys:t})).then(({numFailures:n,lastResult:i,failures:o})=>{if(n===0)return i;throw new _n(`${this.name}.bulkDelete(): ${n} of ${r} operations failed`,o)})}}function xn(e){var t={},r=function(s,u){if(u){for(var c=arguments.length,l=new Array(c-1);--c;)l[c-1]=arguments[c];return t[s].subscribe.apply(null,l),e}if(typeof s=="string")return t[s]};r.addEventType=o;for(var n=1,i=arguments.length;n<i;++n)o(arguments[n]);return r;function o(s,u,c){if(typeof s=="object")return a(s);u||(u=Ng),c||(c=he);var l={subscribers:[],fire:c,subscribe:function(f){l.subscribers.indexOf(f)===-1&&(l.subscribers.push(f),l.fire=u(l.fire,f))},unsubscribe:function(f){l.subscribers=l.subscribers.filter(function(h){return h!==f}),l.fire=l.subscribers.reduce(u,c)}};return t[s]=r[s]=l,l}function a(s){Se(s).forEach(function(u){var c=s[u];if(Fe(c))o(u,s[u][0],s[u][1]);else{if(c!=="asap")throw new oe.InvalidArgument("Invalid event config");var l=o(u,$n,function(){for(var f=arguments.length,h=new Array(f);f--;)h[f]=arguments[f];l.subscribers.forEach(function(d){ef(function(){d.apply(null,h)})})})}})}}function hn(e,t){return jr(t).from({prototype:e}),t}function Er(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function Po(e,t){e.filter=yr(e.filter,t)}function Io(e,t,r){var n=e.replayFilter;e.replayFilter=n?()=>yr(n(),t()):t,e.justLimit=r&&!n}function Si(e,t){if(e.isPrimKey)return t.primaryKey;const r=t.getIndexByKeyPath(e.index);if(!r)throw new oe.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return r}function Lu(e,t,r){const n=Si(e,t.schema);return t.openCursor({trans:r,values:!e.keysOnly,reverse:e.dir==="prev",unique:!!e.unique,query:{index:n,range:e.range}})}function ci(e,t,r,n){const i=e.replayFilter?yr(e.filter,e.replayFilter()):e.filter;if(e.or){const o={},a=(s,u,c)=>{if(!i||i(u,c,h=>u.stop(h),h=>u.fail(h))){var l=u.primaryKey,f=""+l;f==="[object ArrayBuffer]"&&(f=""+new Uint8Array(l)),Je(o,f)||(o[f]=!0,t(s,u,c))}};return Promise.all([e.or._iterate(a,r),zu(Lu(e,n,r),e.algorithm,a,!e.keysOnly&&e.valueMapper)])}return zu(Lu(e,n,r),yr(e.algorithm,i),t,!e.keysOnly&&e.valueMapper)}function zu(e,t,r,n){var i=ye(n?(o,a,s)=>r(n(o),a,s):r);return e.then(o=>{if(o)return o.start(()=>{var a=()=>o.continue();t&&!t(o,s=>a=s,s=>{o.stop(s),a=he},s=>{o.fail(s),a=he})||i(o.value,o,s=>a=s),a()})})}function Ue(e,t){try{const r=Uu(e),n=Uu(t);if(r!==n)return r==="Array"?1:n==="Array"?-1:r==="binary"?1:n==="binary"?-1:r==="string"?1:n==="string"?-1:r==="Date"?1:n!=="Date"?NaN:-1;switch(r){case"number":case"Date":case"string":return e>t?1:e<t?-1:0;case"binary":return function(i,o){const a=i.length,s=o.length,u=a<s?a:s;for(let c=0;c<u;++c)if(i[c]!==o[c])return i[c]<o[c]?-1:1;return a===s?0:a<s?-1:1}(Ku(e),Ku(t));case"Array":return function(i,o){const a=i.length,s=o.length,u=a<s?a:s;for(let c=0;c<u;++c){const l=Ue(i[c],o[c]);if(l!==0)return l}return a===s?0:a<s?-1:1}(e,t)}}catch{}return NaN}function Uu(e){const t=typeof e;if(t!=="object")return t;if(ArrayBuffer.isView(e))return"binary";const r=ga(e);return r==="ArrayBuffer"?"binary":r}function Ku(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}class Qg{_read(t,r){var n=this._ctx;return n.error?n.table._trans(null,De.bind(null,n.error)):n.table._trans("readonly",t).then(r)}_write(t){var r=this._ctx;return r.error?r.table._trans(null,De.bind(null,r.error)):r.table._trans("readwrite",t,"locked")}_addAlgorithm(t){var r=this._ctx;r.algorithm=yr(r.algorithm,t)}_iterate(t,r){return ci(this._ctx,t,r,this._ctx.table.core)}clone(t){var r=Object.create(this.constructor.prototype),n=Object.create(this._ctx);return t&&Ke(n,t),r._ctx=n,r}raw(){return this._ctx.valueMapper=null,this}each(t){var r=this._ctx;return this._read(n=>ci(r,t,n,r.table.core))}count(t){return this._read(r=>{const n=this._ctx,i=n.table.core;if(Er(n,!0))return i.count({trans:r,query:{index:Si(n,i.schema),range:n.range}}).then(a=>Math.min(a,n.limit));var o=0;return ci(n,()=>(++o,!1),r,i).then(()=>o)}).then(t)}sortBy(t,r){const n=t.split(".").reverse(),i=n[0],o=n.length-1;function a(c,l){return l?a(c[n[l]],l-1):c[i]}var s=this._ctx.dir==="next"?1:-1;function u(c,l){var f=a(c,o),h=a(l,o);return f<h?-s:f>h?s:0}return this.toArray(function(c){return c.sort(u)}).then(r)}toArray(t){return this._read(r=>{var n=this._ctx;if(n.dir==="next"&&Er(n,!0)&&n.limit>0){const{valueMapper:i}=n,o=Si(n,n.table.core.schema);return n.table.core.query({trans:r,limit:n.limit,values:!0,query:{index:o,range:n.range}}).then(({result:a})=>i?a.map(i):a)}{const i=[];return ci(n,o=>i.push(o),r,n.table.core).then(()=>i)}},t)}offset(t){var r=this._ctx;return t<=0||(r.offset+=t,Er(r)?Io(r,()=>{var n=t;return(i,o)=>n===0||(n===1?(--n,!1):(o(()=>{i.advance(n),n=0}),!1))}):Io(r,()=>{var n=t;return()=>--n<0})),this}limit(t){return this._ctx.limit=Math.min(this._ctx.limit,t),Io(this._ctx,()=>{var r=t;return function(n,i,o){return--r<=0&&i(o),r>=0}},!0),this}until(t,r){return Po(this._ctx,function(n,i,o){return!t(n.value)||(i(o),r)}),this}first(t){return this.limit(1).toArray(function(r){return r[0]}).then(t)}last(t){return this.reverse().first(t)}filter(t){var r,n;return Po(this._ctx,function(i){return t(i.value)}),r=this._ctx,n=t,r.isMatch=yr(r.isMatch,n),this}and(t){return this.filter(t)}or(t){return new this.db.WhereClause(this._ctx.table,t,this)}reverse(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this}desc(){return this.reverse()}eachKey(t){var r=this._ctx;return r.keysOnly=!r.isMatch,this.each(function(n,i){t(i.key,i)})}eachUniqueKey(t){return this._ctx.unique="unique",this.eachKey(t)}eachPrimaryKey(t){var r=this._ctx;return r.keysOnly=!r.isMatch,this.each(function(n,i){t(i.primaryKey,i)})}keys(t){var r=this._ctx;r.keysOnly=!r.isMatch;var n=[];return this.each(function(i,o){n.push(o.key)}).then(function(){return n}).then(t)}primaryKeys(t){var r=this._ctx;if(r.dir==="next"&&Er(r,!0)&&r.limit>0)return this._read(i=>{var o=Si(r,r.table.core.schema);return r.table.core.query({trans:i,values:!1,limit:r.limit,query:{index:o,range:r.range}})}).then(({result:i})=>i).then(t);r.keysOnly=!r.isMatch;var n=[];return this.each(function(i,o){n.push(o.primaryKey)}).then(function(){return n}).then(t)}uniqueKeys(t){return this._ctx.unique="unique",this.keys(t)}firstKey(t){return this.limit(1).keys(function(r){return r[0]}).then(t)}lastKey(t){return this.reverse().firstKey(t)}distinct(){var t=this._ctx,r=t.index&&t.table.schema.idxByName[t.index];if(!r||!r.multi)return this;var n={};return Po(this._ctx,function(i){var o=i.primaryKey.toString(),a=Je(n,o);return n[o]=!0,!a}),this}modify(t){var r=this._ctx;return this._write(n=>{var i;if(typeof t=="function")i=t;else{var o=Se(t),a=o.length;i=function(p){for(var b=!1,m=0;m<a;++m){var g=o[m],w=t[g];Ot(p,g)!==w&&(nt(p,g,w),b=!0)}return b}}const s=r.table.core,{outbound:u,extractKey:c}=s.schema.primaryKey,l=this.db._options.modifyChunkSize||200,f=[];let h=0;const d=[],y=(p,b)=>{const{failures:m,numFailures:g}=b;h+=p-g;for(let w of Se(m))f.push(m[w])};return this.clone().primaryKeys().then(p=>{const b=m=>{const g=Math.min(l,p.length-m);return s.getMany({trans:n,keys:p.slice(m,m+g),cache:"immutable"}).then(w=>{const S=[],k=[],D=u?[]:null,E=[];for(let A=0;A<g;++A){const N=w[A],G={value:Qn(N),primKey:p[m+A]};i.call(G,G.value,G)!==!1&&(G.value==null?E.push(p[m+A]):u||Ue(c(N),c(G.value))===0?(k.push(G.value),u&&D.push(p[m+A])):(E.push(p[m+A]),S.push(G.value)))}const I=Er(r)&&r.limit===1/0&&(typeof t!="function"||t===Ro)&&{index:r.index,range:r.range};return Promise.resolve(S.length>0&&s.mutate({trans:n,type:"add",values:S}).then(A=>{for(let N in A.failures)E.splice(parseInt(N),1);y(S.length,A)})).then(()=>(k.length>0||I&&typeof t=="object")&&s.mutate({trans:n,type:"put",keys:D,values:k,criteria:I,changeSpec:typeof t!="function"&&t}).then(A=>y(k.length,A))).then(()=>(E.length>0||I&&t===Ro)&&s.mutate({trans:n,type:"delete",keys:E,criteria:I}).then(A=>y(E.length,A))).then(()=>p.length>m+g&&b(m+l))})};return b(0).then(()=>{if(f.length>0)throw new ji("Error modifying one or more objects",f,h,d);return p.length})})})}delete(){var t=this._ctx,r=t.range;return Er(t)&&(t.isPrimKey&&!Wg||r.type===3)?this._write(n=>{const{primaryKey:i}=t.table.core.schema,o=r;return t.table.core.count({trans:n,query:{index:i,range:o}}).then(a=>t.table.core.mutate({trans:n,type:"deleteRange",range:o}).then(({failures:s,lastResult:u,results:c,numFailures:l})=>{if(l)throw new ji("Could not delete some values",Object.keys(s).map(f=>s[f]),a-l);return a-l}))}):this.modify(Ro)}}const Ro=(e,t)=>t.value=null;function Vg(e,t){return e<t?-1:e===t?0:1}function Yg(e,t){return e>t?-1:e===t?0:1}function Ge(e,t,r){var n=e instanceof wf?new e.Collection(e):e;return n._ctx.error=r?new r(t):new TypeError(t),n}function Sr(e){return new e.Collection(e,()=>_f("")).limit(0)}function Zg(e,t,r,n,i,o){for(var a=Math.min(e.length,n.length),s=-1,u=0;u<a;++u){var c=t[u];if(c!==n[u])return i(e[u],r[u])<0?e.substr(0,u)+r[u]+r.substr(u+1):i(e[u],n[u])<0?e.substr(0,u)+n[u]+r.substr(u+1):s>=0?e.substr(0,s)+t[s]+r.substr(s+1):null;i(e[u],c)<0&&(s=u)}return a<n.length&&o==="next"?e+r.substr(e.length):a<e.length&&o==="prev"?e.substr(0,r.length):s<0?null:e.substr(0,s)+n[s]+r.substr(s+1)}function li(e,t,r,n){var i,o,a,s,u,c,l,f=r.length;if(!r.every(p=>typeof p=="string"))return Ge(e,"String expected.");function h(p){i=function(m){return m==="next"?g=>g.toUpperCase():g=>g.toLowerCase()}(p),o=function(m){return m==="next"?g=>g.toLowerCase():g=>g.toUpperCase()}(p),a=p==="next"?Vg:Yg;var b=r.map(function(m){return{lower:o(m),upper:i(m)}}).sort(function(m,g){return a(m.lower,g.lower)});s=b.map(function(m){return m.upper}),u=b.map(function(m){return m.lower}),c=p,l=p==="next"?"":n}h("next");var d=new e.Collection(e,()=>Tt(s[0],u[f-1]+n));d._ondirectionchange=function(p){h(p)};var y=0;return d._addAlgorithm(function(p,b,m){var g=p.key;if(typeof g!="string")return!1;var w=o(g);if(t(w,u,y))return!0;for(var S=null,k=y;k<f;++k){var D=Zg(g,w,s[k],u[k],a,c);D===null&&S===null?y=k+1:(S===null||a(S,D)>0)&&(S=D)}return b(S!==null?function(){p.continue(S+l)}:m),!1}),d}function Tt(e,t,r,n){return{type:2,lower:e,upper:t,lowerOpen:r,upperOpen:n}}function _f(e){return{type:1,lower:e,upper:e}}class wf{get Collection(){return this._ctx.table.db.Collection}between(t,r,n,i){n=n!==!1,i=i===!0;try{return this._cmp(t,r)>0||this._cmp(t,r)===0&&(n||i)&&(!n||!i)?Sr(this):new this.Collection(this,()=>Tt(t,r,!n,!i))}catch{return Ge(this,yt)}}equals(t){return t==null?Ge(this,yt):new this.Collection(this,()=>_f(t))}above(t){return t==null?Ge(this,yt):new this.Collection(this,()=>Tt(t,void 0,!0))}aboveOrEqual(t){return t==null?Ge(this,yt):new this.Collection(this,()=>Tt(t,void 0,!1))}below(t){return t==null?Ge(this,yt):new this.Collection(this,()=>Tt(void 0,t,!1,!0))}belowOrEqual(t){return t==null?Ge(this,yt):new this.Collection(this,()=>Tt(void 0,t))}startsWith(t){return typeof t!="string"?Ge(this,"String expected."):this.between(t,t+or,!0,!0)}startsWithIgnoreCase(t){return t===""?this.startsWith(t):li(this,(r,n)=>r.indexOf(n[0])===0,[t],or)}equalsIgnoreCase(t){return li(this,(r,n)=>r===n[0],[t],"")}anyOfIgnoreCase(){var t=wt.apply(Dr,arguments);return t.length===0?Sr(this):li(this,(r,n)=>n.indexOf(r)!==-1,t,"")}startsWithAnyOfIgnoreCase(){var t=wt.apply(Dr,arguments);return t.length===0?Sr(this):li(this,(r,n)=>n.some(i=>r.indexOf(i)===0),t,or)}anyOf(){const t=wt.apply(Dr,arguments);let r=this._cmp;try{t.sort(r)}catch{return Ge(this,yt)}if(t.length===0)return Sr(this);const n=new this.Collection(this,()=>Tt(t[0],t[t.length-1]));n._ondirectionchange=o=>{r=o==="next"?this._ascending:this._descending,t.sort(r)};let i=0;return n._addAlgorithm((o,a,s)=>{const u=o.key;for(;r(u,t[i])>0;)if(++i,i===t.length)return a(s),!1;return r(u,t[i])===0||(a(()=>{o.continue(t[i])}),!1)}),n}notEqual(t){return this.inAnyRange([[-(1/0),t],[t,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})}noneOf(){const t=wt.apply(Dr,arguments);if(t.length===0)return new this.Collection(this);try{t.sort(this._ascending)}catch{return Ge(this,yt)}const r=t.reduce((n,i)=>n?n.concat([[n[n.length-1][1],i]]):[[-(1/0),i]],null);return r.push([t[t.length-1],this.db._maxKey]),this.inAnyRange(r,{includeLowers:!1,includeUppers:!1})}inAnyRange(t,r){const n=this._cmp,i=this._ascending,o=this._descending,a=this._min,s=this._max;if(t.length===0)return Sr(this);if(!t.every(g=>g[0]!==void 0&&g[1]!==void 0&&i(g[0],g[1])<=0))return Ge(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",oe.InvalidArgument);const u=!r||r.includeLowers!==!1,c=r&&r.includeUppers===!0;let l,f=i;function h(g,w){return f(g[0],w[0])}try{l=t.reduce(function(g,w){let S=0,k=g.length;for(;S<k;++S){const D=g[S];if(n(w[0],D[1])<0&&n(w[1],D[0])>0){D[0]=a(D[0],w[0]),D[1]=s(D[1],w[1]);break}}return S===k&&g.push(w),g},[]),l.sort(h)}catch{return Ge(this,yt)}let d=0;const y=c?g=>i(g,l[d][1])>0:g=>i(g,l[d][1])>=0,p=u?g=>o(g,l[d][0])>0:g=>o(g,l[d][0])>=0;let b=y;const m=new this.Collection(this,()=>Tt(l[0][0],l[l.length-1][1],!u,!c));return m._ondirectionchange=g=>{g==="next"?(b=y,f=i):(b=p,f=o),l.sort(h)},m._addAlgorithm((g,w,S)=>{for(var k=g.key;b(k);)if(++d,d===l.length)return w(S),!1;return!!function(D){return!y(D)&&!p(D)}(k)||(this._cmp(k,l[d][1])===0||this._cmp(k,l[d][0])===0||w(()=>{f===i?g.continue(l[d][0]):g.continue(l[d][1])}),!1)}),m}startsWithAnyOf(){const t=wt.apply(Dr,arguments);return t.every(r=>typeof r=="string")?t.length===0?Sr(this):this.inAnyRange(t.map(r=>[r,r+or])):Ge(this,"startsWithAnyOf() only works with strings")}}function ct(e){return ye(function(t){return Fn(t),e(t.target.error),!1})}function Fn(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}const Yt=xn(null,"storagemutated");class Xg{_lock(){return yn(!re.global),++this._reculock,this._reculock!==1||re.global||(re.lockOwnerFor=this),this}_unlock(){if(yn(!re.global),--this._reculock==0)for(re.global||(re.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var t=this._blockedFuncs.shift();try{sn(t[1],t[0])}catch{}}return this}_locked(){return this._reculock&&re.lockOwnerFor!==this}create(t){if(!this.mode)return this;const r=this.db.idbdb,n=this.db._state.dbOpenError;if(yn(!this.idbtrans),!t&&!r)switch(n&&n.name){case"DatabaseClosedError":throw new oe.DatabaseClosed(n);case"MissingAPIError":throw new oe.MissingAPI(n.message,n);default:throw new oe.OpenFailed(n)}if(!this.active)throw new oe.TransactionInactive;return yn(this._completion._state===null),(t=this.idbtrans=t||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):r.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}))).onerror=ye(i=>{Fn(i),this._reject(t.error)}),t.onabort=ye(i=>{Fn(i),this.active&&this._reject(new oe.Abort(t.error)),this.active=!1,this.on("abort").fire(i)}),t.oncomplete=ye(()=>{this.active=!1,this._resolve(),"mutatedParts"in t&&Yt.storagemutated.fire(t.mutatedParts)}),this}_promise(t,r,n){if(t==="readwrite"&&this.mode!=="readwrite")return De(new oe.ReadOnly("Transaction is readonly"));if(!this.active)return De(new oe.TransactionInactive);if(this._locked())return new X((o,a)=>{this._blockedFuncs.push([()=>{this._promise(t,r,n).then(o,a)},re])});if(n)return Qt(()=>{var o=new X((a,s)=>{this._lock();const u=r(a,s,this);u&&u.then&&u.then(a,s)});return o.finally(()=>this._unlock()),o._lib=!0,o});var i=new X((o,a)=>{var s=r(o,a,this);s&&s.then&&s.then(o,a)});return i._lib=!0,i}_root(){return this.parent?this.parent._root():this}waitFor(t){var r=this._root();const n=X.resolve(t);if(r._waitingFor)r._waitingFor=r._waitingFor.then(()=>n);else{r._waitingFor=n,r._waitingQueue=[];var i=r.idbtrans.objectStore(r.storeNames[0]);(function a(){for(++r._spinCount;r._waitingQueue.length;)r._waitingQueue.shift()();r._waitingFor&&(i.get(-1/0).onsuccess=a)})()}var o=r._waitingFor;return new X((a,s)=>{n.then(u=>r._waitingQueue.push(ye(a.bind(null,u))),u=>r._waitingQueue.push(ye(s.bind(null,u)))).finally(()=>{r._waitingFor===o&&(r._waitingFor=null)})})}abort(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new oe.Abort))}table(t){const r=this._memoizedTables||(this._memoizedTables={});if(Je(r,t))return r[t];const n=this.schema[t];if(!n)throw new oe.NotFound("Table "+t+" not part of transaction");const i=new this.db.Table(t,n,this);return i.core=this.db.core.table(t),r[t]=i,i}}function Pa(e,t,r,n,i,o,a){return{name:e,keyPath:t,unique:r,multi:n,auto:i,compound:o,src:(r&&!a?"&":"")+(n?"*":"")+(i?"++":"")+kf(t)}}function kf(e){return typeof e=="string"?e:e?"["+[].join.call(e,"+")+"]":""}function xf(e,t,r){return{name:e,primKey:t,indexes:r,mappedClass:null,idxByName:tf(r,n=>[n.name,n])}}let jn=e=>{try{return e.only([[]]),jn=()=>[[]],[[]]}catch{return jn=()=>or,or}};function Ia(e){return e==null?()=>{}:typeof e=="string"?function(t){return t.split(".").length===1?r=>r[t]:r=>Ot(r,t)}(e):t=>Ot(t,e)}function qu(e){return[].slice.call(e)}let Jg=0;function En(e){return e==null?":id":typeof e=="string"?e:`[${e.join("+")}]`}function eb(e,t,r){function n(u){if(u.type===3)return null;if(u.type===4)throw new Error("Cannot convert never type to IDBKeyRange");const{lower:c,upper:l,lowerOpen:f,upperOpen:h}=u;return c===void 0?l===void 0?null:t.upperBound(l,!!h):l===void 0?t.lowerBound(c,!!f):t.bound(c,l,!!f,!!h)}const{schema:i,hasGetAll:o}=function(u,c){const l=qu(u.objectStoreNames);return{schema:{name:u.name,tables:l.map(f=>c.objectStore(f)).map(f=>{const{keyPath:h,autoIncrement:d}=f,y=Fe(h),p=h==null,b={},m={name:f.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:p,compound:y,keyPath:h,autoIncrement:d,unique:!0,extractKey:Ia(h)},indexes:qu(f.indexNames).map(g=>f.index(g)).map(g=>{const{name:w,unique:S,multiEntry:k,keyPath:D}=g,E={name:w,compound:Fe(D),keyPath:D,unique:S,multiEntry:k,extractKey:Ia(D)};return b[En(D)]=E,E}),getIndexByKeyPath:g=>b[En(g)]};return b[":id"]=m.primaryKey,h!=null&&(b[En(h)]=m.primaryKey),m})},hasGetAll:l.length>0&&"getAll"in c.objectStore(l[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}(e,r),a=i.tables.map(u=>function(c){const l=c.name;return{name:l,schema:c,mutate:function({trans:f,type:h,keys:d,values:y,range:p}){return new Promise((b,m)=>{b=ye(b);const g=f.objectStore(l),w=g.keyPath==null,S=h==="put"||h==="add";if(!S&&h!=="delete"&&h!=="deleteRange")throw new Error("Invalid operation type: "+h);const{length:k}=d||y||{length:1};if(d&&y&&d.length!==y.length)throw new Error("Given keys array must have same length as given values array.");if(k===0)return b({numFailures:0,failures:{},results:[],lastResult:void 0});let D;const E=[],I=[];let A=0;const N=C=>{++A,Fn(C)};if(h==="deleteRange"){if(p.type===4)return b({numFailures:A,failures:I,results:[],lastResult:void 0});p.type===3?E.push(D=g.clear()):E.push(D=g.delete(n(p)))}else{const[C,M]=S?w?[y,d]:[y,null]:[d,null];if(S)for(let _=0;_<k;++_)E.push(D=M&&M[_]!==void 0?g[h](C[_],M[_]):g[h](C[_])),D.onerror=N;else for(let _=0;_<k;++_)E.push(D=g[h](C[_])),D.onerror=N}const G=C=>{const M=C.target.result;E.forEach((_,F)=>_.error!=null&&(I[F]=_.error)),b({numFailures:A,failures:I,results:h==="delete"?d:E.map(_=>_.result),lastResult:M})};D.onerror=C=>{N(C),G(C)},D.onsuccess=G})},getMany:({trans:f,keys:h})=>new Promise((d,y)=>{d=ye(d);const p=f.objectStore(l),b=h.length,m=new Array(b);let g,w=0,S=0;const k=E=>{const I=E.target;m[I._pos]=I.result,++S===w&&d(m)},D=ct(y);for(let E=0;E<b;++E)h[E]!=null&&(g=p.get(h[E]),g._pos=E,g.onsuccess=k,g.onerror=D,++w);w===0&&d(m)}),get:({trans:f,key:h})=>new Promise((d,y)=>{d=ye(d);const p=f.objectStore(l).get(h);p.onsuccess=b=>d(b.target.result),p.onerror=ct(y)}),query:function(f){return h=>new Promise((d,y)=>{d=ye(d);const{trans:p,values:b,limit:m,query:g}=h,w=m===1/0?void 0:m,{index:S,range:k}=g,D=p.objectStore(l),E=S.isPrimaryKey?D:D.index(S.name),I=n(k);if(m===0)return d({result:[]});if(f){const A=b?E.getAll(I,w):E.getAllKeys(I,w);A.onsuccess=N=>d({result:N.target.result}),A.onerror=ct(y)}else{let A=0;const N=b||!("openKeyCursor"in E)?E.openCursor(I):E.openKeyCursor(I),G=[];N.onsuccess=C=>{const M=N.result;return M?(G.push(b?M.value:M.primaryKey),++A===m?d({result:G}):void M.continue()):d({result:G})},N.onerror=ct(y)}})}(o),openCursor:function({trans:f,values:h,query:d,reverse:y,unique:p}){return new Promise((b,m)=>{b=ye(b);const{index:g,range:w}=d,S=f.objectStore(l),k=g.isPrimaryKey?S:S.index(g.name),D=y?p?"prevunique":"prev":p?"nextunique":"next",E=h||!("openKeyCursor"in k)?k.openCursor(n(w),D):k.openKeyCursor(n(w),D);E.onerror=ct(m),E.onsuccess=ye(I=>{const A=E.result;if(!A)return void b(null);A.___id=++Jg,A.done=!1;const N=A.continue.bind(A);let G=A.continuePrimaryKey;G&&(G=G.bind(A));const C=A.advance.bind(A),M=()=>{throw new Error("Cursor not stopped")};A.trans=f,A.stop=A.continue=A.continuePrimaryKey=A.advance=()=>{throw new Error("Cursor not started")},A.fail=ye(m),A.next=function(){let _=1;return this.start(()=>_--?this.continue():this.stop()).then(()=>this)},A.start=_=>{const F=new Promise((j,te)=>{j=ye(j),E.onerror=ct(te),A.fail=te,A.stop=L=>{A.stop=A.continue=A.continuePrimaryKey=A.advance=M,j(L)}}),ee=()=>{if(E.result)try{_()}catch(j){A.fail(j)}else A.done=!0,A.start=()=>{throw new Error("Cursor behind last entry")},A.stop()};return E.onsuccess=ye(j=>{E.onsuccess=ee,ee()}),A.continue=N,A.continuePrimaryKey=G,A.advance=C,ee(),F},b(A)},m)})},count({query:f,trans:h}){const{index:d,range:y}=f;return new Promise((p,b)=>{const m=h.objectStore(l),g=d.isPrimaryKey?m:m.index(d.name),w=n(y),S=w?g.count(w):g.count();S.onsuccess=ye(k=>p(k.target.result)),S.onerror=ct(b)})}}}(u)),s={};return a.forEach(u=>s[u.name]=u),{stack:"dbcore",transaction:e.transaction.bind(e),table(u){if(!s[u])throw new Error(`Table '${u}' not found`);return s[u]},MIN_KEY:-1/0,MAX_KEY:jn(t),schema:i}}function Ra({_novip:e},t){const r=t.db,n=function(i,o,{IDBKeyRange:a,indexedDB:s},u){return{dbcore:function(l,f){return f.reduce((h,{create:d})=>({...h,...d(h)}),l)}(eb(o,a,u),i.dbcore)}}(e._middlewares,r,e._deps,t);e.core=n.dbcore,e.tables.forEach(i=>{const o=i.name;e.core.schema.tables.some(a=>a.name===o)&&(i.core=e.core.table(o),e[o]instanceof e.Table&&(e[o].core=i.core))})}function qi({_novip:e},t,r,n){r.forEach(i=>{const o=n[i];t.forEach(a=>{const s=Ds(a,i);(!s||"value"in s&&s.value===void 0)&&(a===e.Transaction.prototype||a instanceof e.Transaction?St(a,i,{get(){return this.table(i)},set(u){Xl(this,i,{value:u,writable:!0,configurable:!0,enumerable:!0})}}):a[i]=new e.Table(i,o))})})}function Ta({_novip:e},t){t.forEach(r=>{for(let n in r)r[n]instanceof e.Table&&delete r[n]})}function tb(e,t){return e._cfg.version-t._cfg.version}function rb(e,t,r,n){const i=e._dbSchema,o=e._createTransaction("readwrite",e._storeNames,i);o.create(r),o._completion.catch(n);const a=o._reject.bind(o),s=re.transless||re;Qt(()=>{re.trans=o,re.transless=s,t===0?(Se(i).forEach(u=>{To(r,u,i[u].primKey,i[u].indexes)}),Ra(e,r),X.follow(()=>e.on.populate.fire(o)).catch(a)):function({_novip:u},c,l,f){const h=[],d=u._versions;let y=u._dbSchema=Ba(u,u.idbdb,f),p=!1;function b(){return h.length?X.resolve(h.shift()(l.idbtrans)).then(b):X.resolve()}return d.filter(m=>m._cfg.version>=c).forEach(m=>{h.push(()=>{const g=y,w=m._cfg.dbschema;$a(u,g,f),$a(u,w,f),y=u._dbSchema=w;const S=Ef(g,w);S.add.forEach(D=>{To(f,D[0],D[1].primKey,D[1].indexes)}),S.change.forEach(D=>{if(D.recreate)throw new oe.Upgrade("Not yet support for changing primary key");{const E=f.objectStore(D.name);D.add.forEach(I=>Ma(E,I)),D.change.forEach(I=>{E.deleteIndex(I.name),Ma(E,I)}),D.del.forEach(I=>E.deleteIndex(I))}});const k=m._cfg.contentUpgrade;if(k&&m._cfg.version>c){Ra(u,f),l._memoizedTables={},p=!0;let D=rf(w);S.del.forEach(N=>{D[N]=g[N]}),Ta(u,[u.Transaction.prototype]),qi(u,[u.Transaction.prototype],Se(D),D),l.schema=D;const E=As(k);let I;E&&an();const A=X.follow(()=>{if(I=k(l),I&&E){var N=It.bind(null,null);I.then(N,N)}});return I&&typeof I.then=="function"?X.resolve(I):A.then(()=>I)}}),h.push(g=>{(!p||!qg)&&function(w,S){[].slice.call(S.db.objectStoreNames).forEach(k=>w[k]==null&&S.db.deleteObjectStore(k))}(m._cfg.dbschema,g),Ta(u,[u.Transaction.prototype]),qi(u,[u.Transaction.prototype],u._storeNames,u._dbSchema),l.schema=u._dbSchema})}),b().then(()=>{var m,g;g=f,Se(m=y).forEach(w=>{g.db.objectStoreNames.contains(w)||To(g,w,m[w].primKey,m[w].indexes)})})}(e,t,o,r).catch(a)})}function Ef(e,t){const r={del:[],add:[],change:[]};let n;for(n in e)t[n]||r.del.push(n);for(n in t){const i=e[n],o=t[n];if(i){const a={name:n,def:o,recreate:!1,del:[],add:[],change:[]};if(""+(i.primKey.keyPath||"")!=""+(o.primKey.keyPath||"")||i.primKey.auto!==o.primKey.auto&&!so)a.recreate=!0,r.change.push(a);else{const s=i.idxByName,u=o.idxByName;let c;for(c in s)u[c]||a.del.push(c);for(c in u){const l=s[c],f=u[c];l?l.src!==f.src&&a.change.push(f):a.add.push(f)}(a.del.length>0||a.add.length>0||a.change.length>0)&&r.change.push(a)}}else r.add.push([n,o])}return r}function To(e,t,r,n){const i=e.db.createObjectStore(t,r.keyPath?{keyPath:r.keyPath,autoIncrement:r.auto}:{autoIncrement:r.auto});return n.forEach(o=>Ma(i,o)),i}function Ma(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function Ba(e,t,r){const n={};return Fi(t.objectStoreNames,0).forEach(i=>{const o=r.objectStore(i);let a=o.keyPath;const s=Pa(kf(a),a||"",!1,!1,!!o.autoIncrement,a&&typeof a!="string",!0),u=[];for(let l=0;l<o.indexNames.length;++l){const f=o.index(o.indexNames[l]);a=f.keyPath;var c=Pa(f.name,a,!!f.unique,!!f.multiEntry,!1,a&&typeof a!="string",!1);u.push(c)}n[i]=xf(i,s,u)}),n}function $a({_novip:e},t,r){const n=r.db.objectStoreNames;for(let i=0;i<n.length;++i){const o=n[i],a=r.objectStore(o);e._hasGetAll="getAll"in a;for(let s=0;s<a.indexNames.length;++s){const u=a.indexNames[s],c=a.index(u).keyPath,l=typeof c=="string"?c:"["+Fi(c).join("+")+"]";if(t[o]){const f=t[o].idxByName[l];f&&(f.name=u,delete t[o].idxByName[l],t[o].idxByName[u]=f)}}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&me.WorkerGlobalScope&&me instanceof me.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}class nb{_parseStoresSpec(t,r){Se(t).forEach(n=>{if(t[n]!==null){var i=t[n].split(",").map((a,s)=>{const u=(a=a.trim()).replace(/([&*]|\+\+)/g,""),c=/^\[/.test(u)?u.match(/^\[(.*)\]$/)[1].split("+"):u;return Pa(u,c||null,/\&/.test(a),/\*/.test(a),/\+\+/.test(a),Fe(c),s===0)}),o=i.shift();if(o.multi)throw new oe.Schema("Primary key cannot be multi-valued");i.forEach(a=>{if(a.auto)throw new oe.Schema("Only primary key can be marked as autoIncrement (++)");if(!a.keyPath)throw new oe.Schema("Index must have a name and cannot be an empty string")}),r[n]=xf(n,o,i)}})}stores(t){const r=this.db;this._cfg.storesSource=this._cfg.storesSource?Ke(this._cfg.storesSource,t):t;const n=r._versions,i={};let o={};return n.forEach(a=>{Ke(i,a._cfg.storesSource),o=a._cfg.dbschema={},a._parseStoresSpec(i,o)}),r._dbSchema=o,Ta(r,[r._allTables,r,r.Transaction.prototype]),qi(r,[r._allTables,r,r.Transaction.prototype,this._cfg.tables],Se(o),o),r._storeNames=Se(o),this}upgrade(t){return this._cfg.contentUpgrade=Rs(this._cfg.contentUpgrade||he,t),this}}function $s(e,t){let r=e._dbNamesDB;return r||(r=e._dbNamesDB=new cr("__dbnames",{addons:[],indexedDB:e,IDBKeyRange:t}),r.version(1).stores({dbnames:"name"})),r.table("dbnames")}function Ns(e){return e&&typeof e.databases=="function"}function Na(e){return Qt(function(){return re.letThrough=!0,e()})}function ib(){var e;return!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(t){var r=function(){return indexedDB.databases().finally(t)};e=setInterval(r,100),r()}).finally(function(){return clearInterval(e)}):Promise.resolve()}function ob(e){const t=e._state,{indexedDB:r}=e._deps;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then(()=>t.dbOpenError?De(t.dbOpenError):e);pt&&(t.openCanceller._stackHolder=wr()),t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;const n=t.openCanceller;function i(){if(t.openCanceller!==n)throw new oe.DatabaseClosed("db.open() was cancelled")}let o=t.dbReadyResolve,a=null,s=!1;return X.race([n,(typeof navigator>"u"?X.resolve():ib()).then(()=>new X((u,c)=>{if(i(),!r)throw new oe.MissingAPI;const l=e.name,f=t.autoSchema?r.open(l):r.open(l,Math.round(10*e.verno));if(!f)throw new oe.MissingAPI;f.onerror=ct(c),f.onblocked=ye(e._fireOnBlocked),f.onupgradeneeded=ye(h=>{if(a=f.transaction,t.autoSchema&&!e._options.allowEmptyDB){f.onerror=Fn,a.abort(),f.result.close();const y=r.deleteDatabase(l);y.onsuccess=y.onerror=ye(()=>{c(new oe.NoSuchDatabase(`Database ${l} doesnt exist`))})}else{a.onerror=ct(c);var d=h.oldVersion>Math.pow(2,62)?0:h.oldVersion;s=d<1,e._novip.idbdb=f.result,rb(e,d/10,a,c)}},c),f.onsuccess=ye(()=>{a=null;const h=e._novip.idbdb=f.result,d=Fi(h.objectStoreNames);if(d.length>0)try{const p=h.transaction((y=d).length===1?y[0]:y,"readonly");t.autoSchema?function({_novip:b},m,g){b.verno=m.version/10;const w=b._dbSchema=Ba(0,m,g);b._storeNames=Fi(m.objectStoreNames,0),qi(b,[b._allTables],Se(w),w)}(e,h,p):($a(e,e._dbSchema,p),function(b,m){const g=Ef(Ba(0,b.idbdb,m),b._dbSchema);return!(g.add.length||g.change.some(w=>w.add.length||w.change.length))}(e,p)||console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.")),Ra(e,p)}catch{}var y;kn.push(e),h.onversionchange=ye(p=>{t.vcFired=!0,e.on("versionchange").fire(p)}),h.onclose=ye(p=>{e.on("close").fire(p)}),s&&function({indexedDB:p,IDBKeyRange:b},m){!Ns(p)&&m!=="__dbnames"&&$s(p,b).put({name:m}).catch(he)}(e._deps,l),u()},c)}))]).then(()=>(i(),t.onReadyBeingFired=[],X.resolve(Na(()=>e.on.ready.fire(e.vip))).then(function u(){if(t.onReadyBeingFired.length>0){let c=t.onReadyBeingFired.reduce(Rs,he);return t.onReadyBeingFired=[],X.resolve(Na(()=>c(e.vip))).then(u)}}))).finally(()=>{t.onReadyBeingFired=null,t.isBeingOpened=!1}).then(()=>e).catch(u=>{t.dbOpenError=u;try{a&&a.abort()}catch{}return n===t.openCanceller&&e._close(),De(u)}).finally(()=>{t.openComplete=!0,o()})}function Fa(e){var t=o=>e.next(o),r=i(t),n=i(o=>e.throw(o));function i(o){return a=>{var s=o(a),u=s.value;return s.done?u:u&&typeof u.then=="function"?u.then(r,n):Fe(u)?Promise.all(u).then(r,n):r(u)}}return i(t)()}function ab(e,t,r){var n=arguments.length;if(n<2)throw new oe.InvalidArgument("Too few arguments");for(var i=new Array(n-1);--n;)i[n-1]=arguments[n];r=i.pop();var o=nf(i);return[e,o,r]}function Sf(e,t,r,n,i){return X.resolve().then(()=>{const o=re.transless||re,a=e._createTransaction(t,r,e._dbSchema,n),s={trans:a,transless:o};if(n)a.idbtrans=n.idbtrans;else try{a.create(),e._state.PR1398_maxLoop=3}catch(f){return f.name===Is.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e._close(),e.open().then(()=>Sf(e,t,r,null,i))):De(f)}const u=As(i);let c;u&&an();const l=X.follow(()=>{if(c=i.call(a,a),c)if(u){var f=It.bind(null,null);c.then(f,f)}else typeof c.next=="function"&&typeof c.throw=="function"&&(c=Fa(c))},s);return(c&&typeof c.then=="function"?X.resolve(c).then(f=>a.active?f:De(new oe.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))):l.then(()=>c)).then(f=>(n&&a._resolve(),a._completion.then(()=>f))).catch(f=>(a._reject(f),De(f)))})}function fi(e,t,r){const n=Fe(e)?e.slice():[e];for(let i=0;i<r;++i)n.push(t);return n}const sb={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(e){return{...e,table(t){const r=e.table(t),{schema:n}=r,i={},o=[];function a(l,f,h){const d=En(l),y=i[d]=i[d]||[],p=l==null?0:typeof l=="string"?1:l.length,b=f>0,m={...h,isVirtual:b,keyTail:f,keyLength:p,extractKey:Ia(l),unique:!b&&h.unique};return y.push(m),m.isPrimaryKey||o.push(m),p>1&&a(p===2?l[0]:l.slice(0,p-1),f+1,h),y.sort((g,w)=>g.keyTail-w.keyTail),m}const s=a(n.primaryKey.keyPath,0,n.primaryKey);i[":id"]=[s];for(const l of n.indexes)a(l.keyPath,0,l);function u(l){const f=l.query.index;return f.isVirtual?{...l,query:{index:f,range:(h=l.query.range,d=f.keyTail,{type:h.type===1?2:h.type,lower:fi(h.lower,h.lowerOpen?e.MAX_KEY:e.MIN_KEY,d),lowerOpen:!0,upper:fi(h.upper,h.upperOpen?e.MIN_KEY:e.MAX_KEY,d),upperOpen:!0})}}:l;var h,d}return{...r,schema:{...n,primaryKey:s,indexes:o,getIndexByKeyPath:function(l){const f=i[En(l)];return f&&f[0]}},count:l=>r.count(u(l)),query:l=>r.query(u(l)),openCursor(l){const{keyTail:f,isVirtual:h,keyLength:d}=l.query.index;return h?r.openCursor(u(l)).then(y=>y&&function(p){return Object.create(p,{continue:{value:function(m){m!=null?p.continue(fi(m,l.reverse?e.MAX_KEY:e.MIN_KEY,f)):l.unique?p.continue(p.key.slice(0,d).concat(l.reverse?e.MIN_KEY:e.MAX_KEY,f)):p.continue()}},continuePrimaryKey:{value(m,g){p.continuePrimaryKey(fi(m,e.MAX_KEY,f),g)}},primaryKey:{get:()=>p.primaryKey},key:{get(){const m=p.key;return d===1?m[0]:m.slice(0,d)}},value:{get:()=>p.value}})}(y)):r.openCursor(l)}}}}}};function Fs(e,t,r,n){return r=r||{},n=n||"",Se(e).forEach(i=>{if(Je(t,i)){var o=e[i],a=t[i];if(typeof o=="object"&&typeof a=="object"&&o&&a){const s=ga(o);s!==ga(a)?r[n+i]=t[i]:s==="Object"?Fs(o,a,r,n+i+"."):o!==a&&(r[n+i]=t[i])}else o!==a&&(r[n+i]=t[i])}else r[n+i]=void 0}),Se(t).forEach(i=>{Je(e,i)||(r[n+i]=t[i])}),r}const ub={stack:"dbcore",name:"HooksMiddleware",level:2,create:e=>({...e,table(t){const r=e.table(t),{primaryKey:n}=r.schema;return{...r,mutate(o){const a=re.trans,{deleting:s,creating:u,updating:c}=a.table(t).hook;switch(o.type){case"add":if(u.fire===he)break;return a._promise("readwrite",()=>l(o),!0);case"put":if(u.fire===he&&c.fire===he)break;return a._promise("readwrite",()=>l(o),!0);case"delete":if(s.fire===he)break;return a._promise("readwrite",()=>l(o),!0);case"deleteRange":if(s.fire===he)break;return a._promise("readwrite",()=>function(h){return f(h.trans,h.range,1e4)}(o),!0)}return r.mutate(o);function l(h){const d=re.trans,y=h.keys||function(p,b){return b.type==="delete"?b.keys:b.keys||b.values.map(p.extractKey)}(n,h);if(!y)throw new Error("Keys missing");return(h=h.type==="add"||h.type==="put"?{...h,keys:y}:{...h}).type!=="delete"&&(h.values=[...h.values]),h.keys&&(h.keys=[...h.keys]),function(p,b,m){return b.type==="add"?Promise.resolve([]):p.getMany({trans:b.trans,keys:m,cache:"immutable"})}(r,h,y).then(p=>{const b=y.map((m,g)=>{const w=p[g],S={onerror:null,onsuccess:null};if(h.type==="delete")s.fire.call(S,m,w,d);else if(h.type==="add"||w===void 0){const k=u.fire.call(S,m,h.values[g],d);m==null&&k!=null&&(m=k,h.keys[g]=m,n.outbound||nt(h.values[g],n.keyPath,m))}else{const k=Fs(w,h.values[g]),D=c.fire.call(S,k,m,w,d);if(D){const E=h.values[g];Object.keys(D).forEach(I=>{Je(E,I)?E[I]=D[I]:nt(E,I,D[I])})}}return S});return r.mutate(h).then(({failures:m,results:g,numFailures:w,lastResult:S})=>{for(let k=0;k<y.length;++k){const D=g?g[k]:y[k],E=b[k];D==null?E.onerror&&E.onerror(m[k]):E.onsuccess&&E.onsuccess(h.type==="put"&&p[k]?h.values[k]:D)}return{failures:m,results:g,numFailures:w,lastResult:S}}).catch(m=>(b.forEach(g=>g.onerror&&g.onerror(m)),Promise.reject(m)))})}function f(h,d,y){return r.query({trans:h,values:!1,query:{index:n,range:d},limit:y}).then(({result:p})=>l({type:"delete",keys:p,trans:h}).then(b=>b.numFailures>0?Promise.reject(b.failures[0]):p.length<y?{failures:[],numFailures:0,lastResult:void 0}:f(h,{...d,lower:p[p.length-1],lowerOpen:!0},y)))}}}}})};function Of(e,t,r){try{if(!t||t.keys.length<e.length)return null;const n=[];for(let i=0,o=0;i<t.keys.length&&o<e.length;++i)Ue(t.keys[i],e[o])===0&&(n.push(r?Qn(t.values[i]):t.values[i]),++o);return n.length===e.length?n:null}catch{return null}}const cb={stack:"dbcore",level:-1,create:e=>({table:t=>{const r=e.table(t);return{...r,getMany:n=>{if(!n.cache)return r.getMany(n);const i=Of(n.keys,n.trans._cache,n.cache==="clone");return i?X.resolve(i):r.getMany(n).then(o=>(n.trans._cache={keys:n.keys,values:n.cache==="clone"?Qn(o):o},o))},mutate:n=>(n.type!=="add"&&(n.trans._cache=null),r.mutate(n))}}})};function js(e){return!("from"in e)}const gt=function(e,t){if(!this){const r=new gt;return e&&"d"in e&&Ke(r,e),r}Ke(this,arguments.length?{d:1,from:e,to:arguments.length>1?t:e}:{d:0})};function Ln(e,t,r){const n=Ue(t,r);if(isNaN(n))return;if(n>0)throw RangeError();if(js(e))return Ke(e,{from:t,to:r,d:1});const i=e.l,o=e.r;if(Ue(r,e.from)<0)return i?Ln(i,t,r):e.l={from:t,to:r,d:1,l:null,r:null},Wu(e);if(Ue(t,e.to)>0)return o?Ln(o,t,r):e.r={from:t,to:r,d:1,l:null,r:null},Wu(e);Ue(t,e.from)<0&&(e.from=t,e.l=null,e.d=o?o.d+1:1),Ue(r,e.to)>0&&(e.to=r,e.r=null,e.d=e.l?e.l.d+1:1);const a=!e.r;i&&!e.l&&Wi(e,i),o&&a&&Wi(e,o)}function Wi(e,t){js(t)||function r(n,{from:i,to:o,l:a,r:s}){Ln(n,i,o),a&&r(n,a),s&&r(n,s)}(e,t)}function lb(e,t){const r=ja(t);let n=r.next();if(n.done)return!1;let i=n.value;const o=ja(e);let a=o.next(i.from),s=a.value;for(;!n.done&&!a.done;){if(Ue(s.from,i.to)<=0&&Ue(s.to,i.from)>=0)return!0;Ue(i.from,s.from)<0?i=(n=r.next(s.from)).value:s=(a=o.next(i.from)).value}return!1}function ja(e){let t=js(e)?null:{s:0,n:e};return{next(r){const n=arguments.length>0;for(;t;)switch(t.s){case 0:if(t.s=1,n)for(;t.n.l&&Ue(r,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!n||Ue(r,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function Wu(e){var t,r;const n=(((t=e.r)===null||t===void 0?void 0:t.d)||0)-(((r=e.l)===null||r===void 0?void 0:r.d)||0),i=n>1?"r":n<-1?"l":"";if(i){const o=i==="r"?"l":"r",a={...e},s=e[i];e.from=s.from,e.to=s.to,e[i]=s[i],a[i]=s[o],e[o]=a,a.d=Hu(a)}e.d=Hu(e)}function Hu({r:e,l:t}){return(e?t?Math.max(e.d,t.d):e.d:t?t.d:0)+1}Jr(gt.prototype,{add(e){return Wi(this,e),this},addKey(e){return Ln(this,e,e),this},addKeys(e){return e.forEach(t=>Ln(this,t,t)),this},[ba](){return ja(this)}});const fb={stack:"dbcore",level:0,create:e=>{const t=e.schema.name,r=new gt(e.MIN_KEY,e.MAX_KEY);return{...e,table:n=>{const i=e.table(n),{schema:o}=i,{primaryKey:a}=o,{extractKey:s,outbound:u}=a,c={...i,mutate:h=>{const d=h.trans,y=d.mutatedParts||(d.mutatedParts={}),p=D=>{const E=`idb://${t}/${n}/${D}`;return y[E]||(y[E]=new gt)},b=p(""),m=p(":dels"),{type:g}=h;let[w,S]=h.type==="deleteRange"?[h.range]:h.type==="delete"?[h.keys]:h.values.length<50?[[],h.values]:[];const k=h.trans._cache;return i.mutate(h).then(D=>{if(Fe(w)){g!=="delete"&&(w=D.results),b.addKeys(w);const E=Of(w,k);E||g==="add"||m.addKeys(w),(E||S)&&function(I,A,N,G){function C(M){const _=I(M.name||"");function F(j){return j!=null?M.extractKey(j):null}const ee=j=>M.multiEntry&&Fe(j)?j.forEach(te=>_.addKey(te)):_.addKey(j);(N||G).forEach((j,te)=>{const L=N&&F(N[te]),J=G&&F(G[te]);Ue(L,J)!==0&&(L!=null&&ee(L),J!=null&&ee(J))})}A.indexes.forEach(C)}(p,o,E,S)}else if(w){const E={from:w.lower,to:w.upper};m.add(E),b.add(E)}else b.add(r),m.add(r),o.indexes.forEach(E=>p(E.name).add(r));return D})}},l=({query:{index:h,range:d}})=>{var y,p;return[h,new gt((y=d.lower)!==null&&y!==void 0?y:e.MIN_KEY,(p=d.upper)!==null&&p!==void 0?p:e.MAX_KEY)]},f={get:h=>[a,new gt(h.key)],getMany:h=>[a,new gt().addKeys(h.keys)],count:l,query:l,openCursor:l};return Se(f).forEach(h=>{c[h]=function(d){const{subscr:y}=re;if(y){const p=S=>{const k=`idb://${t}/${n}/${S}`;return y[k]||(y[k]=new gt)},b=p(""),m=p(":dels"),[g,w]=f[h](d);if(p(g.name||"").add(w),!g.isPrimaryKey){if(h!=="count"){const S=h==="query"&&u&&d.values&&i.query({...d,values:!1});return i[h].apply(this,arguments).then(k=>{if(h==="query"){if(u&&d.values)return S.then(({result:E})=>(b.addKeys(E),k));const D=d.values?k.result.map(s):k.result;d.values?b.addKeys(D):m.addKeys(D)}else if(h==="openCursor"){const D=k,E=d.values;return D&&Object.create(D,{key:{get:()=>(m.addKey(D.primaryKey),D.key)},primaryKey:{get(){const I=D.primaryKey;return m.addKey(I),I}},value:{get:()=>(E&&b.addKey(D.primaryKey),D.value)}})}return k})}m.add(r)}}return i[h].apply(this,arguments)}}),c}}}};class cr{constructor(t,r){this._middlewares={},this.verno=0;const n=cr.dependencies;this._options=r={addons:cr.addons,autoOpen:!0,indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange,...r},this._deps={indexedDB:r.indexedDB,IDBKeyRange:r.IDBKeyRange};const{addons:i}=r;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;const o={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:he,dbReadyPromise:null,cancelOpen:he,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3};var a;o.dbReadyPromise=new X(s=>{o.dbReadyResolve=s}),o.openCanceller=new X((s,u)=>{o.cancelOpen=u}),this._state=o,this.name=t,this.on=xn(this,"populate","blocked","versionchange","close",{ready:[Rs,he]}),this.on.ready.subscribe=Jl(this.on.ready.subscribe,s=>(u,c)=>{cr.vip(()=>{const l=this._state;if(l.openComplete)l.dbOpenError||X.resolve().then(u),c&&s(u);else if(l.onReadyBeingFired)l.onReadyBeingFired.push(u),c&&s(u);else{s(u);const f=this;c||s(function h(){f.on.ready.unsubscribe(u),f.on.ready.unsubscribe(h)})}})}),this.Collection=(a=this,hn(Qg.prototype,function(s,u){this.db=a;let c=bf,l=null;if(u)try{c=u()}catch(y){l=y}const f=s._ctx,h=f.table,d=h.hook.reading.fire;this._ctx={table:h,index:f.index,isPrimKey:!f.index||h.schema.primKey.keyPath&&f.index===h.schema.primKey.name,range:c,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:l,or:f.or,valueMapper:d!==$n?d:null}})),this.Table=function(s){return hn(Gg.prototype,function(u,c,l){this.db=s,this._tx=l,this.name=u,this.schema=c,this.hook=s._allTables[u]?s._allTables[u].hook:xn(null,{creating:[Mg,he],reading:[Tg,$n],updating:[$g,he],deleting:[Bg,he]})})}(this),this.Transaction=function(s){return hn(Xg.prototype,function(u,c,l,f,h){this.db=s,this.mode=u,this.storeNames=c,this.schema=l,this.chromeTransactionDurability=f,this.idbtrans=null,this.on=xn(this,"complete","error","abort"),this.parent=h||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new X((d,y)=>{this._resolve=d,this._reject=y}),this._completion.then(()=>{this.active=!1,this.on.complete.fire()},d=>{var y=this.active;return this.active=!1,this.on.error.fire(d),this.parent?this.parent._reject(d):y&&this.idbtrans&&this.idbtrans.abort(),De(d)})})}(this),this.Version=function(s){return hn(nb.prototype,function(u){this.db=s,this._cfg={version:u,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}(this),this.WhereClause=function(s){return hn(wf.prototype,function(u,c,l){this.db=s,this._ctx={table:u,index:c===":id"?null:c,or:l};const f=s._deps.indexedDB;if(!f)throw new oe.MissingAPI;this._cmp=this._ascending=f.cmp.bind(f),this._descending=(h,d)=>f.cmp(d,h),this._max=(h,d)=>f.cmp(h,d)>0?h:d,this._min=(h,d)=>f.cmp(h,d)<0?h:d,this._IDBKeyRange=s._deps.IDBKeyRange})}(this),this.on("versionchange",s=>{s.newVersion>0?console.warn(`Another connection wants to upgrade database '${this.name}'. Closing db now to resume the upgrade.`):console.warn(`Another connection wants to delete database '${this.name}'. Closing db now to resume the delete request.`),this.close()}),this.on("blocked",s=>{!s.newVersion||s.newVersion<s.oldVersion?console.warn(`Dexie.delete('${this.name}') was blocked`):console.warn(`Upgrade '${this.name}' blocked by other connection holding version ${s.oldVersion/10}`)}),this._maxKey=jn(r.IDBKeyRange),this._createTransaction=(s,u,c,l)=>new this.Transaction(s,u,c,this._options.chromeTransactionDurability,l),this._fireOnBlocked=s=>{this.on("blocked").fire(s),kn.filter(u=>u.name===this.name&&u!==this&&!u._state.vcFired).map(u=>u.on("versionchange").fire(s))},this.use(sb),this.use(ub),this.use(fb),this.use(cb),this.vip=Object.create(this,{_vip:{value:!0}}),i.forEach(s=>s(this))}version(t){if(isNaN(t)||t<.1)throw new oe.Type("Given version is not a positive number");if(t=Math.round(10*t)/10,this.idbdb||this._state.isBeingOpened)throw new oe.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,t);const r=this._versions;var n=r.filter(i=>i._cfg.version===t)[0];return n||(n=new this.Version(t),r.push(n),r.sort(tb),n.stores({}),this._state.autoSchema=!1,n)}_whenReady(t){return this.idbdb&&(this._state.openComplete||re.letThrough||this._vip)?t():new X((r,n)=>{if(this._state.openComplete)return n(new oe.DatabaseClosed(this._state.dbOpenError));if(!this._state.isBeingOpened){if(!this._options.autoOpen)return void n(new oe.DatabaseClosed);this.open().catch(he)}this._state.dbReadyPromise.then(r,n)}).then(t)}use({stack:t,create:r,level:n,name:i}){i&&this.unuse({stack:t,name:i});const o=this._middlewares[t]||(this._middlewares[t]=[]);return o.push({stack:t,create:r,level:n??10,name:i}),o.sort((a,s)=>a.level-s.level),this}unuse({stack:t,name:r,create:n}){return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter(i=>n?i.create!==n:!!r&&i.name!==r)),this}open(){return ob(this)}_close(){const t=this._state,r=kn.indexOf(this);if(r>=0&&kn.splice(r,1),this.idbdb){try{this.idbdb.close()}catch{}this._novip.idbdb=null}t.dbReadyPromise=new X(n=>{t.dbReadyResolve=n}),t.openCanceller=new X((n,i)=>{t.cancelOpen=i})}close(){this._close();const t=this._state;this._options.autoOpen=!1,t.dbOpenError=new oe.DatabaseClosed,t.isBeingOpened&&t.cancelOpen(t.dbOpenError)}delete(){const t=arguments.length>0,r=this._state;return new X((n,i)=>{const o=()=>{this.close();var a=this._deps.indexedDB.deleteDatabase(this.name);a.onsuccess=ye(()=>{(function({indexedDB:s,IDBKeyRange:u},c){!Ns(s)&&c!=="__dbnames"&&$s(s,u).delete(c).catch(he)})(this._deps,this.name),n()}),a.onerror=ct(i),a.onblocked=this._fireOnBlocked};if(t)throw new oe.InvalidArgument("Arguments not allowed in db.delete()");r.isBeingOpened?r.dbReadyPromise.then(o):o()})}backendDB(){return this.idbdb}isOpen(){return this.idbdb!==null}hasBeenClosed(){const t=this._state.dbOpenError;return t&&t.name==="DatabaseClosed"}hasFailed(){return this._state.dbOpenError!==null}dynamicallyOpened(){return this._state.autoSchema}get tables(){return Se(this._allTables).map(t=>this._allTables[t])}transaction(){const t=ab.apply(this,arguments);return this._transaction.apply(this,t)}_transaction(t,r,n){let i=re.trans;i&&i.db===this&&t.indexOf("!")===-1||(i=null);const o=t.indexOf("?")!==-1;let a,s;t=t.replace("!","").replace("?","");try{if(s=r.map(c=>{var l=c instanceof this.Table?c.name:c;if(typeof l!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return l}),t=="r"||t==="readonly")a="readonly";else{if(t!="rw"&&t!="readwrite")throw new oe.InvalidArgument("Invalid transaction mode: "+t);a="readwrite"}if(i){if(i.mode==="readonly"&&a==="readwrite"){if(!o)throw new oe.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");i=null}i&&s.forEach(c=>{if(i&&i.storeNames.indexOf(c)===-1){if(!o)throw new oe.SubTransaction("Table "+c+" not included in parent transaction.");i=null}}),o&&i&&!i.active&&(i=null)}}catch(c){return i?i._promise(null,(l,f)=>{f(c)}):De(c)}const u=Sf.bind(null,this,a,s,i,n);return i?i._promise(a,u,"lock"):re.trans?sn(re.transless,()=>this._whenReady(u)):this._whenReady(u)}table(t){if(!Je(this._allTables,t))throw new oe.InvalidTable(`Table ${t} does not exist`);return this._allTables[t]}}const hb=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable";class db{constructor(t){this._subscribe=t}subscribe(t,r,n){return this._subscribe(t&&typeof t!="function"?t:{next:t,error:r,complete:n})}[hb](){return this}}function Cf(e,t){return Se(t).forEach(r=>{Wi(e[r]||(e[r]=new gt),t[r])}),e}function pb(e){return new db(t=>{const r=As(e);let n=!1,i={},o={};const a={get closed(){return n},unsubscribe:()=>{n=!0,Yt.storagemutated.unsubscribe(l)}};t.start&&t.start(a);let s=!1,u=!1;function c(){return Se(o).some(h=>i[h]&&lb(i[h],o[h]))}const l=h=>{Cf(i,h),c()&&f()},f=()=>{if(s||n)return;i={};const h={},d=function(y){r&&an();const p=()=>Qt(e,{subscr:y,trans:null}),b=re.trans?sn(re.transless,p):p();return r&&b.then(It,It),b}(h);u||(Yt("storagemutated",l),u=!0),s=!0,Promise.resolve(d).then(y=>{s=!1,n||(c()?f():(i={},o=h,t.next&&t.next(y)))},y=>{["DatabaseClosedError","AbortError"].includes(y==null?void 0:y.name)||(s=!1,t.error&&t.error(y),a.unsubscribe())})};return f(),a})}let La;try{La={indexedDB:me.indexedDB||me.mozIndexedDB||me.webkitIndexedDB||me.msIndexedDB,IDBKeyRange:me.IDBKeyRange||me.webkitIDBKeyRange}}catch{La={indexedDB:null,IDBKeyRange:null}}const er=cr;function Oi(e){let t=Et;try{Et=!0,Yt.storagemutated.fire(e)}finally{Et=t}}Jr(er,{..._i,delete:e=>new er(e,{addons:[]}).delete(),exists:e=>new er(e,{addons:[]}).open().then(t=>(t.close(),!0)).catch("NoSuchDatabaseError",()=>!1),getDatabaseNames(e){try{return function({indexedDB:t,IDBKeyRange:r}){return Ns(t)?Promise.resolve(t.databases()).then(n=>n.map(i=>i.name).filter(i=>i!=="__dbnames")):$s(t,r).toCollection().primaryKeys()}(er.dependencies).then(e)}catch{return De(new oe.MissingAPI)}},defineClass:()=>function(e){Ke(this,e)},ignoreTransaction:e=>re.trans?sn(re.transless,e):e(),vip:Na,async:function(e){return function(){try{var t=Fa(e.apply(this,arguments));return t&&typeof t.then=="function"?t:X.resolve(t)}catch(r){return De(r)}}},spawn:function(e,t,r){try{var n=Fa(e.apply(r,t||[]));return n&&typeof n.then=="function"?n:X.resolve(n)}catch(i){return De(i)}},currentTransaction:{get:()=>re.trans||null},waitFor:function(e,t){const r=X.resolve(typeof e=="function"?er.ignoreTransaction(e):e).timeout(t||6e4);return re.trans?re.trans.waitFor(r):r},Promise:X,debug:{get:()=>pt,set:e=>{af(e,e==="dexie"?()=>!0:gf)}},derive:jr,extend:Ke,props:Jr,override:Jl,Events:xn,on:Yt,liveQuery:pb,extendObservabilitySet:Cf,getByKeyPath:Ot,setByKeyPath:nt,delByKeyPath:function(e,t){typeof t=="string"?nt(e,t,void 0):"length"in t&&[].map.call(t,function(r){nt(e,r,void 0)})},shallowClone:rf,deepClone:Qn,getObjectDiff:Fs,cmp:Ue,asap:ef,minKey:-(1/0),addons:[],connections:kn,errnames:Is,dependencies:La,semVer:"4.0.0-alpha.4",version:"4.0.0-alpha.4".split(".").map(e=>parseInt(e)).reduce((e,t,r)=>e+t/Math.pow(10,2*r))}),er.maxKey=jn(er.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Yt("storagemutated",e=>{if(!Et){let t;so?(t=document.createEvent("CustomEvent"),t.initCustomEvent("x-storagemutated-1",!0,!0,e)):t=new CustomEvent("x-storagemutated-1",{detail:e}),Et=!0,dispatchEvent(t),Et=!1}}),addEventListener("x-storagemutated-1",({detail:e})=>{Et||Oi(e)}));let Et=!1;if(typeof BroadcastChannel<"u"){const e=new BroadcastChannel("x-storagemutated-1");typeof e.unref=="function"&&e.unref(),Yt("storagemutated",t=>{Et||e.postMessage(t)}),e.onmessage=t=>{t.data&&Oi(t.data)}}else if(typeof self<"u"&&typeof navigator<"u"){Yt("storagemutated",t=>{try{Et||(typeof localStorage<"u"&&localStorage.setItem("x-storagemutated-1",JSON.stringify({trig:Math.random(),changedParts:t})),typeof self.clients=="object"&&[...self.clients.matchAll({includeUncontrolled:!0})].forEach(r=>r.postMessage({type:"x-storagemutated-1",changedParts:t})))}catch{}}),typeof addEventListener<"u"&&addEventListener("storage",t=>{if(t.key==="x-storagemutated-1"){const r=JSON.parse(t.newValue);r&&Oi(r.changedParts)}});const e=self.document&&navigator.serviceWorker;e&&e.addEventListener("message",function({data:t}){t&&t.type==="x-storagemutated-1"&&Oi(t.changedParts)})}X.rejectionMapper=function(e,t){if(!e||e instanceof Lr||e instanceof TypeError||e instanceof SyntaxError||!e.name||!Nu[e.name])return e;var r=new Nu[e.name](t||e.message,e);return"stack"in e&&St(r,"stack",{get:function(){return this.inner.stack}}),r},af(pt,gf);var Hi="docs",Gu="deleted-docs",mb="changes",Df="dexie",Af=wv,Qu=new Map,Ci=new Map;function yb(e,t,r,n){var i=ot(n.primaryKey),o="rxdb-dexie-"+e+"--"+n.version+"--"+t,a=hr(Qu,o,()=>{var s=(async()=>{var u=Re(r);u.autoOpen=!1;var c=new cr(o,u),l={[Hi]:bb(n),[mb]:"++sequence, id",[Gu]:i+",_meta.lwt,[_meta.lwt+"+i+"]"};return c.version(1).stores(l),await c.open(),{dexieDb:c,dexieTable:c[Hi],dexieDeletedTable:c[Gu]}})();return Qu.set(o,a),Ci.set(a,0),s});return a}async function vb(e){var t=await e,r=Ci.get(e),n=r-1;n===0?(t.dexieDb.close(),Ci.delete(e)):Ci.set(e,n)}function gb(e){if(e.indexes){var t=new Set;e.indexes.forEach(r=>{var n=Xa(r);n.forEach(i=>{if(!t.has(i)){t.add(i);var o=Gt(e,i);if(o.type==="boolean")throw q("DXE1",{schema:e,index:r,field:i})}})})}}var za="__";function vr(e){var t=e.split(".");if(t.length>1)return t.map(n=>vr(n)).join(".");if(e.startsWith("|")){var r=e.substring(1);return za+r}else return e}function Pf(e){var t=e.split(".");if(t.length>1)return t.map(n=>Pf(n)).join(".");if(e.startsWith(za)){var r=e.substring(za.length);return"|"+r}else return e}function Gi(e){if(!e||typeof e=="string"||typeof e=="number"||typeof e=="boolean")return e;if(Array.isArray(e))return e.map(r=>Gi(r));if(typeof e=="object"){var t={};return Object.entries(e).forEach(([r,n])=>{typeof n=="object"&&(n=Gi(n)),t[vr(r)]=n}),t}}function Ur(e){if(!e||typeof e=="string"||typeof e=="number"||typeof e=="boolean")return e;if(Array.isArray(e))return e.map(r=>Ur(r));if(typeof e=="object"){var t={};return Object.entries(e).forEach(([r,n])=>{(typeof n=="object"||Array.isArray(e))&&(n=Ur(n)),t[Pf(r)]=n}),t}}function bb(e){var t=[],r=ot(e.primaryKey);return t.push([r]),e.indexes&&e.indexes.forEach(n=>{var i=Xa(n);t.push(i)}),t.push(["_meta.lwt",r]),t=t.map(n=>n.map(i=>vr(i))),t.map(n=>n.length===1?n[0]:"["+n.join("+")+"]").join(", ")}async function Vu(e,t){var r=await e,[n,i]=await Promise.all([r.dexieTable.bulkGet(t),r.dexieDeletedTable.bulkGet(t)]),o=i.slice(0);return n.forEach((a,s)=>{a&&(o[s]=a)}),o}function Yu(e){return e===ir?-1/0:e}function If(e,t){if(!t){if(typeof window>"u")throw new Error("IDBKeyRange missing");t=window.IDBKeyRange}var r=e.startKeys.map(Yu),n=e.endKeys.map(Yu),i;if(e.index.length===1){var o=r[0]===n[0];i=t.bound(r[0],n[0],o?!1:e.inclusiveStart,o?!1:e.inclusiveEnd)}else i=t.bound(r,n,e.inclusiveStart,e.inclusiveEnd);return i}async function _b(e,t){var r=await e.internals,n=t.query,i=n.skip?n.skip:0,o=n.limit?n.limit:1/0,a=i+o,s=t.queryPlan,u=!1;s.selectorSatisfiedByIndex||(u=vs(e.schema,t.query));var c=If(s,r.dexieDb._options.IDBKeyRange),l=s.index,f=[];if(await r.dexieDb.transaction("r",r.dexieTable,async d=>{var y=d.idbtrans,p=y.objectStore(Hi),b;if(l.length===1&&l[0]===e.primaryPath)b=p;else{var m;l.length===1?m=vr(l[0]):m="["+l.map(w=>vr(w)).join("+")+"]",b=p.index(m)}var g=b.openCursor(c);await new Promise(w=>{g.onsuccess=function(S){var k=S.target.result;if(k){var D=Ur(k.value);!D._deleted&&(!u||u(D))&&f.push(D),s.sortFieldsSameAsIndexFields&&f.length===a?w():k.continue()}else w()}})}),!s.sortFieldsSameAsIndexFields){var h=Al(e.schema,t.query);f=f.sort(h)}return f=f.slice(i,a),{documents:f}}async function wb(e,t){var r=await e.internals,n=t.queryPlan,i=n.index,o=If(n,r.dexieDb._options.IDBKeyRange),a=-1;return await r.dexieDb.transaction("r",r.dexieTable,async s=>{var u=s.idbtrans,c=u.objectStore(Hi),l;if(i.length===1&&i[0]===e.primaryPath)l=c;else{var f;i.length===1?f=vr(i[0]):f="["+i.map(d=>vr(d)).join("+")+"]",l=c.index(f)}var h=l.count(o);a=await new Promise((d,y)=>{h.onsuccess=function(){d(h.result)},h.onerror=p=>y(p)})}),a}var kb=ze(),xb=function(){function e(r,n,i,o,a,s,u){this.changes$=new Ht,this.instanceId=kb++,this.closed=!1,this.storage=r,this.databaseName=n,this.collectionName=i,this.schema=o,this.internals=a,this.options=s,this.settings=u,this.primaryPath=ot(this.schema.primaryKey)}var t=e.prototype;return t.bulkWrite=async function(n,i){vt(this),n.forEach(f=>{if(!f.document._rev||f.previous&&!f.previous._rev)throw q("SNH",{args:{row:f}})});var o=await this.internals,a={success:{},error:{}},s=n.map(f=>f.document[this.primaryPath]),u;if(await o.dexieDb.transaction("rw",o.dexieTable,o.dexieDeletedTable,async()=>{var f=new Map,h=await Vu(this.internals,s);h.forEach(m=>{var g=m&&Ur(m);return g&&f.set(g[this.primaryPath],g),g}),u=Ep(this,this.primaryPath,f,n,i),a.error=u.errors;var d=[],y=[],p=[],b=[];u.bulkInsertDocs.forEach(m=>{var g=m.document[this.primaryPath];a.success[g]=m.document,d.push(m.document)}),u.bulkUpdateDocs.forEach(m=>{var g=m.document[this.primaryPath];if(a.success[g]=m.document,m.document._deleted&&m.previous&&!m.previous._deleted)y.push(g),p.push(m.document);else if(m.document._deleted&&m.previous&&m.previous._deleted)p.push(m.document);else if(!m.document._deleted)d.push(m.document);else throw q("SNH",{args:{row:m}})}),await Promise.all([d.length>0?o.dexieTable.bulkPut(d.map(m=>Gi(m))):lt,y.length>0?o.dexieTable.bulkDelete(y):lt,p.length>0?o.dexieDeletedTable.bulkPut(p.map(m=>Gi(m))):lt,b.length>0?o.dexieDeletedTable.bulkDelete(b):lt])}),u=_e(u),u.eventBulk.events.length>0){var c=_e(u.newestRow).document;u.eventBulk.checkpoint={id:c[this.primaryPath],lwt:c._meta.lwt};var l=ze();u.eventBulk.events.forEach(f=>f.endTime=l),this.changes$.next(u.eventBulk)}return a},t.findDocumentsById=async function(n,i){vt(this);var o=await this.internals,a={};return await o.dexieDb.transaction("r",o.dexieTable,o.dexieDeletedTable,async()=>{var s;i?s=await Vu(this.internals,n):s=await o.dexieTable.bulkGet(n),n.forEach((u,c)=>{var l=s[c];l&&(!l._deleted||i)&&(a[u]=Ur(l))})}),a},t.query=function(n){return vt(this),_b(this,n)},t.count=async function(n){var i=await wb(this,n);return{count:i,mode:"fast"}},t.getChangedDocumentsSince=async function(n,i){vt(this);var o=i?i.lwt:Ja,a=i?i.id:"",s=await this.internals,[u,c]=await Promise.all([s.dexieTable,s.dexieDeletedTable].map(async h=>{var d=h.where("[_meta.lwt+"+this.primaryPath+"]").above([o,a]).limit(n),y=await d.toArray();return y.map(p=>Ur(p))})),l=u.slice(0);Zi(l,c),l=Xh(this.primaryPath,l),l=l.slice(0,n);var f=Hh(l);return{documents:l,checkpoint:f?{id:f[this.primaryPath],lwt:f._meta.lwt}:i||{id:"",lwt:0}}},t.remove=async function(){vt(this);var n=await this.internals;return await Promise.all([n.dexieDeletedTable.clear(),n.dexieTable.clear()]),this.close()},t.changeStream=function(){return vt(this),this.changes$.asObservable()},t.cleanup=async function(n){vt(this);var i=await this.internals;return await i.dexieDb.transaction("rw",i.dexieDeletedTable,async()=>{var o=ze()-n,a=await i.dexieDeletedTable.where("_meta.lwt").below(o).toArray(),s=a.map(u=>u[this.primaryPath]);await i.dexieDeletedTable.bulkDelete(s)}),!0},t.getAttachmentData=function(n,i,o){throw vt(this),new Error("Attachments are not implemented in the dexie RxStorage. Make a pull request.")},t.close=function(){return vt(this),this.closed=!0,this.changes$.complete(),vb(this.internals),lt},t.conflictResultionTasks=function(){return new Ht},t.resolveConflictResultionTask=async function(n){},e}();function Eb(e,t,r){var n=yb(t.databaseName,t.collectionName,r,t.schema),i=new xb(e,t.databaseName,t.collectionName,t.schema,n,t.options,r);return kg(Df,t,i),Promise.resolve(i)}function vt(e){if(e.closed)throw new Error("RxStorageInstanceDexie is closed "+e.databaseName+"-"+e.collectionName)}var Sb=function(){function e(r){this.name=Df,this.statics=Af,this.settings=r}var t=e.prototype;return t.createStorageInstance=function(n){return Cp(n),gb(n.schema),Eb(this,n,this.settings)},e}();function Ob(e={}){var t=new Sb(e);return t}var Zu={UT1:"given name is no string or empty",UT2:`collection- and database-names must match the regex to be compatible with couchdb databases.
    See https://neighbourhood.ie/blog/2020/10/13/everything-you-need-to-know-about-couchdb-database-names/
    info: if your database-name specifies a folder, the name must contain the slash-char '/' or '\\'`,UT3:"replication-direction must either be push or pull or both. But not none",UT4:"given leveldown is no valid adapter",UT5:"keyCompression is set to true in the schema but no key-compression handler is used in the storage",UT6:"schema contains encrypted fields but no encryption handler is used in the storage",UT7:"attachments.compression is enabled but no attachment-compression plugin is used",PL1:"Given plugin is not RxDB plugin.",PL3:"A plugin with the same name was already added but it was not the exact same JavaScript object",P2:"bulkWrite() cannot be called with an empty array",QU1:"RxQuery._execOverDatabase(): op not known",QU4:"RxQuery.regex(): You cannot use .regex() on the primary field",QU5:"RxQuery.sort(): does not work because key is not defined in the schema",QU6:"RxQuery.limit(): cannot be called on .findOne()",QU9:"throwIfMissing can only be used in findOne queries",QU10:"result empty and throwIfMissing: true",QU11:"RxQuery: no valid query params given",QU12:"Given index is not in schema",QU13:"A top level field of the query is not included in the schema",QU14:"Running a count() query in slow mode is now allowed. Either run a count() query with a selector that fully matches an index or set allowSlowCount=true when calling the createRxDatabase",QU15:"For count queries it is not allowed to use skip or limit",MQ1:"path must be a string or object",MQ2:"Invalid argument",MQ3:"Invalid sort() argument. Must be a string, object, or array",MQ4:"Invalid argument. Expected instanceof mquery or plain object",MQ5:"method must be used after where() when called with these arguments",MQ6:"Can't mix sort syntaxes. Use either array or object | .sort([['field', 1], ['test', -1]]) | .sort({ field: 1, test: -1 })",MQ7:"Invalid sort value",MQ8:"Can't mix sort syntaxes. Use either array or object",DB1:"RxDocument.prepare(): another instance on this adapter has a different password",DB2:"RxDatabase.addCollections(): collection-names cannot start with underscore _",DB3:"RxDatabase.addCollections(): collection already exists. use myDatabase.[collectionName] to get it",DB4:"RxDatabase.addCollections(): schema is missing",DB5:"RxDatabase.addCollections(): collection-name not allowed",DB6:"RxDatabase.addCollections(): another instance created this collection with a different schema. Read this https://pubkey.github.io/rxdb/questions-answers.html#cant-change-the-schema",DB8:`RxDatabase.create(): A RxDatabase with the same name and adapter already exists.
Make sure to use this combination only once or set ignoreDuplicate to true if you do this intentional`,DB11:"createRxDatabase(): Invalid db-name, folder-paths must not have an ending slash",DB12:"RxDatabase.addCollections(): could not write to internal store",COL1:"RxDocument.insert() You cannot insert an existing document",COL2:"RxCollection.insert() fieldName ._id can only be used as primaryKey",COL3:"RxCollection.upsert() does not work without primary",COL4:"RxCollection.incrementalUpsert() does not work without primary",COL5:"RxCollection.find() if you want to search by _id, use .findOne(_id)",COL6:"RxCollection.findOne() needs a queryObject or string",COL7:"hook must be a function",COL8:"hooks-when not known",COL9:"RxCollection.addHook() hook-name not known",COL10:"RxCollection .postCreate-hooks cannot be async",COL11:"migrationStrategies must be an object",COL12:"A migrationStrategy is missing or too much",COL13:"migrationStrategy must be a function",COL14:"given static method-name is not a string",COL15:"static method-names cannot start with underscore _",COL16:"given static method is not a function",COL17:"RxCollection.ORM: statics-name not allowed",COL18:"collection-method not allowed because fieldname is in the schema",COL20:"Storage write error",CONFLICT:"Document update conflict. When changing a document you must work on the previous revision",DOC1:"RxDocument.get$ cannot get observable of in-array fields because order cannot be guessed",DOC2:"cannot observe primary path",DOC3:"final fields cannot be observed",DOC4:"RxDocument.get$ cannot observe a non-existed field",DOC5:"RxDocument.populate() cannot populate a non-existed field",DOC6:"RxDocument.populate() cannot populate because path has no ref",DOC7:"RxDocument.populate() ref-collection not in database",DOC8:"RxDocument.set(): primary-key cannot be modified",DOC9:"final fields cannot be modified",DOC10:"RxDocument.set(): cannot set childpath when rootPath not selected",DOC11:"RxDocument.save(): can't save deleted document",DOC13:"RxDocument.remove(): Document is already deleted",DOC14:"RxDocument.destroy() does not exist",DOC15:"query cannot be an array",DOC16:"Since version 8.0.0 RxDocument.set() can only be called on temporary RxDocuments",DOC17:"Since version 8.0.0 RxDocument.save() can only be called on non-temporary documents",DOC18:"Document property for composed primary key is missing",DOC19:"Value of primary key(s) cannot be changed",DOC20:"PrimaryKey missing",DOC21:"PrimaryKey must be equal to PrimaryKey.trim(). It cannot start or end with a whitespace",DOC22:"PrimaryKey must not contain a linebreak",DOC23:'PrimaryKey must not contain a double-quote ["]',DM1:"migrate() Migration has already run",DM2:"migration of document failed final document does not match final schema",DM3:"migration already running",AT1:"to use attachments, please define this in your schema",EN1:"password is not valid",EN2:"validatePassword: min-length of password not complied",EN3:"Schema contains encrypted properties but no password is given",EN4:"Password not valid",JD1:"You must create the collections before you can import their data",JD2:"RxCollection.importJSON(): the imported json relies on a different schema",JD3:"RxCollection.importJSON(): json.passwordHash does not match the own",LD1:"RxDocument.allAttachments$ can't use attachments on local documents",LD2:"RxDocument.get(): objPath must be a string",LD3:"RxDocument.get$ cannot get observable of in-array fields because order cannot be guessed",LD4:"cannot observe primary path",LD5:"RxDocument.set() id cannot be modified",LD6:"LocalDocument: Function is not usable on local documents",LD7:"Local document already exists",LD8:"localDocuments not activated. Set localDocuments=true on creation, when you want to store local documents on the RxDatabase or RxCollection.",RC1:"Replication: already added",RC2:"replicateCouchDB() query must be from the same RxCollection",RC4:"RxCouchDBReplicationState.awaitInitialReplication() cannot await initial replication when live: true",RC5:"RxCouchDBReplicationState.awaitInitialReplication() cannot await initial replication if multiInstance because the replication might run on another instance",RC6:"syncFirestore() serverTimestampField MUST NOT be part of the collections schema and MUST NOT be nested.",RC_PULL:"RxReplication pull handler threw an error - see .errors for more details",RC_STREAM:"RxReplication pull stream$ threw an error - see .errors for more details",RC_PUSH:"RxReplication push handler threw an error - see .errors for more details",RC_PUSH_NO_AR:"RxReplication push handler did not return an array with the conflicts",RC_P2P_PEER:"RxReplication P2P Peer has error",RC_COUCHDB_1:"replicateCouchDB() url must end with a slash like 'https://example.com/mydatabase/'",RC_COUCHDB_2:"replicateCouchDB() did not get valid result with rows.",SC1:"fieldnames do not match the regex",SC2:"SchemaCheck: name 'item' reserved for array-fields",SC3:"SchemaCheck: fieldname has a ref-array but items-type is not string",SC4:"SchemaCheck: fieldname has a ref but is not type string, [string,null] or array<string>",SC6:"SchemaCheck: primary can only be defined at top-level",SC7:"SchemaCheck: default-values can only be defined at top-level",SC8:"SchemaCheck: first level-fields cannot start with underscore _",SC10:"SchemaCheck: schema defines ._rev, this will be done automatically",SC11:"SchemaCheck: schema needs a number >=0 as version",SC13:"SchemaCheck: primary is always index, do not declare it as index",SC14:"SchemaCheck: primary is always unique, do not declare it as index",SC15:"SchemaCheck: primary cannot be encrypted",SC16:"SchemaCheck: primary must have type: string",SC17:"SchemaCheck: top-level fieldname is not allowed",SC18:"SchemaCheck: indexes must be an array",SC19:"SchemaCheck: indexes must contain strings or arrays of strings",SC20:"SchemaCheck: indexes.array must contain strings",SC21:"SchemaCheck: given index is not defined in schema",SC22:"SchemaCheck: given indexKey is not type:string",SC23:"SchemaCheck: fieldname is not allowed",SC24:"SchemaCheck: required fields must be set via array. See https://spacetelescope.github.io/understanding-json-schema/reference/object.html#required",SC25:"SchemaCheck: compoundIndexes needs to be specified in the indexes field",SC26:"SchemaCheck: indexes needs to be specified at collection schema level",SC27:"SchemaCheck: encrypted fields need to be specified at collection schema level",SC28:"SchemaCheck: encrypted fields is not defined in the schema",SC29:"SchemaCheck: missing object key 'properties'",SC30:"SchemaCheck: primaryKey is required",SC32:"SchemaCheck: primary field must have the type string/number/integer",SC33:"SchemaCheck: used primary key is not a property in the schema",SC34:"Fields of type string that are used in an index, must have set the maxLength attribute in the schema",SC35:"Fields of type number/integer that are used in an index, must have set the multipleOf attribute in the schema",SC36:"A field of this type cannot be used as index",SC37:"Fields of type number that are used in an index, must have set the minimum and maximum attribute in the schema",SC38:"Fields of type boolean that are used in an index, must be required in the schema",SC39:"The primary key must have the maxLength attribute set",VD1:"Sub-schema not found, does the schemaPath exists in your schema?",VD2:"object does not match schema",S1:"You cannot create collections after calling RxDatabase.server()",GQL1:"GraphQL replication: cannot find sub schema by key",GQL3:"GraphQL replication: pull returns more documents then batchSize",CRDT1:"CRDT operations cannot be used because the crdt options are not set in the schema.",CRDT2:"RxDocument.incrementalModify() cannot be used when CRDTs are activated.",CRDT3:"To use CRDTs you MUST NOT set a conflictHandler because the default CRDT conflict handler must be used",DXE1:"The dexie.js RxStorage does not support boolean indexes, see https://rxdb.info/rx-storage-dexie.html#boolean-index",SNH:"This should never happen"},Mo;function Cb(){if(!Mo){var e=new _s,t=Object.getOwnPropertyNames(e),r=Object.getOwnPropertyNames(Object.getPrototypeOf(e));Mo=[...t,...r]}return Mo}var Bo;function Db(){if(!Bo){var e=new ks("pseudoInstance","memory"),t=Object.getOwnPropertyNames(e),r=Object.getOwnPropertyNames(Object.getPrototypeOf(e));Bo=[...t,...r],e.destroy()}return Bo}var Ab=dl(qn),Pb=new Ab,$o;function Rf(){if(!$o){var e=["deleted","synced"],t=Object.getOwnPropertyNames(Pb),r=Object.getOwnPropertyNames(qn);$o=[...t,...r,...e]}return $o}function Ib(e){if(e!=="_deleted"){if(["properties"].includes(e))throw q("SC23",{fieldName:e});var t="^[a-zA-Z](?:[[a-zA-Z0-9_]*]?[a-zA-Z0-9])?$",r=new RegExp(t);if(e!=="_id"&&!e.match(r))throw q("SC1",{regex:t,fieldName:e})}}function Rb(e){var t=ot(e.primaryKey);function r(i,o,a){if(typeof i=="string"&&typeof o=="object"&&!Array.isArray(o)&&Ib(i),o.hasOwnProperty("item")&&o.type!=="array")throw q("SC2",{fieldName:i});if(o.hasOwnProperty("required")&&typeof o.required=="boolean")throw q("SC24",{fieldName:i});if(o.hasOwnProperty("ref"))if(Array.isArray(o.type)){if(o.type.length>2||!o.type.includes("string")||!o.type.includes("null"))throw q("SC4",{fieldName:i})}else switch(o.type){case"string":break;case"array":if(!o.items||!o.items.type||o.items.type!=="string")throw q("SC3",{fieldName:i});break;default:throw q("SC4",{fieldName:i})}var s=a.split(".").length>=2;if(s){if(o.primary)throw q("SC6",{path:a,primary:o.primary});if(o.default)throw q("SC7",{path:a})}if(!s){if(i==="_id"&&t!=="_id")throw q("COL2",{fieldName:i});if(i.charAt(0)==="_"){if(i==="_id"||i==="_deleted")return;throw q("SC8",{fieldName:i})}}}function n(i,o){!i||typeof i!="object"||Object.keys(i).forEach(a=>{var s=i[a];!i.properties&&s&&typeof s=="object"&&!Array.isArray(i)&&r(a,s,o);var u=o;a!=="properties"&&(u=u+"."+a),n(s,u)})}return n(e,""),!0}function Tb(e){if(!e.primaryKey)throw q("SC30",{schema:e});function t(u){if(!u)throw q("SC33",{schema:e});var c=u.type;if(!c||!["string","number","integer"].includes(c))throw q("SC32",{schema:e,args:{schemaPart:u}})}if(typeof e.primaryKey=="string"){var r=e.primaryKey,n=e.properties[r];t(n)}else{var i=e.primaryKey,o=Gt(e,i.key);t(o),i.fields.forEach(u=>{var c=Gt(e,u);t(c)})}var a=ot(e.primaryKey),s=e.properties[a];if(!s.maxLength)throw q("SC39",{schema:e,args:{primaryPathSchemaPart:s}})}function Xu(e){for(var t=e.split("."),r="",n=0;n<t.length;n+=1)t[n]!=="[]"?r=r.concat(".properties.".concat(t[n])):r=r.concat(".items");return Cn(r)}function Mb(e){if(!e.primaryKey)throw q("SC30",{schema:e});if(!e.hasOwnProperty("properties"))throw q("SC29",{schema:e});if(e.properties._rev)throw q("SC10",{schema:e});if(!e.hasOwnProperty("version")||typeof e.version!="number"||e.version<0)throw q("SC11",{version:e.version});if(Rb(e),Tb(e),Object.keys(e.properties).forEach(t=>{var r=e.properties[t];if(t===e.primaryKey){if(e.indexes&&e.indexes.includes(t))throw q("SC13",{value:r,schema:e});if(r.unique)throw q("SC14",{value:r,schema:e});if(e.encrypted&&e.encrypted.includes(t))throw q("SC15",{value:r,schema:e});if(r.type!=="string")throw q("SC16",{value:r,schema:e})}if(Rf().includes(t))throw q("SC17",{key:t,schema:e})}),e.indexes){if(!Br(e.indexes))throw q("SC18",{indexes:e.indexes,schema:e});e.indexes.forEach(t=>{if(!(typeof t=="string"||Array.isArray(t)))throw q("SC19",{index:t,schema:e});if(Array.isArray(t)){for(var r=0;r<t.length;r+=1)if(typeof t[r]!="string")throw q("SC20",{index:t,schema:e})}var n=Br(t)?t:[t];n.forEach(i=>{var o=Gt(e,i),a=o.type;switch(a){case"string":var s=o.maxLength;if(!s)throw q("SC34",{index:t,field:i,schema:e});break;case"number":case"integer":var u=o.multipleOf;if(!u)throw q("SC35",{index:t,field:i,schema:e});var c=o.maximum,l=o.minimum;if(typeof c>"u"||typeof l>"u")throw q("SC37",{index:t,field:i,schema:e});break;case"boolean":var f="",h=i;if(i.includes(".")){var d=i.split(".");h=d.pop(),f=d.join(".")}var y=f===""?e:Gt(e,f);if(!y.required||!y.required.includes(h))throw q("SC38",{index:t,field:i,schema:e});break;default:throw q("SC36",{fieldName:i,type:o.type,schema:e})}})})}Object.keys(Yo(e)).map(t=>{var r=t.split(".");return r.pop(),r.join(".")}).filter(t=>t!=="").filter((t,r,n)=>n.indexOf(t)===r).filter(t=>{var r=jt(e,t);return r&&!!r.index}).forEach(t=>{throw t=t.replace("properties.",""),t=t.replace(/\.properties\./g,"."),q("SC26",{index:Cn(t),schema:e})}),(e.indexes||[]).reduce((t,r)=>(Br(r)?Zi(t,r):t.push(r),t),[]).filter((t,r,n)=>n.indexOf(t)===r).map(t=>{var r=Xu(t),n=jt(e,r);if(!n||typeof n!="object")throw q("SC21",{index:t,schema:e});return{indexPath:t,schemaObj:n}}).filter(t=>t.schemaObj.type!=="string"&&t.schemaObj.type!=="integer"&&t.schemaObj.type!=="number"&&t.schemaObj.type!=="boolean").forEach(t=>{throw q("SC22",{key:t.indexPath,type:t.schemaObj.type,schema:e})}),Object.keys(Yo(e)).map(t=>{var r=t.split(".");return r.pop(),r.join(".")}).filter(t=>t!==""&&t!=="attachments").filter((t,r,n)=>n.indexOf(t)===r).filter(t=>{var r=jt(e,t);return r&&!!r.encrypted}).forEach(t=>{throw t=t.replace("properties.",""),t=t.replace(/\.properties\./g,"."),q("SC27",{index:Cn(t),schema:e})}),e.encrypted&&e.encrypted.forEach(t=>{var r=Xu(t),n=jt(e,r);if(!n||typeof n!="object")throw q("SC28",{field:t,schema:e})})}function No(e){e&&Object.entries(e).forEach(([t,r])=>{if(typeof t!="string")throw Ze("COL14",{name:t});if(t.startsWith("_"))throw Ze("COL15",{name:t});if(typeof r!="function")throw Ze("COL16",{name:t,type:typeof t});if(Cb().includes(t)||Rf().includes(t))throw q("COL17",{name:t})})}function Bb(e,t){var r=Object.keys(e.properties);t&&Object.keys(t).filter(n=>r.includes(n)).forEach(n=>{throw q("COL18",{funName:n})})}function $b(e,t){if(typeof t!="object"||Array.isArray(t))throw Ze("COL11",{schema:e});var r=Tp(e);if(r.length!==Object.keys(t).length)throw q("COL12",{have:Object.keys(t),should:r});return r.map(n=>({v:n,s:t[n+1]})).filter(n=>typeof n.s!="function").forEach(n=>{throw Ze("COL13",{version:n.v,type:typeof n,schema:e})}),!0}function Nb(e){if(Db().includes(e.name))throw q("DB5",{name:e.name});Mf(e.name)}function Fb(e){if(Mf(e.name),Tc(e.name)&&(e.name.endsWith("/")||e.name.endsWith("\\")))throw q("DB11",{name:e.name})}var Tf="^[a-z][_$a-z0-9\\-]*$",jb=new RegExp(Tf);function Mf(e){if(typeof e!="string"||e.length===0)throw Ze("UT1",{name:e});if(Tc(e))return!0;if(!e.match(jb)&&e!==":memory:")throw q("UT2",{regex:Tf,givenName:e});return!0}function Lb(e){var t=Object.prototype.toString.call(e.queryObj)==="[object Object]";if(!t)throw Ze("QU11",{op:e.op,collection:e.collection.name,queryObj:e.queryObj});var r=["selector","limit","skip","sort","index"];if(Object.keys(e.queryObj).forEach(n=>{if(!r.includes(n))throw Ze("QU11",{op:e.op,collection:e.collection.name,queryObj:e.queryObj,key:n,args:{validKeys:r}})}),e.op==="count"&&(e.queryObj.limit||e.queryObj.skip))throw q("QU15",{collection:e.collection.name,query:e.queryObj})}function zb(e){var t=e.rxQuery.collection.schema.jsonSchema,r=e.mangoQuery.selector,n=Object.keys(t.properties);Object.keys(r).filter(s=>!s.startsWith("$")).filter(s=>!s.includes(".")).forEach(s=>{if(!n.includes(s))throw q("QU13",{schema:t,field:s,query:e.mangoQuery})});var i=t.indexes?t.indexes:[],o=e.mangoQuery.index;if(o){var a=i.find(s=>Dn(s,o));if(!a)throw q("QU12",{collection:e.rxQuery.collection.name,query:e.mangoQuery,schema:t})}if(e.rxQuery.op==="count"&&!Ub(e.rxQuery.collection.schema.jsonSchema,e.mangoQuery)&&!e.rxQuery.collection.database.allowSlowCount)throw q("QU14",{collection:e.rxQuery.collection,query:e.mangoQuery});e.mangoQuery.sort&&e.mangoQuery.sort.map(s=>Object.keys(s)[0]).filter(s=>!s.includes(".")).forEach(s=>{if(!n.includes(s))throw q("QU13",{schema:t,field:s,query:e.mangoQuery})})}function Ub(e,t){var r=Af.prepareQuery(e,t);return r.queryPlan.selectorSatisfiedByIndex}function Kb(e,t){if(!e)throw q("DOC20",{primaryKey:e,document:t});if(e!==e.trim())throw q("DOC21",{primaryKey:e,document:t});if(e.includes("\r")||e.includes(`
`))throw q("DOC22",{primaryKey:e,document:t});if(e.includes('"'))throw q("DOC23",{primaryKey:e,document:t})}function qb(e){return!e||typeof e=="string"||typeof e=="number"?e:Mc(e)}var Wb="dev-mode",Hb={name:Wb,rxdb:!0,init:()=>{console.warn(["-------------- RxDB dev-mode warning -------------------------------","you are seeing this because you use the RxDB dev-mode plugin https://rxdb.info/dev-mode.html","This is great in development mode, because it will run many checks to ensure","that you use RxDB correct. If you see this in production mode,","you did something wrong because the dev-mode plugin will decrease the performance.","","🤗 Hint: To get the most out of RxDB, check out the Premium Plugins","to get access to faster storages and more professional features: https://rxdb.info/premium.html","","Also take part in the RxDB User Survey: https://rxdb.info/survey.html","---------------------------------------------------------------------"].join(`
`))},overwritable:{isDevMode(){return!0},deepFreezeWhenDevMode:qb,tunnelErrorMessage(e){if(!Zu[e])throw console.error("RxDB: Error-Code not known: "+e),new Error("Error-Code "+e+" not known, contact the maintainer");return Zu[e]}},hooks:{preCreateRxSchema:{after:Mb},preCreateRxDatabase:{after:function(e){Fb(e)}},preCreateRxCollection:{after:function(e){if(Nb(e),Bb(e.schema,e.methods),e.name.charAt(0)==="_")throw q("DB2",{name:e.name});if(!e.schema)throw q("DB4",{name:e.name,args:e})}},createRxDocument:{before:function(e){Kb(e.primary,e.toJSON(!0))}},preCreateRxQuery:{after:function(e){Lb(e)}},prePrepareQuery:{after:e=>{zb(e)}},createRxCollection:{after:e=>{No(e.creator.statics),No(e.creator.methods),No(e.creator.attachments),e.creator.schema&&e.creator.migrationStrategies&&$b(e.creator.schema,e.creator.migrationStrategies)}}}};const Gb={version:0,title:"Note Schema",description:"a single note object",primaryKey:"guid",type:"object",indexes:["createdAt","updatedAt"],properties:{guid:{type:"string",maxLength:42,description:"unique identifier for note"},name:{type:"string",description:"name/title of note"},body:{type:"string",description:"markdown body of note"},createdAt:{type:"integer",description:"unix timestamp of when note was created",multipleOf:1,minimum:0,maximum:17976931348623157e292},updatedAt:{type:"integer",description:"unix timestamp of when note was last updated",multipleOf:1,minimum:0,maximum:17976931348623157e292},currentSelection:{type:"string",description:"text selection within note body (if any)"}},required:["name"]},Qb=localStorage.getItem("noteListHeight")||100;Ul(Hb);let Ua;const Vb=async()=>{const e=await vv({name:"nvauxdb",storage:Ob()});return await e.addCollections({notes:{schema:Gb}}),Ua=e,e},Bf=()=>Ua||Vb(),Ls=tn("search"),Ut=tn(""),Qi=tn(Qb),Wt=tn({}),Yb=tn("");Ut.subscribe(e=>{e===""&&(Ls.set("search"),Wt.set(""))});Qi.subscribe(e=>localStorage.setItem("noteListHeight",e.toString()));function Zb(e){let t,r,n,i;return{c(){t=Nt("svg"),r=Nt("circle"),n=Nt("line"),i=Nt("line"),V(r,"cx","12"),V(r,"cy","12"),V(r,"r","10"),V(n,"x1","15"),V(n,"y1","9"),V(n,"x2","9"),V(n,"y2","15"),V(i,"x1","9"),V(i,"y1","9"),V(i,"x2","15"),V(i,"y2","15"),V(t,"xmlns","http://www.w3.org/2000/svg"),V(t,"width","18"),V(t,"height","18"),V(t,"viewBox","0 0 24 24"),V(t,"fill","none"),V(t,"stroke","currentColor"),V(t,"stroke-width","2"),V(t,"stroke-linecap","round"),V(t,"stroke-linejoin","round"),V(t,"class","feather feather-x-circle")},m(o,a){qe(o,t,a),pe(t,r),pe(t,n),pe(t,i)},p:fe,i:fe,o:fe,d(o){o&&Le(t)}}}class Xb extends br{constructor(t){super(),gr(this,t,null,Zb,Zt,{})}}function Jb(e){let t,r,n,i;return{c(){t=Nt("svg"),r=Nt("line"),n=Nt("line"),i=Nt("line"),V(r,"x1","3"),V(r,"y1","12"),V(r,"x2","21"),V(r,"y2","12"),V(n,"x1","3"),V(n,"y1","6"),V(n,"x2","21"),V(n,"y2","6"),V(i,"x1","3"),V(i,"y1","18"),V(i,"x2","21"),V(i,"y2","18"),V(t,"xmlns","http://www.w3.org/2000/svg"),V(t,"width","26"),V(t,"height","26"),V(t,"viewBox","0 0 24 24"),V(t,"fill","none"),V(t,"stroke","currentColor"),V(t,"stroke-width","2"),V(t,"stroke-linecap","round"),V(t,"stroke-linejoin","round"),V(t,"class","feather feather-menu")},m(o,a){qe(o,t,a),pe(t,r),pe(t,n),pe(t,i)},p:fe,i:fe,o:fe,d(o){o&&Le(t)}}}class e_ extends br{constructor(t){super(),gr(this,t,null,Jb,Zt,{})}}function Ju(e){let t;return{c(){t=Ie("ul"),t.innerHTML='<li class="svelte-15kfwin"><div style="width: 10spx;"></div> About nvAux</li> <li class="svelte-15kfwin"><div style="width: 10spx;"></div> Leave Feedback...</li> <li class="break svelte-15kfwin"></li> <li class="svelte-15kfwin"><div style="width: 10spx;"></div> Import</li> <li class="svelte-15kfwin"><div style="width: 10spx;"></div> Export (.zip)</li> <li class="break svelte-15kfwin"></li> <li class="svelte-15kfwin"><div style="width: 10spx;"></div> Reset Database</li>',V(t,"class","absolute"),be(t,"min-width","180px"),be(t,"border","1px solid rgba(255,255,255,0.1)"),be(t,"z-index","9999"),be(t,"border-radius","6px"),be(t,"background","#0e0f11c4"),be(t,"top","33px"),be(t,"left","10px"),be(t,"color","white"),be(t,"list-style-type","none"),be(t,"margin","0"),be(t,"padding","0"),be(t,"-webkit-backdrop-filter","blur(10px)"),be(t,"backdrop-filter","blur(10px)")},m(r,n){qe(r,t,n)},d(r){r&&Le(t)}}}function ec(e){let t,r,n,i,o;return r=new Xb({}),{c(){t=Ie("button"),Pr(r.$$.fragment),V(t,"class","bg-transparent flex items-center px-2 py-1.5"),be(t,"color","#404856")},m(a,s){qe(a,t,s),rr(r,t,null),n=!0,i||(o=Ee(t,"click",e[9]),i=!0)},p:fe,i(a){n||(rt(r.$$.fragment,a),n=!0)},o(a){xt(r.$$.fragment,a),n=!1},d(a){a&&Le(t),nr(r),i=!1,o()}}}function t_(e){let t,r,n,i,o,a,s,u,c,l,f,h;i=new e_({});let d=e[1]&&Ju(),y=e[2]!==""&&ec(e);return{c(){t=Ie("div"),r=Ie("div"),n=Ie("button"),Pr(i.$$.fragment),o=ft(),d&&d.c(),a=ft(),s=Ie("div"),u=Ie("input"),c=ft(),y&&y.c(),V(n,"class","bg-transparent flex items-center"),be(n,"color","#444953"),V(r,"class","relative"),be(r,"padding","0 4px 0 8px"),V(u,"type","text"),V(u,"class","flex-grow py-0.5 px-1 flex-grow svelte-15kfwin"),V(u,"placeholder","Search or Create"),V(s,"class","input-wrapper flex-grow flex items-center"),V(t,"class","omnibar flex items-center border-box border-b"),be(t,"border-color","#2e3338"),be(t,"background-color","#181a1c"),be(t,"height","42px")},m(p,b){qe(p,t,b),pe(t,r),pe(r,n),rr(i,n,null),pe(r,o),d&&d.m(r,null),pe(t,a),pe(t,s),pe(s,u),e[7](u),Pi(u,e[2]),pe(s,c),y&&y.m(s,null),l=!0,f||(h=[Ee(window,"keydown",e[4]),Ee(n,"click",e[6]),Ee(u,"input",e[8]),Ee(u,"keydown",e[5]),Ee(u,"focus",function(){Va(e[0].select())&&e[0].select().apply(this,arguments)})],f=!0)},p(p,[b]){e=p,e[1]?d||(d=Ju(),d.c(),d.m(r,null)):d&&(d.d(1),d=null),b&4&&u.value!==e[2]&&Pi(u,e[2]),e[2]!==""?y?(y.p(e,b),b&4&&rt(y,1)):(y=ec(e),y.c(),rt(y,1),y.m(s,null)):y&&(Pc(),xt(y,1,1,()=>{y=null}),Ic())},i(p){l||(rt(i.$$.fragment,p),rt(y),l=!0)},o(p){xt(i.$$.fragment,p),xt(y),l=!1},d(p){p&&Le(t),nr(i),d&&d.d(),e[7](null),y&&y.d(),f=!1,dt(h)}}}function r_(e,t,r){let n,i;Kt(e,Ut,y=>r(2,n=y)),Kt(e,Wt,y=>r(3,i=y));let o,a;Ya(()=>o.focus());const s=y=>{y.keyCode===27&&(Ut.set(""),o.focus())},u=y=>{n!==""&&y.keyCode===13&&c()},c=async()=>{await(await Bf()).notes.insert({guid:jh(),name:n,createdAt:new Date().getTime(),updatedAt:new Date().getTime()}).then(p=>{Wt.set(p),Ls.set("edit")}).then(()=>document.getElementById("body-editor").focus())},l=()=>{r(1,a=!a)};function f(y){Ho[y?"unshift":"push"](()=>{o=y,r(0,o)})}function h(){n=this.value,Ut.set(n)}return[o,a,n,i,s,u,l,f,h,()=>{Wo(Ut,n="",n),Wo(Wt,i="",i)}]}class n_ extends br{constructor(t){super(),gr(this,t,r_,t_,Zt,{})}}function at(e,t){if(t.length<e)throw new TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}function je(e){at(1,arguments);var t=Object.prototype.toString.call(e);return e instanceof Date||qr(e)==="object"&&t==="[object Date]"?new Date(e.getTime()):typeof e=="number"||t==="[object Number]"?new Date(e):((typeof e=="string"||t==="[object String]")&&typeof console<"u"&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn(new Error().stack)),new Date(NaN))}var i_={};function o_(){return i_}function tc(e){var t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),e.getTime()-t.getTime()}function Di(e,t){at(2,arguments);var r=je(e),n=je(t),i=r.getTime()-n.getTime();return i<0?-1:i>0?1:i}function a_(e,t){at(2,arguments);var r=je(e),n=je(t),i=r.getFullYear()-n.getFullYear(),o=r.getMonth()-n.getMonth();return i*12+o}function s_(e,t){return at(2,arguments),je(e).getTime()-je(t).getTime()}var rc={ceil:Math.ceil,round:Math.round,floor:Math.floor,trunc:function(t){return t<0?Math.ceil(t):Math.floor(t)}},u_="trunc";function c_(e){return e?rc[e]:rc[u_]}function l_(e){at(1,arguments);var t=je(e);return t.setHours(23,59,59,999),t}function f_(e){at(1,arguments);var t=je(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}function h_(e){at(1,arguments);var t=je(e);return l_(t).getTime()===f_(t).getTime()}function d_(e,t){at(2,arguments);var r=je(e),n=je(t),i=Di(r,n),o=Math.abs(a_(r,n)),a;if(o<1)a=0;else{r.getMonth()===1&&r.getDate()>27&&r.setDate(30),r.setMonth(r.getMonth()-i*o);var s=Di(r,n)===-i;h_(je(e))&&o===1&&Di(e,n)===1&&(s=!1),a=i*(o-Number(s))}return a===0?0:a}function p_(e,t,r){at(2,arguments);var n=s_(e,t)/1e3;return c_(r==null?void 0:r.roundingMethod)(n)}var m_={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},y_=function(t,r,n){var i,o=m_[t];return typeof o=="string"?i=o:r===1?i=o.one:i=o.other.replace("{{count}}",r.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+i:i+" ago":i};const v_=y_;function Fo(e){return function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.width?String(t.width):e.defaultWidth,n=e.formats[r]||e.formats[e.defaultWidth];return n}}var g_={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},b_={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},__={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},w_={date:Fo({formats:g_,defaultWidth:"full"}),time:Fo({formats:b_,defaultWidth:"full"}),dateTime:Fo({formats:__,defaultWidth:"full"})};const k_=w_;var x_={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},E_=function(t,r,n,i){return x_[t]};const S_=E_;function dn(e){return function(t,r){var n=r!=null&&r.context?String(r.context):"standalone",i;if(n==="formatting"&&e.formattingValues){var o=e.defaultFormattingWidth||e.defaultWidth,a=r!=null&&r.width?String(r.width):o;i=e.formattingValues[a]||e.formattingValues[o]}else{var s=e.defaultWidth,u=r!=null&&r.width?String(r.width):e.defaultWidth;i=e.values[u]||e.values[s]}var c=e.argumentCallback?e.argumentCallback(t):t;return i[c]}}var O_={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},C_={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},D_={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},A_={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},P_={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},I_={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},R_=function(t,r){var n=Number(t),i=n%100;if(i>20||i<10)switch(i%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},T_={ordinalNumber:R_,era:dn({values:O_,defaultWidth:"wide"}),quarter:dn({values:C_,defaultWidth:"wide",argumentCallback:function(t){return t-1}}),month:dn({values:D_,defaultWidth:"wide"}),day:dn({values:A_,defaultWidth:"wide"}),dayPeriod:dn({values:P_,defaultWidth:"wide",formattingValues:I_,defaultFormattingWidth:"wide"})};const M_=T_;function pn(e){return function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=r.width,i=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],o=t.match(i);if(!o)return null;var a=o[0],s=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],u=Array.isArray(s)?$_(s,function(f){return f.test(a)}):B_(s,function(f){return f.test(a)}),c;c=e.valueCallback?e.valueCallback(u):u,c=r.valueCallback?r.valueCallback(c):c;var l=t.slice(a.length);return{value:c,rest:l}}}function B_(e,t){for(var r in e)if(e.hasOwnProperty(r)&&t(e[r]))return r}function $_(e,t){for(var r=0;r<e.length;r++)if(t(e[r]))return r}function N_(e){return function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=t.match(e.matchPattern);if(!n)return null;var i=n[0],o=t.match(e.parsePattern);if(!o)return null;var a=e.valueCallback?e.valueCallback(o[0]):o[0];a=r.valueCallback?r.valueCallback(a):a;var s=t.slice(i.length);return{value:a,rest:s}}}var F_=/^(\d+)(th|st|nd|rd)?/i,j_=/\d+/i,L_={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},z_={any:[/^b/i,/^(a|c)/i]},U_={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},K_={any:[/1/i,/2/i,/3/i,/4/i]},q_={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},W_={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},H_={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},G_={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Q_={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},V_={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Y_={ordinalNumber:N_({matchPattern:F_,parsePattern:j_,valueCallback:function(t){return parseInt(t,10)}}),era:pn({matchPatterns:L_,defaultMatchWidth:"wide",parsePatterns:z_,defaultParseWidth:"any"}),quarter:pn({matchPatterns:U_,defaultMatchWidth:"wide",parsePatterns:K_,defaultParseWidth:"any",valueCallback:function(t){return t+1}}),month:pn({matchPatterns:q_,defaultMatchWidth:"wide",parsePatterns:W_,defaultParseWidth:"any"}),day:pn({matchPatterns:H_,defaultMatchWidth:"wide",parsePatterns:G_,defaultParseWidth:"any"}),dayPeriod:pn({matchPatterns:Q_,defaultMatchWidth:"any",parsePatterns:V_,defaultParseWidth:"any"})};const Z_=Y_;var X_={code:"en-US",formatDistance:v_,formatLong:k_,formatRelative:S_,localize:M_,match:Z_,options:{weekStartsOn:0,firstWeekContainsDate:1}};const J_=X_;function $f(e,t){if(e==null)throw new TypeError("assign requires that input parameter not be null or undefined");for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}function e0(e){return $f({},e)}var nc=1440,t0=2520,jo=43200,r0=86400;function n0(e,t,r){var n,i;at(2,arguments);var o=o_(),a=(n=(i=r==null?void 0:r.locale)!==null&&i!==void 0?i:o.locale)!==null&&n!==void 0?n:J_;if(!a.formatDistance)throw new RangeError("locale must contain formatDistance property");var s=Di(e,t);if(isNaN(s))throw new RangeError("Invalid time value");var u=$f(e0(r),{addSuffix:!!(r!=null&&r.addSuffix),comparison:s}),c,l;s>0?(c=je(t),l=je(e)):(c=je(e),l=je(t));var f=p_(l,c),h=(tc(l)-tc(c))/1e3,d=Math.round((f-h)/60),y;if(d<2)return r!=null&&r.includeSeconds?f<5?a.formatDistance("lessThanXSeconds",5,u):f<10?a.formatDistance("lessThanXSeconds",10,u):f<20?a.formatDistance("lessThanXSeconds",20,u):f<40?a.formatDistance("halfAMinute",0,u):f<60?a.formatDistance("lessThanXMinutes",1,u):a.formatDistance("xMinutes",1,u):d===0?a.formatDistance("lessThanXMinutes",1,u):a.formatDistance("xMinutes",d,u);if(d<45)return a.formatDistance("xMinutes",d,u);if(d<90)return a.formatDistance("aboutXHours",1,u);if(d<nc){var p=Math.round(d/60);return a.formatDistance("aboutXHours",p,u)}else{if(d<t0)return a.formatDistance("xDays",1,u);if(d<jo){var b=Math.round(d/nc);return a.formatDistance("xDays",b,u)}else if(d<r0)return y=Math.round(d/jo),a.formatDistance("aboutXMonths",y,u)}if(y=d_(l,c),y<12){var m=Math.round(d/jo);return a.formatDistance("xMonths",m,u)}else{var g=y%12,w=Math.floor(y/12);return g<3?a.formatDistance("aboutXYears",w,u):g<9?a.formatDistance("overXYears",w,u):a.formatDistance("almostXYears",w+1,u)}}function i0(e,t){return at(1,arguments),n0(e,Date.now(),t)}function ic(e,t,r){const n=e.slice();return n[17]=t[r],n}function o0(e){return{c:fe,m:fe,p:fe,d:fe}}function a0(e){let t,r=Zs(e[16]),n=[];for(let i=0;i<r.length;i+=1)n[i]=ac(ic(e,r,i));return{c(){for(let i=0;i<n.length;i+=1)n[i].c();t=Oh()},m(i,o){for(let a=0;a<n.length;a+=1)n[a]&&n[a].m(i,o);qe(i,t,o)},p(i,o){if(o&117){r=Zs(i[16]);let a;for(a=0;a<r.length;a+=1){const s=ic(i,r,a);n[a]?n[a].p(s,o):(n[a]=ac(s),n[a].c(),n[a].m(t.parentNode,t))}for(;a<n.length;a+=1)n[a].d(1);n.length=r.length}},d(i){i&&Le(t),Sh(n,i)}}}function oc(e){let t;return{c(){t=Ie("span"),t.textContent="—",be(t,"color","#505050")},m(r,n){qe(r,t,n)},d(r){r&&Le(t)}}}function ac(e){let t,r,n=e[17].name+"",i,o,a,s,u=(e[17].body??"")+"",c,l,f,h,d=e[4](e[17].updatedAt)+"",y,p,b,m,g,w,S=e[17].body!==""&&oc();function k(){return e[9](e[17])}function D(){return e[10](e[17])}function E(){return e[11](e[17])}return{c(){t=Ie("li"),r=Ie("span"),i=Tr(n),o=ft(),S&&S.c(),a=ft(),s=Ie("span"),c=Tr(u),f=ft(),h=Ie("span"),y=Tr(d),b=ft(),V(s,"class","mute svelte-bfkdot"),V(s,"style",l=e[0]===e[17]&&"color: #fff;"),V(r,"class","elipsis"),V(r,"role","button"),V(r,"tabindex","-1"),V(h,"class","meta svelte-bfkdot"),V(h,"style",p=e[0]===e[17]&&"background: #2252a0; color: white;"),V(t,"style",m=e[0]===e[17]&&"background: #2252a0; color: white;"),V(t,"class","svelte-bfkdot")},m(I,A){qe(I,t,A),pe(t,r),pe(r,i),pe(r,o),S&&S.m(r,null),pe(r,a),pe(r,s),pe(s,c),pe(t,f),pe(t,h),pe(h,y),pe(t,b),g||(w=[Ee(r,"dblclick",e[8]),Ee(t,"click",k),Ee(t,"keydown",D),Ee(t,"mouseover",E)],g=!0)},p(I,A){e=I,A&4&&n!==(n=e[17].name+"")&&lo(i,n),e[17].body!==""?S||(S=oc(),S.c(),S.m(r,a)):S&&(S.d(1),S=null),A&4&&u!==(u=(e[17].body??"")+"")&&lo(c,u),A&5&&l!==(l=e[0]===e[17]&&"color: #fff;")&&V(s,"style",l),A&4&&d!==(d=e[4](e[17].updatedAt)+"")&&lo(y,d),A&5&&p!==(p=e[0]===e[17]&&"background: #2252a0; color: white;")&&V(h,"style",p),A&5&&m!==(m=e[0]===e[17]&&"background: #2252a0; color: white;")&&V(t,"style",m)},d(I){I&&Le(t),S&&S.d(),g=!1,dt(w)}}}function s0(e){let t;return{c(){t=Tr("Loading Notes...")},m(r,n){qe(r,t,n)},p:fe,d(r){r&&Le(t)}}}function u0(e){let t,r,n,i,o={ctx:e,current:null,token:null,hasCatch:!1,pending:s0,then:a0,catch:o0,value:16};return Ys(r=e[2],o),{c(){t=Ie("ul"),o.block.c(),V(t,"id","noteList"),be(t,"height",e[3]+"px"),V(t,"class","svelte-bfkdot")},m(a,s){qe(a,t,s),o.block.m(t,o.anchor=null),o.mount=()=>t,o.anchor=null,n||(i=[Ee(t,"mousedown",e[12]),Ee(t,"mouseup",e[13])],n=!0)},p(a,[s]){e=a,o.ctx=e,s&4&&r!==(r=e[2])&&Ys(r,o)||Rh(o,e,s),s&8&&be(t,"height",e[3]+"px")},i:fe,o:fe,d(a){a&&Le(t),o.block.d(),o.token=null,o=null,n=!1,dt(i)}}}function c0(e,t,r){let n,i,o;Kt(e,Wt,g=>r(0,n=g)),Kt(e,Ut,g=>r(14,i=g)),Kt(e,Qi,g=>r(3,o=g));let a,s=!1,u=[];Ya(()=>{(async()=>{r(7,a=await Bf()),a.notes.find({selector:{$or:[{name:{$regex:`.*${i}.*`}},{body:{$regex:`.*${i}.*`}}]},sort:[{updatedAt:"desc"}]}).$.subscribe(w=>r(2,u=w))})()});const c=g=>i0(new Date(g).getTime(),{addSuffix:!0}),l=g=>s&&f(g),f=g=>{Wt.set(g),a.notes.findOne({selector:{name:n.name}}).exec().then(w=>{Ls.set("edit"),Ut.set(w.name),Yb.set(w.body)})},h=()=>document.getElementById("body-editor").focus(),d=g=>f(g),y=g=>f(g),p=g=>l(g),b=()=>r(1,s=!0),m=()=>r(1,s=!1);return e.$$.update=()=>{e.$$.dirty&129&&Ut.subscribe(g=>{a&&!n&&a.notes.find({selector:{$or:[{name:{$regex:`.*${g}.*`}},{body:{$regex:`.*${g}.*`}}]},sort:[{updatedAt:"desc"}]}).$.subscribe(w=>r(2,u=w))})},[n,s,u,o,c,l,f,a,h,d,y,p,b,m]}class l0 extends br{constructor(t){super(),gr(this,t,c0,u0,Zt,{})}}const f0=Kh({x:0,y:0},e=>{const t=r=>{e({x:r.clientX,y:r.clientY})};return document.body.addEventListener("mousemove",t),()=>{document.body.removeEventListener("mousemove",t)}});function h0(e){let t,r,n;return{c(){t=Ie("div"),V(t,"class","w-full resize-bar select-none row-resize h-[10px]"),V(t,"role","button"),V(t,"tabindex","-1")},m(i,o){qe(i,t,o),r||(n=[Ee(window,"mouseup",e[1]),Ee(window,"mousemove",e[2]),Ee(window,"touchend",e[1]),Ee(window,"touchmove",e[2]),Ee(t,"mousedown",e[0]),Ee(t,"touchstart",e[0],{passive:!0})],r=!0)},p:fe,i:fe,o:fe,d(i){i&&Le(t),r=!1,dt(n)}}}function d0(e,t,r){let n,i;Kt(e,f0,c=>r(5,n=c)),Kt(e,Qi,c=>r(3,i=c));let o=!1;const a=()=>o=!0,s=()=>o=!1,u=()=>{o&&Wo(Qi,i=n.y>=42&&n.y-42,i)};return e.$$.update=()=>{e.$$.dirty&8&&console.log("ddd",i)},[a,s,u,i]}class p0 extends br{constructor(t){super(),gr(this,t,d0,h0,Zt,{})}}var Nf={exports:{}};(function(e){var t=function(){function r(h,d){return d!=null&&h instanceof d}var n;try{n=Map}catch{n=function(){}}var i;try{i=Set}catch{i=function(){}}var o;try{o=Promise}catch{o=function(){}}function a(h,d,y,p,b){typeof d=="object"&&(y=d.depth,p=d.prototype,b=d.includeNonEnumerable,d=d.circular);var m=[],g=[],w=typeof Buffer<"u";typeof d>"u"&&(d=!0),typeof y>"u"&&(y=1/0);function S(k,D){if(k===null)return null;if(D===0)return k;var E,I;if(typeof k!="object")return k;if(r(k,n))E=new n;else if(r(k,i))E=new i;else if(r(k,o))E=new o(function(j,te){k.then(function(L){j(S(L,D-1))},function(L){te(S(L,D-1))})});else if(a.__isArray(k))E=[];else if(a.__isRegExp(k))E=new RegExp(k.source,f(k)),k.lastIndex&&(E.lastIndex=k.lastIndex);else if(a.__isDate(k))E=new Date(k.getTime());else{if(w&&Buffer.isBuffer(k))return Buffer.allocUnsafe?E=Buffer.allocUnsafe(k.length):E=new Buffer(k.length),k.copy(E),E;r(k,Error)?E=Object.create(k):typeof p>"u"?(I=Object.getPrototypeOf(k),E=Object.create(I)):(E=Object.create(p),I=p)}if(d){var A=m.indexOf(k);if(A!=-1)return g[A];m.push(k),g.push(E)}r(k,n)&&k.forEach(function(j,te){var L=S(te,D-1),J=S(j,D-1);E.set(L,J)}),r(k,i)&&k.forEach(function(j){var te=S(j,D-1);E.add(te)});for(var N in k){var G;I&&(G=Object.getOwnPropertyDescriptor(I,N)),!(G&&G.set==null)&&(E[N]=S(k[N],D-1))}if(Object.getOwnPropertySymbols)for(var C=Object.getOwnPropertySymbols(k),N=0;N<C.length;N++){var M=C[N],_=Object.getOwnPropertyDescriptor(k,M);_&&!_.enumerable&&!b||(E[M]=S(k[M],D-1),_.enumerable||Object.defineProperty(E,M,{enumerable:!1}))}if(b)for(var F=Object.getOwnPropertyNames(k),N=0;N<F.length;N++){var ee=F[N],_=Object.getOwnPropertyDescriptor(k,ee);_&&_.enumerable||(E[ee]=S(k[ee],D-1),Object.defineProperty(E,ee,{enumerable:!1}))}return E}return S(h,y)}a.clonePrototype=function(d){if(d===null)return null;var y=function(){};return y.prototype=d,new y};function s(h){return Object.prototype.toString.call(h)}a.__objToStr=s;function u(h){return typeof h=="object"&&s(h)==="[object Date]"}a.__isDate=u;function c(h){return typeof h=="object"&&s(h)==="[object Array]"}a.__isArray=c;function l(h){return typeof h=="object"&&s(h)==="[object RegExp]"}a.__isRegExp=l;function f(h){var d="";return h.global&&(d+="g"),h.ignoreCase&&(d+="i"),h.multiline&&(d+="m"),d}return a.__getRegExpFlags=f,a}();e.exports&&(e.exports=t)})(Nf);var m0=Nf.exports,sc=Object.prototype.toString,Ff=function(t){var r=sc.call(t),n=r==="[object Arguments]";return n||(n=r!=="[object Array]"&&t!==null&&typeof t=="object"&&typeof t.length=="number"&&t.length>=0&&sc.call(t.callee)==="[object Function]"),n},Lo,uc;function y0(){if(uc)return Lo;uc=1;var e;if(!Object.keys){var t=Object.prototype.hasOwnProperty,r=Object.prototype.toString,n=Ff,i=Object.prototype.propertyIsEnumerable,o=!i.call({toString:null},"toString"),a=i.call(function(){},"prototype"),s=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],u=function(h){var d=h.constructor;return d&&d.prototype===h},c={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},l=function(){if(typeof window>"u")return!1;for(var h in window)try{if(!c["$"+h]&&t.call(window,h)&&window[h]!==null&&typeof window[h]=="object")try{u(window[h])}catch{return!0}}catch{return!0}return!1}(),f=function(h){if(typeof window>"u"||!l)return u(h);try{return u(h)}catch{return!1}};e=function(d){var y=d!==null&&typeof d=="object",p=r.call(d)==="[object Function]",b=n(d),m=y&&r.call(d)==="[object String]",g=[];if(!y&&!p&&!b)throw new TypeError("Object.keys called on a non-object");var w=a&&p;if(m&&d.length>0&&!t.call(d,0))for(var S=0;S<d.length;++S)g.push(String(S));if(b&&d.length>0)for(var k=0;k<d.length;++k)g.push(String(k));else for(var D in d)!(w&&D==="prototype")&&t.call(d,D)&&g.push(String(D));if(o)for(var E=f(d),I=0;I<s.length;++I)!(E&&s[I]==="constructor")&&t.call(d,s[I])&&g.push(s[I]);return g}}return Lo=e,Lo}var v0=Array.prototype.slice,g0=Ff,cc=Object.keys,Ai=cc?function(t){return cc(t)}:y0(),lc=Object.keys;Ai.shim=function(){if(Object.keys){var t=function(){var r=Object.keys(arguments);return r&&r.length===arguments.length}(1,2);t||(Object.keys=function(n){return g0(n)?lc(v0.call(n)):lc(n)})}else Object.keys=Ai;return Object.keys||Ai};var jf=Ai,Lf=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var t={},r=Symbol("test"),n=Object(r);if(typeof r=="string"||Object.prototype.toString.call(r)!=="[object Symbol]"||Object.prototype.toString.call(n)!=="[object Symbol]")return!1;var i=42;t[r]=i;for(r in t)return!1;if(typeof Object.keys=="function"&&Object.keys(t).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(t).length!==0)return!1;var o=Object.getOwnPropertySymbols(t);if(o.length!==1||o[0]!==r||!Object.prototype.propertyIsEnumerable.call(t,r))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var a=Object.getOwnPropertyDescriptor(t,r);if(a.value!==i||a.enumerable!==!0)return!1}return!0},b0=Lf,zs=function(){return b0()&&!!Symbol.toStringTag},fc=typeof Symbol<"u"&&Symbol,_0=Lf,w0=function(){return typeof fc!="function"||typeof Symbol!="function"||typeof fc("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:_0()},hc={foo:{}},k0=Object,x0=function(){return{__proto__:hc}.foo===hc.foo&&!({__proto__:null}instanceof k0)},E0="Function.prototype.bind called on incompatible ",zo=Array.prototype.slice,S0=Object.prototype.toString,O0="[object Function]",C0=function(t){var r=this;if(typeof r!="function"||S0.call(r)!==O0)throw new TypeError(E0+r);for(var n=zo.call(arguments,1),i,o=function(){if(this instanceof i){var l=r.apply(this,n.concat(zo.call(arguments)));return Object(l)===l?l:this}else return r.apply(t,n.concat(zo.call(arguments)))},a=Math.max(0,r.length-n.length),s=[],u=0;u<a;u++)s.push("$"+u);if(i=Function("binder","return function ("+s.join(",")+"){ return binder.apply(this,arguments); }")(o),r.prototype){var c=function(){};c.prototype=r.prototype,i.prototype=new c,c.prototype=null}return i},D0=C0,Us=Function.prototype.bind||D0,A0=Us,P0=A0.call(Function.call,Object.prototype.hasOwnProperty),se,en=SyntaxError,zf=Function,Kr=TypeError,Uo=function(e){try{return zf('"use strict"; return ('+e+").constructor;")()}catch{}},lr=Object.getOwnPropertyDescriptor;if(lr)try{lr({},"")}catch{lr=null}var Ko=function(){throw new Kr},I0=lr?function(){try{return arguments.callee,Ko}catch{try{return lr(arguments,"callee").get}catch{return Ko}}}():Ko,Or=w0(),R0=x0(),Pe=Object.getPrototypeOf||(R0?function(e){return e.__proto__}:null),Ar={},T0=typeof Uint8Array>"u"||!Pe?se:Pe(Uint8Array),fr={"%AggregateError%":typeof AggregateError>"u"?se:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?se:ArrayBuffer,"%ArrayIteratorPrototype%":Or&&Pe?Pe([][Symbol.iterator]()):se,"%AsyncFromSyncIteratorPrototype%":se,"%AsyncFunction%":Ar,"%AsyncGenerator%":Ar,"%AsyncGeneratorFunction%":Ar,"%AsyncIteratorPrototype%":Ar,"%Atomics%":typeof Atomics>"u"?se:Atomics,"%BigInt%":typeof BigInt>"u"?se:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?se:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?se:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?se:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?se:Float32Array,"%Float64Array%":typeof Float64Array>"u"?se:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?se:FinalizationRegistry,"%Function%":zf,"%GeneratorFunction%":Ar,"%Int8Array%":typeof Int8Array>"u"?se:Int8Array,"%Int16Array%":typeof Int16Array>"u"?se:Int16Array,"%Int32Array%":typeof Int32Array>"u"?se:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":Or&&Pe?Pe(Pe([][Symbol.iterator]())):se,"%JSON%":typeof JSON=="object"?JSON:se,"%Map%":typeof Map>"u"?se:Map,"%MapIteratorPrototype%":typeof Map>"u"||!Or||!Pe?se:Pe(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?se:Promise,"%Proxy%":typeof Proxy>"u"?se:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?se:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?se:Set,"%SetIteratorPrototype%":typeof Set>"u"||!Or||!Pe?se:Pe(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?se:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":Or&&Pe?Pe(""[Symbol.iterator]()):se,"%Symbol%":Or?Symbol:se,"%SyntaxError%":en,"%ThrowTypeError%":I0,"%TypedArray%":T0,"%TypeError%":Kr,"%Uint8Array%":typeof Uint8Array>"u"?se:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?se:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?se:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?se:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?se:WeakMap,"%WeakRef%":typeof WeakRef>"u"?se:WeakRef,"%WeakSet%":typeof WeakSet>"u"?se:WeakSet};if(Pe)try{null.error}catch(e){var M0=Pe(Pe(e));fr["%Error.prototype%"]=M0}var B0=function e(t){var r;if(t==="%AsyncFunction%")r=Uo("async function () {}");else if(t==="%GeneratorFunction%")r=Uo("function* () {}");else if(t==="%AsyncGeneratorFunction%")r=Uo("async function* () {}");else if(t==="%AsyncGenerator%"){var n=e("%AsyncGeneratorFunction%");n&&(r=n.prototype)}else if(t==="%AsyncIteratorPrototype%"){var i=e("%AsyncGenerator%");i&&Pe&&(r=Pe(i.prototype))}return fr[t]=r,r},dc={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},Zn=Us,Vi=P0,$0=Zn.call(Function.call,Array.prototype.concat),N0=Zn.call(Function.apply,Array.prototype.splice),pc=Zn.call(Function.call,String.prototype.replace),Yi=Zn.call(Function.call,String.prototype.slice),F0=Zn.call(Function.call,RegExp.prototype.exec),j0=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,L0=/\\(\\)?/g,z0=function(t){var r=Yi(t,0,1),n=Yi(t,-1);if(r==="%"&&n!=="%")throw new en("invalid intrinsic syntax, expected closing `%`");if(n==="%"&&r!=="%")throw new en("invalid intrinsic syntax, expected opening `%`");var i=[];return pc(t,j0,function(o,a,s,u){i[i.length]=s?pc(u,L0,"$1"):a||o}),i},U0=function(t,r){var n=t,i;if(Vi(dc,n)&&(i=dc[n],n="%"+i[0]+"%"),Vi(fr,n)){var o=fr[n];if(o===Ar&&(o=B0(n)),typeof o>"u"&&!r)throw new Kr("intrinsic "+t+" exists, but is not available. Please file an issue!");return{alias:i,name:n,value:o}}throw new en("intrinsic "+t+" does not exist!")},Ks=function(t,r){if(typeof t!="string"||t.length===0)throw new Kr("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof r!="boolean")throw new Kr('"allowMissing" argument must be a boolean');if(F0(/^%?[^%]*%?$/,t)===null)throw new en("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var n=z0(t),i=n.length>0?n[0]:"",o=U0("%"+i+"%",r),a=o.name,s=o.value,u=!1,c=o.alias;c&&(i=c[0],N0(n,$0([0,1],c)));for(var l=1,f=!0;l<n.length;l+=1){var h=n[l],d=Yi(h,0,1),y=Yi(h,-1);if((d==='"'||d==="'"||d==="`"||y==='"'||y==="'"||y==="`")&&d!==y)throw new en("property names with quotes must have matching quotes");if((h==="constructor"||!f)&&(u=!0),i+="."+h,a="%"+i+"%",Vi(fr,a))s=fr[a];else if(s!=null){if(!(h in s)){if(!r)throw new Kr("base intrinsic for "+t+" exists, but the property is not available.");return}if(lr&&l+1>=n.length){var p=lr(s,h);f=!!p,f&&"get"in p&&!("originalValue"in p.get)?s=p.get:s=s[h]}else f=Vi(s,h),s=s[h];f&&!u&&(fr[a]=s)}}return s},Uf={exports:{}};(function(e){var t=Us,r=Ks,n=r("%Function.prototype.apply%"),i=r("%Function.prototype.call%"),o=r("%Reflect.apply%",!0)||t.call(i,n),a=r("%Object.getOwnPropertyDescriptor%",!0),s=r("%Object.defineProperty%",!0),u=r("%Math.max%");if(s)try{s({},"a",{value:1})}catch{s=null}e.exports=function(f){var h=o(t,i,arguments);if(a&&s){var d=a(h,"length");d.configurable&&s(h,"length",{value:1+u(0,f.length-(arguments.length-1))})}return h};var c=function(){return o(t,n,arguments)};s?s(e.exports,"apply",{value:c}):e.exports.apply=c})(Uf);var qs=Uf.exports,Kf=Ks,qf=qs,K0=qf(Kf("String.prototype.indexOf")),Wf=function(t,r){var n=Kf(t,!!r);return typeof n=="function"&&K0(t,".prototype.")>-1?qf(n):n},q0=zs(),W0=Wf,Ka=W0("Object.prototype.toString"),uo=function(t){return q0&&t&&typeof t=="object"&&Symbol.toStringTag in t?!1:Ka(t)==="[object Arguments]"},Hf=function(t){return uo(t)?!0:t!==null&&typeof t=="object"&&typeof t.length=="number"&&t.length>=0&&Ka(t)!=="[object Array]"&&Ka(t.callee)==="[object Function]"},H0=function(){return uo(arguments)}();uo.isLegacyArguments=Hf;var G0=H0?uo:Hf,Q0=Ks,qa=Q0("%Object.defineProperty%",!0),Wa=function(){if(qa)try{return qa({},"a",{value:1}),!0}catch{return!1}return!1};Wa.hasArrayLengthDefineBug=function(){if(!Wa())return null;try{return qa([],"length",{value:1}).length!==1}catch{return!0}};var V0=Wa,Y0=jf,Z0=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",X0=Object.prototype.toString,J0=Array.prototype.concat,Gf=Object.defineProperty,ew=function(e){return typeof e=="function"&&X0.call(e)==="[object Function]"},tw=V0(),Qf=Gf&&tw,rw=function(e,t,r,n){if(t in e){if(n===!0){if(e[t]===r)return}else if(!ew(n)||!n())return}Qf?Gf(e,t,{configurable:!0,enumerable:!1,value:r,writable:!0}):e[t]=r},Vf=function(e,t){var r=arguments.length>2?arguments[2]:{},n=Y0(t);Z0&&(n=J0.call(n,Object.getOwnPropertySymbols(t)));for(var i=0;i<n.length;i+=1)rw(e,n[i],t[n[i]],r[n[i]])};Vf.supportsDescriptors=!!Qf;var Xn=Vf,mc=function(e){return e!==e},Yf=function(t,r){return t===0&&r===0?1/t===1/r:!!(t===r||mc(t)&&mc(r))},nw=Yf,Zf=function(){return typeof Object.is=="function"?Object.is:nw},iw=Zf,ow=Xn,aw=function(){var t=iw();return ow(Object,{is:t},{is:function(){return Object.is!==t}}),t},sw=Xn,uw=qs,cw=Yf,Xf=Zf,lw=aw,Jf=uw(Xf(),Object);sw(Jf,{getPolyfill:Xf,implementation:cw,shim:lw});var fw=Jf,Ha=Wf,eh=zs(),th,rh,Ga,Qa;if(eh){th=Ha("Object.prototype.hasOwnProperty"),rh=Ha("RegExp.prototype.exec"),Ga={};var qo=function(){throw Ga};Qa={toString:qo,valueOf:qo},typeof Symbol.toPrimitive=="symbol"&&(Qa[Symbol.toPrimitive]=qo)}var hw=Ha("Object.prototype.toString"),dw=Object.getOwnPropertyDescriptor,pw="[object RegExp]",mw=eh?function(t){if(!t||typeof t!="object")return!1;var r=dw(t,"lastIndex"),n=r&&th(r,"value");if(!n)return!1;try{rh(t,Qa)}catch(i){return i===Ga}}:function(t){return!t||typeof t!="object"&&typeof t!="function"?!1:hw(t)===pw},nh={exports:{}},zn=function(){return typeof(function(){}).name=="string"},Sn=Object.getOwnPropertyDescriptor;if(Sn)try{Sn([],"length")}catch{Sn=null}zn.functionsHaveConfigurableNames=function(){if(!zn()||!Sn)return!1;var t=Sn(function(){},"name");return!!t&&!!t.configurable};var yw=Function.prototype.bind;zn.boundFunctionsHaveNames=function(){return zn()&&typeof yw=="function"&&(function(){}).bind().name!==""};var vw=zn;(function(e){var t=vw.functionsHaveConfigurableNames(),r=Object,n=TypeError;e.exports=function(){if(this!=null&&this!==r(this))throw new n("RegExp.prototype.flags getter called on non-object");var o="";return this.hasIndices&&(o+="d"),this.global&&(o+="g"),this.ignoreCase&&(o+="i"),this.multiline&&(o+="m"),this.dotAll&&(o+="s"),this.unicode&&(o+="u"),this.unicodeSets&&(o+="v"),this.sticky&&(o+="y"),o},t&&Object.defineProperty&&Object.defineProperty(e.exports,"name",{value:"get flags"})})(nh);var ih=nh.exports,gw=ih,bw=Xn.supportsDescriptors,_w=Object.getOwnPropertyDescriptor,oh=function(){if(bw&&/a/mig.flags==="gim"){var t=_w(RegExp.prototype,"flags");if(t&&typeof t.get=="function"&&typeof RegExp.prototype.dotAll=="boolean"&&typeof RegExp.prototype.hasIndices=="boolean"){var r="",n={};if(Object.defineProperty(n,"hasIndices",{get:function(){r+="d"}}),Object.defineProperty(n,"sticky",{get:function(){r+="y"}}),r==="dy")return t.get}}return gw},ww=Xn.supportsDescriptors,kw=oh,xw=Object.getOwnPropertyDescriptor,Ew=Object.defineProperty,Sw=TypeError,yc=Object.getPrototypeOf,Ow=/a/,Cw=function(){if(!ww||!yc)throw new Sw("RegExp.prototype.flags requires a true ES5 environment that supports property descriptors");var t=kw(),r=yc(Ow),n=xw(r,"flags");return(!n||n.get!==t)&&Ew(r,"flags",{configurable:!0,enumerable:!1,get:t}),t},Dw=Xn,Aw=qs,Pw=ih,ah=oh,Iw=Cw,sh=Aw(ah());Dw(sh,{getPolyfill:ah,implementation:Pw,shim:Iw});var Rw=sh,Tw=Date.prototype.getDay,Mw=function(t){try{return Tw.call(t),!0}catch{return!1}},Bw=Object.prototype.toString,$w="[object Date]",Nw=zs(),Fw=function(t){return typeof t!="object"||t===null?!1:Nw?Mw(t):Bw.call(t)===$w},vc=jf,gc=G0,bc=fw,_c=mw,wc=Rw,kc=Fw,xc=Date.prototype.getTime;function uh(e,t,r){var n=r||{};return(n.strict?bc(e,t):e===t)?!0:!e||!t||typeof e!="object"&&typeof t!="object"?n.strict?bc(e,t):e==t:jw(e,t,n)}function Ec(e){return e==null}function Sc(e){return!(!e||typeof e!="object"||typeof e.length!="number"||typeof e.copy!="function"||typeof e.slice!="function"||e.length>0&&typeof e[0]!="number")}function jw(e,t,r){var n,i;if(typeof e!=typeof t||Ec(e)||Ec(t)||e.prototype!==t.prototype||gc(e)!==gc(t))return!1;var o=_c(e),a=_c(t);if(o!==a)return!1;if(o||a)return e.source===t.source&&wc(e)===wc(t);if(kc(e)&&kc(t))return xc.call(e)===xc.call(t);var s=Sc(e),u=Sc(t);if(s!==u)return!1;if(s||u){if(e.length!==t.length)return!1;for(n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}if(typeof e!=typeof t)return!1;try{var c=vc(e),l=vc(t)}catch{return!1}if(c.length!==l.length)return!1;for(c.sort(),l.sort(),n=c.length-1;n>=0;n--)if(c[n]!=l[n])return!1;for(n=c.length-1;n>=0;n--)if(i=c[n],!uh(e[i],t[i],r))return!1;return!0}var Lw=uh;function ch(e){return e&&typeof e=="object"&&"default"in e?e.default:e}var Oc=ch(m0),Cc=ch(Lw),Rr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zw=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Uw=function(e){return(typeof e>"u"?"undefined":Rr(e))==="object"&&e!==null},Kw=function(e,t){return e.every(function(r){return t&&t(r)||r})},qw=function(e,t){return e.hasOwnProperty(t)},Ww=function(e){return Object.keys(e)},lh=function(e,t){Object.keys(e).forEach(function(r){t(e[r],r)})},Hw=function(e){return Array.isArray(e)},fh=function(e){return!!(typeof Uint8Array<"u"&&e instanceof Uint8Array||e&&e.$Uint8ArrayPolyfill)},hh={isArray:Hw,each:lh},dh=function(t){return hh.isArray(t)&&!fh(t)},Gw=function(t){return dh(t)||Ws(t)},Qw=function(t,r){if(!Ws(t))return!1;var n=void 0;return hh.each(t,function(i,o){var a=o.substr(0,1)==="$";if(n===void 0)n=a;else if(n!==a){if(!r)throw new Error("Inconsistent operator: "+JSON.stringify(t));n=!1}}),!!n},Vw=function(t){return/^[0-9]+$/.test(t)},Ws=function(e){return!(!e||typeof e=="number"||typeof e=="string"||typeof e=="boolean"||dh(e)||e===null||e instanceof RegExp||typeof e=="function"||e instanceof Date||fh(e))},ae=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};typeof e=="string"&&t.field&&(e+=" for field '"+t.field+"'");var r=new Error(e);return r.name="ModifyJsError",r},Bt={all:Kw,each:lh,keys:Ww,has:qw,isObject:Uw},Yw=function(e,t,r){if(!(r&&r.each))return Zw(e,t,zw({},r,{returnInsteadOfReplacing:!0}))},Zw=function(t,r,n){if(n=n||{},!Ws(r))throw ae("Modifier must be an object");r=Oc(r);var i=Qw(r),o;if(i?(o=Oc(t),Bt.each(r,function(a,s){var u=Jw[s];if(!u)throw ae("Invalid modifier specified "+s);Bt.each(a,function(c,l){if(l==="")throw ae("An empty update path is not valid.");var f=l.split(".");if(!Bt.all(f))throw ae("The update path '"+l+"' contains an empty field name, which is not allowed.");var h=ph(o,f,{noCreate:Xw[s],forbidArray:s==="$rename",arrayIndices:n.arrayIndices}),d=f.pop();u(h,d,c,l,o)})})):o=r,n.returnInsteadOfReplacing)return o;Bt.each(Bt.keys(t),function(a){a!=="_id"&&delete t[a]}),Bt.each(o,function(a,s){t[s]=a})},ph=function(t,r,n){n=n||{};for(var i=!1,o=0;o<r.length;o++){var a=o===r.length-1,s=r[o],u=Gw(t);if(!u){if(n.noCreate)return;var c=ae("cannot use the part '"+s+"' to traverse "+t);throw c.setPropertyError=!0,c}if(t instanceof Array){if(n.forbidArray)return null;if(s==="$"){if(i)throw ae("Too many positional (i.e. '$') elements");if(!n.arrayIndices||!n.arrayIndices.length)throw ae("The positional operator did not find the match needed from the query");s=n.arrayIndices[0],i=!0}else if(Vw(s))s=parseInt(s);else{if(n.noCreate)return;throw ae("can't append to array using string field name ["+s+"]")}if(a&&(r[o]=s),n.noCreate&&s>=t.length)return;for(;t.length<s;)t.push(null);if(!a){if(t.length===s)t.push({});else if(Rr(t[s])!=="object")throw ae("can't modify field '"+r[o+1]+"' of list value "+JSON.stringify(t[s]))}}else if(!(s in t)){if(n.noCreate)return;a||(t[s]={})}if(a)return t;t=t[s]}},Xw={$unset:!0,$pop:!0,$rename:!0,$pull:!0,$pullAll:!0},Jw={$currentDate:function(t,r,n){if((typeof n>"u"?"undefined":Rr(n))==="object"&&n.hasOwnProperty("$type")){if(n.$type!=="date")throw ae("Minimongo does currently only support the date type in $currentDate modifiers",{field:r})}else if(n!==!0)throw ae("Invalid $currentDate modifier",{field:r});t[r]=new Date},$min:function(t,r,n){if(typeof n!="number")throw ae("Modifier $min allowed for numbers only",{field:r});if(r in t){if(typeof t[r]!="number")throw ae("Cannot apply $min modifier to non-number",{field:r});t[r]>n&&(t[r]=n)}else t[r]=n},$max:function(t,r,n){if(typeof n!="number")throw ae("Modifier $max allowed for numbers only",{field:r});if(r in t){if(typeof t[r]!="number")throw ae("Cannot apply $max modifier to non-number",{field:r});t[r]<n&&(t[r]=n)}else t[r]=n},$inc:function(t,r,n){if(typeof n!="number")throw ae("Modifier $inc allowed for numbers only",{field:r});if(r in t){if(typeof t[r]!="number")throw ae("Cannot apply $inc modifier to non-number",{field:r});t[r]+=n}else t[r]=n},$set:function(t,r,n){if(!Bt.isObject(t)){var i=ae("Cannot set property on non-object field",{field:r});throw i.setPropertyError=!0,i}if(t===null){var i=ae("Cannot set property on null",{field:r});throw i.setPropertyError=!0,i}t[r]=n},$setOnInsert:function(t,r,n){},$unset:function(t,r,n){t!==void 0&&(t instanceof Array?r in t&&(t[r]=null):delete t[r])},$push:function(t,r,n){if(t[r]===void 0&&(t[r]=[]),!(t[r]instanceof Array))throw ae("Cannot apply $push modifier to non-array",{field:r});if(!(n&&n.$each)){t[r].push(n);return}var i=n.$each;if(!(i instanceof Array))throw ae("$each must be an array",{field:r});var o=void 0;if("$position"in n){if(typeof n.$position!="number")throw ae("$position must be a numeric value",{field:r});if(n.$position<0)throw ae("$position in $push must be zero or positive",{field:r});o=n.$position}var a=void 0;if("$slice"in n){if(typeof n.$slice!="number")throw ae("$slice must be a numeric value",{field:r});if(n.$slice>0)throw ae("$slice in $push must be zero or negative",{field:r});a=n.$slice}if(n.$sort)throw ae("$sort in $push not implemented yet");if(o===void 0)for(var s=0;s<i.length;s++)t[r].push(i[s]);else{for(var u=[o,0],s=0;s<i.length;s++)u.push(i[s]);Array.prototype.splice.apply(t[r],u)}a!==void 0&&(a===0?t[r]=[]:t[r]=t[r].slice(a))},$pushAll:function(t,r,n){if(!((typeof n>"u"?"undefined":Rr(n))==="object"&&n instanceof Array))throw ae("Modifier $pushAll/pullAll allowed for arrays only");var i=t[r];if(i===void 0)t[r]=n;else if(i instanceof Array)for(var o=0;o<n.length;o++)i.push(n[o]);else throw ae("Cannot apply $pushAll modifier to non-array",{field:r})},$addToSet:function(t,r,n){var i=!1;if((typeof n>"u"?"undefined":Rr(n))==="object"){var o=Object.keys(n);o[0]==="$each"&&(i=!0)}var a=i?n.$each:[n],s=t[r];if(s===void 0)t[r]=a;else if(s instanceof Array)Bt.each(a,function(u){for(var c=0;c<s.length;c++)if(Cc(u,s[c]))return;s.push(u)});else throw ae("Cannot apply $addToSet modifier to non-array",{field:r})},$pop:function(t,r,n){if(t!==void 0){var i=t[r];if(i!==void 0)if(i instanceof Array)typeof n=="number"&&n<0?i.splice(0,1):i.pop();else throw ae("Cannot apply $pop modifier to non-array",{field:r})}},$pull:function(t,r,n){if(t!==void 0){var i=t[r];if(i!==void 0)throw i instanceof Array?ae("$pull not implemented yet"):ae("Cannot apply $pull/pullAll modifier to non-array",{field:r})}},$pullAll:function(t,r,n){if(!((typeof n>"u"?"undefined":Rr(n))==="object"&&n instanceof Array))throw ae("Modifier $pushAll/pullAll allowed for arrays only",{field:r});if(t!==void 0){var i=t[r];if(i!==void 0)if(i instanceof Array){for(var o=[],a=0;a<i.length;a++){for(var s=!1,u=0;u<n.length;u++)if(Cc(i[a],n[u])){s=!0;break}s||o.push(i[a])}t[r]=o}else throw ae("Cannot apply $pull/pullAll modifier to non-array",{field:r})}},$rename:function(t,r,n,i,o){if(i===n)throw ae("$rename source must differ from target",{field:r});if(t===null)throw ae("$rename source field invalid",{field:r});if(typeof n!="string")throw ae("$rename target must be a string",{field:r});if(n.indexOf("\0")>-1)throw ae("The 'to' field for $rename cannot contain an embedded null byte",{field:r});if(t!==void 0){var a=t[r];delete t[r];var s=n.split("."),u=ph(o,s,{forbidArray:!0});if(u===null)throw ae("$rename target field invalid",{field:r});var c=s.pop();u[c]=a}},$bit:function(t,r,n){throw ae("$bit is not supported",{field:r})}},e1=Yw;const mh=Lh(e1);function t1(e){return this.incrementalModify(t=>{var r=mh(t,e);return r})}function r1(e){var t=this._data,r=mh(t,e);return this._saveData(r,t)}function n1(e){return this.exec().then(t=>t?Array.isArray(t)?Promise.all(t.map(r=>r.update(e))).then(()=>t):t.update(e).then(()=>t):null)}var i1={name:"update",rxdb:!0,prototypes:{RxDocument:e=>{e.update=r1,e.incrementalUpdate=t1},RxQuery:e=>{e.update=n1}}};const o1=(e,t)=>{let r=null;return(...n)=>{window.clearTimeout(r),r=window.setTimeout(()=>{e.apply(null,n)},t)}},yh=e=>{for(const t in e)if(Object.hasOwn(e,t))return!1;return!0};function a1(e){let t,r,n;return{c(){t=Ie("textarea"),V(t,"id","body-editor"),V(t,"class","block w-full h-full relative no-resize border-0 outline-none border-box svelte-1s0bnqf")},m(i,o){qe(i,t,o),Pi(t,e[1].body),r||(n=[Ee(t,"input",e[4]),Ee(t,"keydown",e[2])],r=!0)},p(i,o){o&2&&Pi(t,i[1].body)},d(i){i&&Le(t),r=!1,dt(n)}}}function s1(e){let t;return{c(){t=Ie("div"),t.innerHTML='<h2 class="svelte-1s0bnqf">No Note Selected</h2>',V(t,"class","relative w-full h-full flex items-center justify-center")},m(r,n){qe(r,t,n)},p:fe,d(r){r&&Le(t)}}}function u1(e){let t,r,n,i;Ii(e[3]);function o(u,c){return c&2&&(r=null),r==null&&(r=!!yh(u[1])),r?s1:a1}let a=o(e,-1),s=a(e);return{c(){t=Ie("div"),s.c(),V(t,"class","relative overflow-hidden h-full")},m(u,c){qe(u,t,c),s.m(t,null),n||(i=Ee(window,"resize",e[3]),n=!0)},p(u,[c]){a===(a=o(u,c))&&s?s.p(u,c):(s.d(1),s=a(u),s&&(s.c(),s.m(t,null)))},i:fe,o:fe,d(u){u&&Le(t),s.d(),n=!1,i()}}}function c1(e,t,r){let n;Kt(e,Wt,c=>r(1,n=c));let i;Ya(()=>Ul(i1));const o=o1(()=>!yh(n)&&a(),230),a=async()=>{await n.update({$set:{body:n.body,updatedAt:new Date().getTime()}})};function s(){r(0,i=window.innerHeight)}function u(){n.body=this.value,Wt.set(n)}return[i,n,o,s,u]}class l1 extends br{constructor(t){super(),gr(this,t,c1,u1,Zt,{})}}function f1(e){let t,r,n,i,o,a,s,u,c;return r=new n_({}),i=new l0({}),a=new p0({}),u=new l1({}),{c(){t=Ie("main"),Pr(r.$$.fragment),n=ft(),Pr(i.$$.fragment),o=ft(),Pr(a.$$.fragment),s=ft(),Pr(u.$$.fragment),V(t,"class","w-screen h-screen overflow-hidden flex flex-col")},m(l,f){qe(l,t,f),rr(r,t,null),pe(t,n),rr(i,t,null),pe(t,o),rr(a,t,null),pe(t,s),rr(u,t,null),c=!0},p:fe,i(l){c||(rt(r.$$.fragment,l),rt(i.$$.fragment,l),rt(a.$$.fragment,l),rt(u.$$.fragment,l),c=!0)},o(l){xt(r.$$.fragment,l),xt(i.$$.fragment,l),xt(a.$$.fragment,l),xt(u.$$.fragment,l),c=!1},d(l){l&&Le(t),nr(r),nr(i),nr(a),nr(u)}}}class h1 extends br{constructor(t){super(),gr(this,t,null,f1,Zt,{})}}new h1({target:document.getElementById("app")});

</script>
    <style>
*,:before,:after{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e2e8f0}hr{border-top-width:1px}img{border-style:solid}textarea{resize:vertical}input:-ms-input-placeholder,textarea:-ms-input-placeholder{color:#a0aec0}input::-ms-input-placeholder,textarea::-ms-input-placeholder{color:#a0aec0}input::placeholder,textarea::placeholder{color:#a0aec0}button,[role=button]{cursor:pointer}table{border-collapse:collapse}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}button,input,optgroup,select,textarea{padding:0;line-height:inherit;color:inherit}pre,code,kbd,samp{font-family:Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace}html,body{background-color:#151618;margin:0;padding:0;font-family:Verdana,Geneva,Tahoma,sans-serif;font-size:.9rem;height:100%;width:100%;overflow:hidden}.w-screen{width:100vw}.h-screen{height:100vh}.flex{display:flex}.flex-col{flex-direction:column}.justify-center{justify-content:center}.bg-gray-200{background-color:#edf2f7}.flex-grow{flex-grow:1}.py-1\.5{padding-top:.375rem;padding-bottom:.375rem}.m-1\.5{margin:.375rem}.py-0\.5{padding-top:.125rem;padding-bottom:.125rem}.px-2{padding-left:.5rem;padding-right:.5rem}.py-1{padding-top:.25rem;padding-bottom:.25rem}.px-1{padding-left:.25rem;padding-right:.25rem}.pr-1{padding-right:.25rem}.pr-1\.5{padding-right:.375rem}.pl-1{padding-left:.25rem}.pl-1\.5{padding-left:.375rem}.w-full{width:100%}.h-full{height:100%}.overflow-y-auto{overflow-y:auto}.overflow-x-clip{overflow-x:clip}.text-sm{font-size:.875rem}.justify-between{justify-content:space-between}.justify-end{justify-content:flex-end}.text-gray-600{color:#718096}.border-b{border-bottom-width:1px}.truncate{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.smooth-scroll{scroll-behavior:smooth}.select-none{-webkit-user-select:none;user-select:none}.items-center{align-items:center}.relative{position:relative}.block{display:block}.no-resize{resize:none}.border-0{border-width:0}.outline-none{outline:none}.border-box{box-sizing:border-box}.absolute{position:absolute}.bg-transparent{background-color:transparent}.overflow-hidden{overflow:hidden}.elipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;padding-right:10px}.row-resize{cursor:row-resize}.h-\[10px\]{height:10px}div.svelte-17q8bna{position:absolute;right:28px;top:5px}input.svelte-17q8bna{display:none}label.svelte-17q8bna{display:inline-block;width:12px;height:12px;color:#535353}input.svelte-15kfwin{width:100%;box-sizing:border-box;border-radius:0;font-size:14px;background:transparent;color:#fff;height:38px}input.svelte-15kfwin:focus{outline:none}input.svelte-15kfwin::placeholder{color:#3e464d}li.svelte-15kfwin{height:30px;display:flex;align-items:center;padding:6px 10px;margin-bottom:1px;box-sizing:border-box;color:#adadad}li.break.svelte-15kfwin{height:1px;padding:0;margin:0;border-bottom:1px solid rgba(255,255,255,.05)}ul.svelte-bfkdot{margin:0;padding:0;width:100%;overflow-y:auto;overflow-x:hidden;background-color:#181a1c}li.svelte-bfkdot{display:flex;align-items:center;font-size:14px;height:35px;padding:10px;justify-content:space-between;font-family:Helvetica,sans-serif;-webkit-user-select:none;user-select:none;box-sizing:border-box;color:#cdcdcd}li.svelte-bfkdot:nth-child(odd){background:#21262a}li.svelte-bfkdot:nth-child(even){background:#1d2225}.meta.svelte-bfkdot{color:#43484f;white-space:nowrap;text-align:right;font-size:13px}.mute.svelte-bfkdot{color:#65676c}h2.svelte-1s0bnqf{font-size:18px;color:gray}textarea.svelte-1s0bnqf{padding:0 1rem;background:#131313;color:#ffffffd4;font-size:14px;font-family:Lucida Sans,Lucida Sans Regular,Lucida Grande,Lucida Sans Unicode,Verdana,sans-serif;line-height:1.3;border-radius:none;height:100%}

</style>
  </head>
  <body>
    <div id="app" />
    
  </body>
</html>
